/*!
	project: editor
	update: 2018-09-03 14:21:47 PM
	author: ncsoft-pdw
*/
function youtubeFeedCallback(data){if( data.error && data.error.code == 403 ){movieUpload.previewMovie();return;};return data.items[0]&&data.items[0].snippet?void(youtuDIV[movieUpload._movie]?movieUpload.previewMovie():(youtuDIV[movieUpload._movie]=data,movieUpload.previewMovie())):void movieUpload.errUrl()}window.nc||(window.nc={}),nc.playinG||(nc.playinG={}),nc.playinG.lang={ko:{loading:"잠시만 기다려 주세요.",close_msg:"메시지닫기",confirm:"확인",cancel:"취소",delete_msg:"삭제",edit:"편집",does_not_url:"입력된 주소(URL)가 없습니다.",input_url:"<p>등록할 사진의 주소(URL)를 입력해 주시기 바랍니다.</p>",choose_img:"오른쪽 리스트에서<br />원하시는 사진을<br />선택해 주세요",banned_msg:'<p>회원님께서는 제재로 인해 서비스 이용이 중지되었습니다.</p><p><a href="http://cscenter.plaync.co.kr"><strong>고객센터 바로가기</strong></a></p>',error_fileserver:"파일 서버 에러입니다.",error_exceed_max_upload:"허용 업로드 용량 초과",error_exceed_filesize:"사진 용량이 초과 되었습니다.",error_invalid_request:"잘못된 요청입니다.",error_invalid_img_type:"사진 경로를 찾을 수 없습니다.",error_invalid_token:"죄송합니다. 오류가 발생했습니다.",error_exceed_file:"등록된 파일 개수가 너무 많습니다.",error_fileserver_msg:"서비스 이용에 불편을 드려 죄송합니다.",error_exceed_filesize_msg:"허용 업로드 용량을 초과하였습니다.",error_exceed_filesize_5M:"<p>한 파일당 최대 5MB까지 등록 할 수 있습니다.</p>",error_exceed_filesize_3M:"<p>한 파일당 최대 3MB까지 등록 할 수 있습니다.</p>",error_invalid_img_type_msg:"<p>JPG, GIF, PNG, BMP 형식만 등록할 수 있습니다.</p><p>사진의 주소(URL)가 잘못 입력 되었거나</p><p>지원되지 않는 형식일 수 있으니 확인 후 </p><p>다시 등록해 주시기 바랍니다.</p>",error_invalid_token:"<p>오류가 발생해서 페이지를 '새로 고침(F5)' 해야 합니다.</p><p>작성하셨던 소중한 글이 모두 지워지게 되므로</p><p>다른 곳에 저장 후 '새로 고침' 해주시기 바랍니다.</p>",error_exceed_file_msg:"<p>한 번에 등록할 수 있는 파일 개수가 초과되었습니다.</p><p>불필요한 사진은 삭제 후 다시 등록해 주시기 바랍니다.</p>",error_exceed_filesize_30M:"<p>첨부하신 사진의 용량이 큽니다.</p><p>최대 30MB까지 등록할 수 있습니다.</p>",error_auth_fail_msg:"<p>로그아웃 되었거나 권한이 없습니다.</p>",sorry:"죄송합니다.",edit_editing:"기본편집",edit_size:"크기조절",edit_ratio:"비율유지",edit_cut:"자르기",edit_resize_custom:"사용자 지정",edit_sandbox:"샌드박스 프로필",edit_aion:"아이온 프로필",edit_facebook:"페이스북 프로필",edit_twitter:"트위터 프로필",edit_youtube:"유튜브 프로필",edit_rotate:"90도 회전",edit_rotate_horizontal:"좌우반전",edit_rotate_vertical:"상하반전",edit_mosaic:"모자이크",edit_rotate_apply:"회전 적용",edit_resize_apply:"크기조절 적용",edit_cut_apply:"자르기 적용",edit_mosaic_apply:"모자이크 적용",edit_shape_apply:"문양 적용",edit_draw_size:"크기 선택",edit_remove_filter:"효과없애기",edit_notify_guide:"사진 편집은 <strong>전체화면</strong>모드에서 이용해 주세요",edit_info:"편집 환경에서는 사진이 화면에 최적화된 사이즈로 조절됩니다.",edit_not_supported:"이미지편집에디터를 지원하지 않는 브라우저 입니다.",edit_filter:"사진효과",edit_filter1:"새벽안개",edit_filter2:"갈대바람",edit_filter3:"나무의기억",edit_filter4:"노스텔지어",edit_filter5:"환상여행",edit_filter6:"녹차빛",edit_filter7:"바다유리",edit_filter8:"캐러멜",edit_filter9:"퍼플레인",edit_filter10:"하현달",edit_filter11:"풀피리",edit_filter12:"제비꽃",edit_draw:"그림그리기",edit_pen_size:"붓 크기",edit_pen_size_apply:"크기지정",edit_pen_color:"붓 색상",edit_symbol:"꾸미기 문양",edit_draw_size:"크기 선택",edit_job1:"암살자",edit_job2:"역사",edit_job3:"기공사",edit_job4:"권사",edit_job5:"소환사",edit_race1:"진족",edit_race2:"곤족",edit_race3:"린족",edit_race4:"건족",edit_effect1:"효과1",edit_effect2:"효과2",edit_effect3:"효과3",edit_effect4:"효과4",edit_effect5:"효과5",edit_effect6:"효과6",edit_logo1:"로고1",edit_logo2:"로고2",edit_figure1:"도형1",edit_figure2:"도형2",edit_figure3:"도형3",edit_figure4:"도형4",edit_figure5:"도형5",edit_figure6:"도형6",edit_faction1:"홍문",edit_faction2:"홍문",edit_mastery:"성(mastery-level)",edit_prev:"이전단계",edit_next:"다음단계",edit_reset:"처음으로",edit_confirm:"편집 완료",edit_info:"편집 환경에서는 사진이 화면에 최적화된 사이즈로 조절됩니다.",edit_move_info1:"<span>편집하기</span> 기능을 이용해서 멋진 사진을 만들어 보세요.",edit_move_info1:"최신 브라우저를 사용하시면 사진에 멋진 효과들을 적용할 수 있어요.",close:"닫기",edit_complete:"편집을 완료 합니다.",edit_complete_msg:"작업하신 내용을 저장 후 업로드 화면으로 돌아갑니다.",edit_confirm:"확인",edit_edit:"편집",edit_esc_msg:"Esc키를 누르시면 창이 닫힙니다.",edit_loading:"로딩중입니다",edit_screenshot:"스크린샷 정보",edit_fullscreen:"전체화면",edit_character:"캐릭터 정보",edit_download:"다운로드",edit_share:"공유하기",edit_hide:"정보숨기기",cancel:"취소",choose_upload:"내 PC에서 찾기",choose_image:"사진 올리기",url_permission_type:"JPG, GIF, PNG, BMP 형식을 지원합니다.",url_close:"편집 화면을 닫습니다.",url_close_confirm:"<p>수정된 내용이 적용되지 않습니다.</p><p>편집을 종료 하시겠습니까?</p>",url_complete:"편집을 완료 합니다.",url_save_msg:"<p>작업하신 내용을 저장 후</p><p>업로드 화면으로 돌아갑니다.</p>",url_error:"죄송합니다. 오류가 발생했습니다.",url_error_msg:"<p>해당 이미지가 삭제되었거나</p><p>일시적인 장애로 다운로드 할 수 없습니다.</p>",movie_youtube_msg:"사이트 URL 첨부 방식은<br>유튜브 서비스만 제공됩니다",movie_not_found_msg:"해당 영상을 찾을 수 없습니다.",movie_reset:"다시 입력하기",movie_preview:"미리보기",movie_insert:"삽입",movie_cancel:"취소",movie_restriction_msg:"해당 콘텐츠는 모바일 기기에서 볼 수 없습니다."},ja:{loading:"잠시만 기다려 주세요.",close_msg:"메시지닫기",confirm:"확인",cancel:"취소",delete_msg:"삭제",edit:"편집",does_not_url:"입력된 주소(URL)가 없습니다.",input_url:"<p>등록할 사진의 주소(URL)를 입력해 주시기 바랍니다.</p>",choose_img:"오른쪽 리스트에서<br />원하시는 사진을<br />선택해 주세요",banned_msg:'<p>회원님께서는 제재로 인해 서비스 이용이 중지되었습니다.</p><p><a href="http://cscenter.plaync.co.kr"><strong>고객센터 바로가기</strong></a></p>',error_fileserver:"파일 서버 에러입니다.",error_exceed_max_upload:"허용 업로드 용량 초과",error_exceed_filesize:"사진 용량이 초과 되었습니다.",error_invalid_request:"잘못된 요청입니다.",error_invalid_img_type:"사진 경로를 찾을 수 없습니다.",error_invalid_token:"죄송합니다. 오류가 발생했습니다.",error_exceed_file:"등록된 파일 개수가 너무 많습니다.",error_fileserver_msg:"서비스 이용에 불편을 드려 죄송합니다.",error_exceed_filesize_msg:"허용 업로드 용량을 초과하였습니다.",error_exceed_filesize_5M:"<p>한 파일당 최대 5MB까지 등록 할 수 있습니다.</p>",error_exceed_filesize_3M:"<p>한 파일당 최대 3MB까지 등록 할 수 있습니다.</p>",error_invalid_img_type_msg:"<p>JPG, GIF, PNG, BMP 형식만 등록할 수 있습니다.</p><p>사진의 주소(URL)가 잘못 입력 되었거나</p><p>지원되지 않는 형식일 수 있으니 확인 후 </p><p>다시 등록해 주시기 바랍니다.</p>",error_invalid_token:"<p>오류가 발생해서 페이지를 '새로 고침(F5)' 해야 합니다.</p><p>작성하셨던 소중한 글이 모두 지워지게 되므로</p><p>다른 곳에 저장 후 '새로 고침' 해주시기 바랍니다.</p>",error_exceed_file_msg:"<p>한 번에 등록할 수 있는 파일 개수가 초과되었습니다.</p><p>불필요한 사진은 삭제 후 다시 등록해 주시기 바랍니다.</p>",error_exceed_filesize_30M:"<p>첨부하신 사진의 용량이 큽니다.</p><p>최대 30MB까지 등록할 수 있습니다.</p>",error_auth_fail_msg:"<p>로그아웃 되었거나 권한이 없습니다.</p>",sorry:"죄송합니다.",edit_editing:"기본편집",edit_size:"크기조절",edit_ratio:"비율유지",edit_cut:"자르기",edit_resize_custom:"사용자 지정",edit_sandbox:"샌드박스 프로필",edit_aion:"아이온 프로필",edit_facebook:"페이스북 프로필",edit_twitter:"트위터 프로필",edit_youtube:"유튜브 프로필",edit_rotate:"90도 회전",edit_rotate_horizontal:"좌우반전",edit_rotate_vertical:"상하반전",edit_mosaic:"모자이크",edit_rotate_apply:"회전 적용",edit_resize_apply:"크기조절 적용",edit_cut_apply:"자르기 적용",edit_mosaic_apply:"모자이크 적용",edit_shape_apply:"문양 적용",edit_draw_size:"크기 선택",edit_remove_filter:"효과없애기",edit_notify_guide:"사진 편집은 <strong>전체화면</strong>모드에서 이용해 주세요",edit_info:"편집 환경에서는 사진이 화면에 최적화된 사이즈로 조절됩니다.",edit_not_supported:"이미지편집에디터를 지원하지 않는 브라우저 입니다.",edit_filter:"사진효과",edit_filter1:"새벽안개",edit_filter2:"갈대바람",edit_filter3:"나무의기억",edit_filter4:"노스텔지어",edit_filter5:"환상여행",edit_filter6:"녹차빛",edit_filter7:"바다유리",edit_filter8:"캐러멜",edit_filter9:"퍼플레인",edit_filter10:"하현달",edit_filter11:"풀피리",edit_filter12:"제비꽃",edit_draw:"그림그리기",edit_pen_size:"붓 크기",edit_pen_size_apply:"크기지정",edit_pen_color:"붓 색상",edit_symbol:"꾸미기 문양",edit_draw_size:"크기 선택",edit_job1:"암살자",edit_job2:"역사",edit_job3:"기공사",edit_job4:"권사",edit_job5:"소환사",edit_race1:"진족",edit_race2:"곤족",edit_race3:"린족",edit_race4:"건족",edit_effect1:"효과1",edit_effect2:"효과2",edit_effect3:"효과3",edit_effect4:"효과4",edit_effect5:"효과5",edit_effect6:"효과6",edit_logo1:"로고1",edit_logo2:"로고2",edit_figure1:"도형1",edit_figure2:"도형2",edit_figure3:"도형3",edit_figure4:"도형4",edit_figure5:"도형5",edit_figure6:"도형6",edit_faction1:"홍문",edit_faction2:"홍문",edit_mastery:"성(mastery-level)",edit_prev:"이전단계",edit_next:"다음단계",edit_reset:"처음으로",edit_confirm:"편집 완료",edit_info:"편집 환경에서는 사진이 화면에 최적화된 사이즈로 조절됩니다.",edit_move_info1:"<span>편집하기</span> 기능을 이용해서 멋진 사진을 만들어 보세요.",edit_move_info1:"최신 브라우저를 사용하시면 사진에 멋진 효과들을 적용할 수 있어요.",close:"닫기",edit_complete:"편집을 완료 합니다.",edit_complete_msg:"작업하신 내용을 저장 후 업로드 화면으로 돌아갑니다.",edit_confirm:"확인",edit_edit:"편집",edit_esc_msg:"Esc키를 누르시면 창이 닫힙니다.",edit_loading:"로딩중입니다",edit_screenshot:"스크린샷 정보",edit_fullscreen:"전체화면",edit_character:"캐릭터 정보",edit_download:"다운로드",edit_share:"공유하기",edit_hide:"정보숨기기",cancel:"취소",choose_upload:"내 PC에서 찾기",choose_image:"사진 올리기",url_permission_type:"JPG, GIF, PNG, BMP 형식을 지원합니다.",url_close:"편집 화면을 닫습니다.",url_close_confirm:"<p>수정된 내용이 적용되지 않습니다.</p><p>편집을 종료 하시겠습니까?</p>",url_complete:"편집을 완료 합니다.",url_save_msg:"<p>작업하신 내용을 저장 후</p><p>업로드 화면으로 돌아갑니다.</p>",url_error:"죄송합니다. 오류가 발생했습니다.",url_error_msg:"<p>해당 이미지가 삭제되었거나</p><p>일시적인 장애로 다운로드 할 수 없습니다.</p>",movie_youtube_msg:"사이트 URL 첨부 방식은<br>유튜브 서비스만 제공됩니다",movie_not_found_msg:"해당 영상을 찾을 수 없습니다.",movie_reset:"다시 입력하기",movie_preview:"미리보기",movie_insert:"삽입",movie_cancel:"취소",movie_restriction_msg:"해당 콘텐츠는 모바일 기기에서 볼 수 없습니다."},"zh-tw":{loading:"잠시만 기다려 주세요.",close_msg:"메시지닫기",confirm:"확인",cancel:"취소",delete_msg:"삭제",edit:"편집",does_not_url:"입력된 주소(URL)가 없습니다.",input_url:"<p>등록할 사진의 주소(URL)를 입력해 주시기 바랍니다.</p>",choose_img:"오른쪽 리스트에서<br />원하시는 사진을<br />선택해 주세요",banned_msg:'<p>회원님께서는 제재로 인해 서비스 이용이 중지되었습니다.</p><p><a href="http://cscenter.plaync.co.kr"><strong>고객센터 바로가기</strong></a></p>',error_fileserver:"파일 서버 에러입니다.",error_exceed_max_upload:"허용 업로드 용량 초과",error_exceed_filesize:"사진 용량이 초과 되었습니다.",error_invalid_request:"잘못된 요청입니다.",error_invalid_img_type:"사진 경로를 찾을 수 없습니다.",error_invalid_token:"죄송합니다. 오류가 발생했습니다.",error_exceed_file:"등록된 파일 개수가 너무 많습니다.",error_fileserver_msg:"서비스 이용에 불편을 드려 죄송합니다.",error_exceed_filesize_msg:"허용 업로드 용량을 초과하였습니다.",error_exceed_filesize_5M:"<p>한 파일당 최대 5MB까지 등록 할 수 있습니다.</p>",error_exceed_filesize_3M:"<p>한 파일당 최대 3MB까지 등록 할 수 있습니다.</p>",error_invalid_img_type_msg:"<p>JPG, GIF, PNG, BMP 형식만 등록할 수 있습니다.</p><p>사진의 주소(URL)가 잘못 입력 되었거나</p><p>지원되지 않는 형식일 수 있으니 확인 후 </p><p>다시 등록해 주시기 바랍니다.</p>",error_invalid_token:"<p>오류가 발생해서 페이지를 '새로 고침(F5)' 해야 합니다.</p><p>작성하셨던 소중한 글이 모두 지워지게 되므로</p><p>다른 곳에 저장 후 '새로 고침' 해주시기 바랍니다.</p>",error_exceed_file_msg:"<p>한 번에 등록할 수 있는 파일 개수가 초과되었습니다.</p><p>불필요한 사진은 삭제 후 다시 등록해 주시기 바랍니다.</p>",error_exceed_filesize_30M:"<p>첨부하신 사진의 용량이 큽니다.</p><p>최대 30MB까지 등록할 수 있습니다.</p>",error_auth_fail_msg:"<p>로그아웃 되었거나 권한이 없습니다.</p>",sorry:"죄송합니다.",edit_editing:"기본편집",edit_size:"크기조절",edit_ratio:"비율유지",edit_cut:"자르기",edit_resize_custom:"사용자 지정",edit_sandbox:"샌드박스 프로필",edit_aion:"아이온 프로필",edit_facebook:"페이스북 프로필",edit_twitter:"트위터 프로필",edit_youtube:"유튜브 프로필",edit_rotate:"90도 회전",edit_rotate_horizontal:"좌우반전",edit_rotate_vertical:"상하반전",edit_mosaic:"모자이크",edit_rotate_apply:"회전 적용",edit_resize_apply:"크기조절 적용",edit_cut_apply:"자르기 적용",edit_mosaic_apply:"모자이크 적용",edit_shape_apply:"문양 적용",edit_draw_size:"크기 선택",edit_remove_filter:"효과없애기",edit_notify_guide:"사진 편집은 <strong>전체화면</strong>모드에서 이용해 주세요",edit_info:"편집 환경에서는 사진이 화면에 최적화된 사이즈로 조절됩니다.",edit_not_supported:"이미지편집에디터를 지원하지 않는 브라우저 입니다.",edit_filter:"사진효과",edit_filter1:"새벽안개",edit_filter2:"갈대바람",edit_filter3:"나무의기억",edit_filter4:"노스텔지어",edit_filter5:"환상여행",edit_filter6:"녹차빛",edit_filter7:"바다유리",edit_filter8:"캐러멜",edit_filter9:"퍼플레인",edit_filter10:"하현달",edit_filter11:"풀피리",edit_filter12:"제비꽃",edit_draw:"그림그리기",edit_pen_size:"붓 크기",edit_pen_size_apply:"크기지정",edit_pen_color:"붓 색상",edit_symbol:"꾸미기 문양",edit_draw_size:"크기 선택",edit_job1:"암살자",edit_job2:"역사",edit_job3:"기공사",edit_job4:"권사",edit_job5:"소환사",edit_race1:"진족",edit_race2:"곤족",edit_race3:"린족",edit_race4:"건족",edit_effect1:"효과1",edit_effect2:"효과2",edit_effect3:"효과3",edit_effect4:"효과4",edit_effect5:"효과5",edit_effect6:"효과6",edit_logo1:"로고1",edit_logo2:"로고2",edit_figure1:"도형1",edit_figure2:"도형2",edit_figure3:"도형3",edit_figure4:"도형4",edit_figure5:"도형5",edit_figure6:"도형6",edit_faction1:"홍문",edit_faction2:"홍문",edit_mastery:"성(mastery-level)",edit_prev:"이전단계",edit_next:"다음단계",edit_reset:"처음으로",edit_confirm:"편집 완료",edit_info:"편집 환경에서는 사진이 화면에 최적화된 사이즈로 조절됩니다.",edit_move_info1:"<span>편집하기</span> 기능을 이용해서 멋진 사진을 만들어 보세요.",edit_move_info1:"최신 브라우저를 사용하시면 사진에 멋진 효과들을 적용할 수 있어요.",close:"닫기",edit_complete:"편집을 완료 합니다.",edit_complete_msg:"작업하신 내용을 저장 후 업로드 화면으로 돌아갑니다.",edit_confirm:"확인",edit_edit:"편집",edit_esc_msg:"Esc키를 누르시면 창이 닫힙니다.",edit_loading:"로딩중입니다",edit_screenshot:"스크린샷 정보",edit_fullscreen:"전체화면",edit_character:"캐릭터 정보",edit_download:"다운로드",edit_share:"공유하기",edit_hide:"정보숨기기",cancel:"취소",choose_upload:"내 PC에서 찾기",choose_image:"사진 올리기",url_permission_type:"JPG, GIF, PNG, BMP 형식을 지원합니다.",url_close:"편집 화면을 닫습니다.",url_close_confirm:"<p>수정된 내용이 적용되지 않습니다.</p><p>편집을 종료 하시겠습니까?</p>",url_complete:"편집을 완료 합니다.",url_save_msg:"<p>작업하신 내용을 저장 후</p><p>업로드 화면으로 돌아갑니다.</p>",url_error:"죄송합니다. 오류가 발생했습니다.",url_error_msg:"<p>해당 이미지가 삭제되었거나</p><p>일시적인 장애로 다운로드 할 수 없습니다.</p>",movie_youtube_msg:"사이트 URL 첨부 방식은<br>유튜브 서비스만 제공됩니다",movie_not_found_msg:"해당 영상을 찾을 수 없습니다.",movie_reset:"다시 입력하기",movie_preview:"미리보기",movie_insert:"삽입",movie_cancel:"취소",movie_restriction_msg:"해당 콘텐츠는 모바일 기기에서 볼 수 없습니다."}},window.nc||(window.nc={}),nc.playinG||(nc.playinG={}),nc.$=lol=function(id){return document.getElementById(id)},nc.$$=function(className,parent){var getItems=(parent||document).getElementsByTagName("*"),filterItem=new RegExp("(^|\\s)"+className+"(\\s|$)"),exportItem=[];for(i=0;i<getItems.length;i++){var item=getItems[i];item.className.match(filterItem)&&exportItem.push(item)}return exportItem},nc.caller=[],nc.ua=navigator.userAgent.toLowerCase(),nc.isFF=-1!==nc.ua.indexOf("firefox")&&-1===nc.ua.indexOf("navigator"),nc.isIE=!!nc.ua.match(/msie|trident/),nc.isIE6=-1!=nc.ua.indexOf("msie 6"),nc.isIE7=-1!=nc.ua.indexOf("msie 7"),nc.isIE8=-1!=nc.ua.indexOf("msie 8"),nc.isIE9=-1!=nc.ua.indexOf("msie 9"),nc.isIE10=-1!=nc.ua.indexOf("msie 10"),nc.isIE11=!!nc.ua.match(/trident.*rv:11\./),nc.isMetro=function(){if(!nc.isIE10)return!1;var isActiveXEnabled=!1;try{isActiveXEnabled=new ActiveXObject("htmlfile")}catch(e){isActiveXEnabled=!1}return isActiveXEnabled},nc.trace=window.trace=function(txt){return nc.caller.push(nc.trace.caller),window.console?console.log(txt):void 0},nc.trk=function(){if(arguments[0]){var trk,t=arguments[0],flag=/^http\:\/\/(.+)\.plaync\.[com|co\.kr]/.exec(location.href);if(flag&&flag instanceof Array){trk="/playinG"+t+flag[1]+"/";try{_trk_clickTrace("EVT",trk)}catch(e){}}}},nc.abstractMethod=function(){nc.trace("abstractMethod")},nc.showTraceList=function(){for(var i=0,len=nc.caller.length;len>i;i++)alert(nc.caller[i].constructor)},nc.extend=function(dest,source){for(n in source)dest[n]=source[n];return dest},nc.setCssText=function(el,value){el.style.cssText=value},nc.setStyle=function(el,sStyle,value){return"opacity"===sStyle?void nc.setOpacity(el,value):void(el.style[sStyle]=value)},nc.getStyle=function(el,sStyle){return"height"===sStyle&&0!==el.offsetHeight?el.offsetHeight:el.style[sStyle]?el.style[sStyle]:el.currentStyle?el.currentStyle[sStyle]:window.getComputedStyle(el,null)[sStyle]},nc.trim=function(s){return s.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},nc.getFirstChild=function(el){for(var f=el.firstChild;f&&1!==f.nodeType;)f=f.nextSibling;return f},nc.hasClassName=function(el,c){for(var cnames=nc.trim(el.className).replace(/\s+/g," ").split(" "),flag=!1,i=0;cnames[i];i++)if(c===cnames[i]){flag=!0;break}return flag},nc.addClassName=function(el,cname){return el?nc.hasClassName(el,cname)?el:(el.className=""===nc.trim(el.className)?cname:el.className+" "+cname,el):void 0},nc.removeClassName=function(el,cname){for(var cls=nc.trim(el.className).replace(/\s+/g," ").split(" "),tmp=[],i=0;cls[i];i++)cname!==cls[i]&&tmp.push(cls[i]);return el.className=tmp.join(" "),el},nc.addPx=function(n){return isNaN(n)&&(n=0),n+"px"},nc.setOpacity=function(el,value){el.style.filter="alpha(opacity="+100*value+")",el.style.opacity=el.style.MozOpacity=el.style.KhtmlOpacity=value},nc.integer=function(n){return parseInt(n)},nc.getMousePos=function(evt){return evt.screenX?(evt._x=evt.screenX,evt._y=evt.screenY):evt.layerX||0==evt.layerX?(evt._x=evt.layerX,evt._y=evt.layerY):(evt.offsetX||0==evt.offsetX)&&(evt._x=evt.offsetX,evt._y=evt.offsetY),{x:evt._x,y:evt._y}},nc.getMousePosToScreen=function(evt){return evt.pageX?(evt._x=evt.pageX,evt._y=evt.pageY):(evt._x=evt.clientX,evt._y=evt.clientY),{x:evt._x,y:evt._y}},nc.getPosition=function(node){if("getBoundingClientRect"in document.documentElement){var rect=this.node.getBoundingClientRect();return{x:rect.left,y:rect.top}}for(var e=node;e;)c.x+=e.offsetLeft||0,c.y+=e.offsetTop||0,e=e.offsetParent;return{x:c.x,y:c.y}},nc.getMousePosition=function(evt){return evt.layerX||0==evt.layerX?(evt._x=evt.layerX,evt._y=evt.layerY):evt.offsetX||0==evt.offsetX?(evt._x=evt.offsetX,evt._y=evt.offsetY):evt.screenX&&(evt._x=evt.screenX,evt._y=evt.screenY),{x:evt._x,y:evt._y}},nc.getAvailSize=function(){return{w:screen.availWidth,h:screen.availHeight}},nc.getScreenTop=function(){return void 0!=window.screenTop?window.screenTop:void 0!=window.screenY?window.screenY:void 0},nc.getScreenSize=function(){return{w:screen.width,h:screen.height}},nc.getScreenInnerSize=function(){return{w:screen.width,h:screen.height-(screen.height-(nc.getScreenTop()+nc.getBrowserSize().h))}},nc.toolbarHeight=function(){return window.innerHeight?window.outerHeight-window.innerHeight:nc.getAvailSize().h-nc.getBrowserSize().h},nc.getCenter=function(){var pos=nc.getBrowserSize();return{x:pos.w/2,y:pos.h/2}},nc.getBrowserSize=function(){return"number"==typeof window.innerWidth?(w=window.innerWidth,h=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(w=document.documentElement.clientWidth,h=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(w=document.body.clientWidth,h=document.body.clientHeight),{w:w,h:h}},nc.nodesHitTest=function(n1,n2){for(var minX,minY,maxX,maxY,t1=nc.integer(nc.getStyle(n1,"top")),l1=nc.integer(nc.getStyle(n1,"left")),w1=nc.integer(nc.getStyle(n1,"width")),h1=nc.integer(nc.getStyle(n1,"height")),t2=nc.integer(nc.getStyle(n2,"top")),l2=nc.integer(nc.getStyle(n2,"left")),w2=nc.integer(nc.getStyle(n2,"width")),h2=nc.integer(nc.getStyle(n2,"height")),halfW=w2/2,halfH=h2/2,point=[{x:l1,y:t1},{x:l1+w1,y:t1+h1},{x:l1,y:t1+h1},{x:l1+w1,y:t1}],i=0,len=point.length;len>i;i++){switch(i){case 0:minX=l2,maxX=l2+halfW,minY=t2,maxY=t2+halfH;break;case 1:minX=l2+halfW,maxX=l2+w2,minY=t2+halfH,maxY=t2+h2;break;case 2:minX=l2,maxX=l2+halfW,minY=t2+halfH,maxY=t2+h2;break;case 3:minX=l2+halfW,maxX=l2+w2,minY=t2,maxY=t2+halfH}if(minX<=point[i].x&&point[i].x<=maxX&&minY<=point[i].y&&point[i].y<=maxY)return!0}return!1},nc.loadCssFile=function(url){var f=document.createElement("link");f.setAttribute("rel","stylesheet"),f.setAttribute("type","text/css"),f.setAttribute("href",url),void 0!==typeof f&&document.getElementsByTagName("head")[0].appendChild(f)},nc.setScrollHeight=function(h){h&&window.scrollTo&&window.scrollTo(0,h)},nc.getScrollHeight=function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;return t||(t=0),t},nc.test=!1,nc.staticUrl="",/^http:\/\/rc\./.test(location.href)&&(nc.staticUrl="rc."),nc.imgUrl=nc.test?"./":"http://"+nc.staticUrl+"static.plaync.co.kr/editor/imagePlugin/",nc.loadCssFile(nc.imgUrl+"static/css/playinG.css"),nc.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}(),Function.prototype.binder||(Function.prototype.binder=function(object){var toArray=function(args){if(!args)return[];if("toArray"in Object(args))return args.toArray();for(var length=args.length||0,results=new Array(length);length--;)results[length]=args[length];return results},__method=this,args=toArray(arguments),object=args.shift();return function(event){return __method.apply(object,[event||window.event].concat(args))}}),Array.prototype.forEach||(Array.prototype.forEach=function(fun){var len=this.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var thisp=arguments[1],i=0;len>i;i++)i in this&&fun.call(thisp,this[i],i,this)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(obj,start){for(var i=start||0;i<this.length;i++)if(this[i]==obj)return i;return-1}),nc.playinG.Event=function(node,type,handler){this._node=node,this.type=type,this.handler=handler},nc.playinG.Event.prototype.remove=function(){nc.playinG.Event.removeListener(this._node,this.type,this.handler),this._node=this.handler=void 0},nc.playinG.Event.addListener=function(node,type,handler){return"mousewheel"===type&&nc.isFF&&(type="DOMMouseScroll"),node.addEventListener?node.addEventListener(type,handler,!1):node.attachEvent("on"+type,handler),new nc.playinG.Event(node,type,handler)},nc.playinG.Event.removeListener=function(node,type,handler){node&&(node.removeEventListener?node.removeEventListener(type,handler,!1):node.detachEvent("on"+type,handler))},nc.playinG.Event.preventDefault=function(evt){var evt=evt||window.event;evt.preventDefault?evt.preventDefault():evt.returnValue=!1},nc.playinG.Event.stopPropagation=function(evt){var evt=evt||window.event;evt.stopPropagation?evt.stopPropagation():evt.cancelBubble=!0},nc.playinG.Observer=window.Observer=function(){this._observer=[]},nc.playinG.Observer.prototype.dispatch=function(data){this._observer.forEach(function(observer){observer.func.call(observer.scope,data)})},nc.playinG.Observer.prototype.add=function(func,scope){var observers=this._observer;observers.push({func:func,scope:scope})},nc.playinG.Observer.prototype.remove=function(func,scope){for(var observers=this._observer,i=observers.length-1;i>=0;--i)if(observers[i].func===func&&observers[i].scope===scope){observers.splice(i,1);break}},nc.playinG.Observer.prototype.removeAll=function(){this._observer=[]},nc.playinG.Draggable=function(node,isMap){if(node){this.node=node,this.isMap=isMap||!1,this.onDrag=new Observer,this.onDragStart=new Observer,this.onDrop=new Observer,this.node.setAttribute("unselectable","on");var s=this.node.style;s.webkitUserSelect="none",s.webkitUserDrag="none",s.MozUserSelect="none",this.startDrag(),nc.playinG.Event.addListener(this.node,"click",this.clickNode.binder(this))}},nc.playinG.Draggable.prototype.immediatelySelectNode=function(evt){this.selectNode(evt)},nc.playinG.Draggable.prototype.stopDrag=function(){this._mousedownHandler&&this._mousedownHandler.remove()},nc.playinG.Draggable.prototype.startDrag=function(){this._mousedownHandler=nc.playinG.Event.addListener(this.node,"mousedown",this.selectNode.binder(this))},nc.playinG.Draggable.prototype.selectNode=function(evt){evt&&(nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt)),this._dragEventHandler=nc.playinG.Event.addListener(document,"mousemove",this.dragNode.binder(this)),this._releaseEventHandler=nc.playinG.Event.addListener(document,"mouseup",this.releaseNode.binder(this)),this.isMap&&(this._outEventHandler=nc.playinG.Event.addListener(document,"mouseout",this.releaseNode.binder(this))),this._x=evt.screenX,this._y=evt.screenY;this.getPosition();this.onDragStart.dispatch({onDragStart:!0})},nc.playinG.Draggable.prototype.dragNode=function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt);var x=evt.screenX-this._x,y=evt.screenY-this._y;(x||y)&&(this.onDrag.dispatch({x:x,y:y}),this._x=evt.screenX,this._y=evt.screenY)},nc.playinG.Draggable.prototype.releaseNode=function(){this._dragEventHandler.remove(),this._releaseEventHandler.remove(),this._outEventHandler&&this._outEventHandler.remove(),this.onDrop.dispatch({drop:!0})},nc.playinG.Draggable.prototype.clickNode=function(evt){nc.playinG.Event.preventDefault(evt)},nc.playinG.Draggable.prototype.getPosition=function(){if("getBoundingClientRect"in document.documentElement){var rect=this.node.getBoundingClientRect();return{x:rect.left,y:rect.top}}for(var e=node;e;)c.x+=e.offsetLeft||0,c.y+=e.offsetTop||0,e=e.offsetParent;return{x:c.x,y:c.y}},nc.playinG.DraggableNode=function(node,isDraggableTop,isDraggableLeft,range,scroll){if(node){this.node=node,this._isDraggableTop=isDraggableTop||"on",this._isDraggableLeft=isDraggableLeft||"on",this._range=range,this._scroll=scroll,this.onDrag=new Observer,this.onDragStart=new Observer,this.onDrop=new Observer,this.node.setAttribute("unselectable","on");var s=this.node.style;return s.webkitUserSelect="none",s.webkitUserDrag="none",s.MozUserSelect="none",s.cursor="pointer",this.startDrag(),nc.playinG.Event.addListener(this.node,"click",this.clickNode.binder(this)),this}},nc.playinG.DraggableNode.prototype=new nc.playinG.Draggable,nc.playinG.DraggableNode.prototype.setRange=function(rng){this._range=rng},nc.playinG.DraggableNode.prototype.clickNode=function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt)},nc.playinG.DraggableNode.prototype.dragNode=function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt);var x=evt.screenX-this._x,y=evt.screenY-this._y;if(x||y){var ns=this.node.style;if("on"===this._isDraggableTop){var top=nc.integer(ns.top)+y;this._range?this._range.tMin<=top&&this._range.tMax>=top?ns.top=nc.addPx(top):this._range.tMin>top?ns.top=nc.addPx(this._range.tMin):this._range.tMax<top&&(ns.top=nc.addPx(this._range.tMax)):ns.top=nc.addPx(top)}if("on"===this._isDraggableLeft){var left=nc.integer(ns.left)+x;this._range?this._range.min<=left&&this._range.max>=left?ns.left=nc.addPx(left):this._range.min>left?ns.left=nc.addPx(this._range.min):this._range.max<left&&(ns.left=nc.addPx(this._range.max)):ns.left=nc.addPx(left)}this._x=evt.screenX,this._y=evt.screenY,this.onDrag.dispatch({t:y,l:x})}},nc.playinG.DraggableNode.prototype.releaseNode=function(){this._dragEventHandler&&this._dragEventHandler.remove(),this._releaseEventHandler&&this._releaseEventHandler.remove(),this._outEventHandler&&this._outEventHandler.remove(),this.onDrop.dispatch({node:this.node})},nc.playinG.DraggableNode.prototype.selectNode=function(evt){evt&&(nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt)),this._dragEventHandler=nc.playinG.Event.addListener(document,"mousemove",this.dragNode.binder(this)),this._releaseEventHandler=nc.playinG.Event.addListener(document,"mouseup",this.releaseNode.binder(this)),"on"!==this._isDraggableTop&&"on"!==this._isDraggableLeft&&(this._outEventHandler=nc.playinG.Event.addListener(document,"mouseout",this.releaseNode.binder(this))),this._x=evt.screenX,this._y=evt.screenY;this.getPosition();this.onDragStart.dispatch({onDragStart:!0})},nc.WheelController=function(node){this.onWheel=new nc.playinG.Observer,nc.playinG.Event.addListener(node,"mousewheel",this._handler.binder(this))},nc.WheelController.prototype._handler=function(event){var delta=0;event||(event=window.event),event.wheelDelta?delta=event.wheelDelta/120:event.detail&&(delta=-event.detail/3),this.onWheel.dispatch(delta)},nc.Scrollbar=function(parent,content,color){this._panel=parent,this._content=content,this._draggable=null,this._handleColor=color;var position=nc.getStyle(this._panel,"position");"absolute"!==position&&"relative"!==position&&nc.setStyle(this._panel,"position","relative"),this.setUI(),this.setConfig(),this.setEvent(),this.setHandleEvent(0)},nc.Scrollbar.prototype.setUI=function(){{var pHeight=nc.integer(nc.getStyle(this._panel,"height"));nc.integer(nc.getStyle(this._content,"height"))}this._track=document.createElement("div"),this._track.className="scrollBarTrackG",this._handle=document.createElement("div"),this._handle.className="scrollBarHandleG",this._track.appendChild(this._handle),this._panel.appendChild(this._track),nc.setStyle(this._content,"position","absolute"),nc.setStyle(this._content,"top",0),nc.setStyle(this._content,"left",0),nc.setStyle(this._handle,"position","relative"),nc.setStyle(this._handle,"top",0),nc.setStyle(this._handle,"cursor","pointer"),this._handleColor&&nc.setStyle(this._handle,"backgroundColor",this._handleColor),nc.setStyle(this._handle,"borderRadius","7px 7px 7px 7px"),nc.setStyle(this._handle,"width","6px"),nc.setCssText(this._track,"cursor:move;position:absolute;right:0;top:0;width:6px;"),nc.setStyle(this._track,"height",nc.addPx(pHeight))},nc.Scrollbar.prototype.setConfig=function(){var pHeight=nc.integer(nc.getStyle(this._panel,"height")),cHeight=nc.integer(nc.getStyle(this._content,"height"));this._rate=cHeight/pHeight,isNaN(this._rate)&&(this._rate=0),this._rate<=1||(nc.setStyle(this._track,"height",nc.addPx(pHeight)),nc.setStyle(this._handle,"height",nc.addPx(nc.integer(pHeight/this._rate))),nc.setOpacity(this._handle,"0.7"))},nc.Scrollbar.prototype.changeHeight=function(h,ph){return isNaN(h)&&(h=0),isNaN(ph)&&(ph=0),ph>=h?(this._rate=0,nc.setStyle(this._handle,"height",nc.addPx(0)),nc.setStyle(this._track,"height",nc.addPx(0)),void this.moveTop()):(nc.setStyle(this._content,"height",nc.addPx(h)),ph&&nc.setStyle(this._track,"height",nc.addPx(ph)),this.setConfig(),void this.setHandleEvent())},nc.Scrollbar.prototype.onTrack=function(evt){nc.playinG.Event.preventDefault(evt);{var mouseY=nc.getMousePosition(evt).y,pHeight=nc.integer(nc.getStyle(this._panel,"height")),cHeight=nc.integer(nc.getStyle(this._content,"height")),trackH=nc.integer(nc.getStyle(this._track,"height")),handleH=nc.integer(nc.getStyle(this._handle,"height")),trackMax=trackH-handleH,trackMin=0,tmax=pHeight-cHeight,tmin=0;nc.integer(nc.getStyle(this._content,"top"))}return trackMin+handleH>=mouseY?(nc.setStyle(this._handle,"top",nc.addPx(trackMin)),void nc.setStyle(this._content,"top",nc.addPx(tmin))):mouseY>=trackMax?(nc.setStyle(this._handle,"top",nc.addPx(trackMax)),void nc.setStyle(this._content,"top",nc.addPx(tmax))):mouseY>=trackMin&&trackMax>=mouseY?(nc.setStyle(this._handle,"top",nc.addPx(mouseY)),void nc.setStyle(this._content,"top",nc.addPx(mouseY*-this._rate))):void 0},nc.Scrollbar.prototype.setHandleEvent=function(top){var handleH=nc.integer(nc.getStyle(this._handle,"height")),trackH=nc.integer(nc.getStyle(this._track,"height")),tmax=trackH-handleH;return top&&nc.setStyle(this._handle,"top",nc.addPx(top)),this._draggable?void this._draggable.setRange({tMin:0,tMax:tmax}):(this._draggable=new nc.playinG.DraggableNode(this._handle,"on","off",{tMin:0,tMax:tmax},"scroll"),void this._draggable.onDrag.add(function(){nc.setStyle(this._content,"top",nc.addPx(-1*nc.integer(nc.getStyle(this._handle,"top"))*this._rate))},this))},nc.Scrollbar.prototype.moveBottom=function(){var pHeight=nc.integer(nc.getStyle(this._panel,"height")),cHeight=nc.integer(nc.getStyle(this._content,"height")),trackH=nc.integer(nc.getStyle(this._track,"height")),handleH=nc.integer(nc.getStyle(this._handle,"height")),trackMax=trackH-handleH,tmin=pHeight-cHeight;0!==handleH&&0!==trackH&&(nc.setStyle(this._content,"top",nc.addPx(tmin)),nc.setStyle(this._handle,"top",nc.addPx(trackMax)))},nc.Scrollbar.prototype.moveTop=function(){var trackMin=0,tmax=0;nc.setStyle(this._content,"top",nc.addPx(trackMin)),nc.setStyle(this._handle,"top",nc.addPx(tmax))},nc.Scrollbar.prototype.setEvent=function(){var handleH=nc.integer(nc.getStyle(this._handle,"height")),trackH=nc.integer(nc.getStyle(this._track,"height"));tmax=trackH-handleH,nc.playinG.Event.addListener(this._track,"click",this.onTrack.binder(this)),this._wheel=new nc.WheelController(this._panel),this._wheel.onWheel.add(function(delta){if(!(this._rate<=1)){var pHeight=nc.integer(nc.getStyle(this._panel,"height")),cHeight=nc.integer(nc.getStyle(this._content,"height")),trackH=nc.integer(nc.getStyle(this._track,"height")),handleH=nc.integer(nc.getStyle(this._handle,"height")),trackMax=trackH-handleH,trackMin=0,tmin=pHeight-cHeight,tmax=0,top=nc.integer(nc.getStyle(this._content,"top")),value=30;return value=delta>0?1*value:-1*value,tmin>=top+value?(nc.setStyle(this._handle,"top",nc.addPx(trackMax)),void nc.setStyle(this._content,"top",nc.addPx(tmin))):top+value>=tmax?(nc.setStyle(this._handle,"top",nc.addPx(trackMin)),void nc.setStyle(this._content,"top",nc.addPx(tmax))):top+value>=tmin&&tmax>=top+value?(nc.setStyle(this._handle,"top",nc.addPx((top+value)/this._rate*-1)),void nc.setStyle(this._content,"top",nc.addPx(top+value))):void 0}},this)},nc.playinG.Animate=function(node,styles,options){var _queue=nc.playinG.Animate.queue,_animate=nc.playinG.Animate.animate;if(this._e=node,this._o=options,-1!==_queue.indexOf(this._e)){if(!this._o.removePrevAnimate)return;_animate[_queue.indexOf(this._e)].terminate()}_queue.push(this._e),_animate.push(this),this.style=this._e.currentStyle?this._e.currentStyle:document.defaultView.getComputedStyle(this._e,null),this._styles=styles,this.start=+new Date,this.dur=this._o.duration||300,this.cb=this._o.callback||null,this.curr={},this.easing=this._o.easing||nc.playinG.Easing.easeInOut,this.end=this.start+this.dur;
for(prop in this._styles)this.curr[prop]=this.style[prop];this.interval=setInterval(function(){var value,time=+new Date;for(prop in this._styles)-1!==nc.playinG.Animate.STYLE.indexOf(prop)&&(value=this.easing(time-this.start,nc.integer(this.curr[prop]),nc.integer(this._styles[prop])-nc.integer(this.curr[prop]),this.dur),"opacity"===prop?(this._e.style[prop]=value,this._e.style.filter="alpha(opacity="+100*value+")"):this._e.style[prop]=nc.addPx(value));time>=this.end&&this.terminate()}.binder(this),1e3/60)},nc.playinG.Animate.queue=[],nc.playinG.Animate.animate=[],nc.playinG.Animate.STYLE=["width","height","top","left","opacity"],nc.playinG.Animate.prototype.remove=function(){var queue=nc.playinG.Animate.queue,idx=queue.indexOf(this._e);-1!==idx&&queue.splice(idx,1)},nc.playinG.Animate.prototype.terminate=function(){for(prop in this._styles)this._e.style[prop]=this._styles[prop];clearInterval(this.interval),this.cb&&this.cb(),this.remove(this._e)},nc.playinG.Easing={ease:function(t,b,c,d){return c*t/d+b},easeIn:function(t,b,c,d){return c*(t/=d)*t+b},easeIn2:function(t,b,c,d){return c*(t/=d)*t*t*t+b},easeOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},easeOut2:function(t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOut:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},bounceIn:function(t,b,c,d){return c-nc.playinG.Easing.bounceOut(d-t,0,c,d)+b},bounceOut:function(t,b,c,d){return(t/=d)<1/2.75?7.5625*c*t*t+b:2/2.75>t?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:2.5/2.75>t?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},elasticIn:function(t,b,c,d,a,p){if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),!a||a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*d-s)*Math.PI/p))+b},elasticOut:function(t,b,c,d,a,p){if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),!a||a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin(2*(t*d-s)*Math.PI/p)+c+b}},nc.Connection=function(){},nc.Connection.prototype.getContentType=function(){return"application/x-www-form-urlencoded"},nc.Connection.prototype.run=function(data){this._run(data),this._timer=setTimeout(this.cancel.binder(this),5e3)},nc.Connection.prototype.cancel=function(){},nc.Connection.prototype.close=function(){},nc.AjaxConnection=function(url,callback){this._init(url,callback)},nc.AjaxConnection.prototype=new nc.Connection,nc.AjaxConnection.prototype._init=function(url,callback){window.XMLHttpRequest?this._xhr=new XMLHttpRequest:window.ActiveXObject&&(this._xhr=new ActiveXObject("Msxml2.XMLHTTP")),this._url=url,this._callback=callback},nc.AjaxConnection.prototype._run=function(data){var xhr=this._xhr;xhr.onreadystatechange=this._stateHandle.binder(this),data||this._post?(xhr.open("POST",this._url,!0),xhr.setRequestHeader("Content-Type",this.getContentType()),xhr.send(data)):(xhr.open("GET",this._url,!0),xhr.send(null))},nc.AjaxConnection.prototype._stateHandle=function(){this._xhr;4==this._xhr.readyState&&(200==this._xhr.status||304==this._xhr.status?this._onSuccess(this._xhr):this.cancel())},nc.AjaxConnection.prototype._onSuccess=function(xhr){this._callback&&this._callback(xhr.responseXML)},nc.JsonConnection=function(url,callback){this._init(url,callback)},nc.JsonConnection.prototype=new nc.AjaxConnection,nc.JsonConnection.prototype.isPost=function(bool){this._post=bool},nc.JsonConnection.prototype._onSuccess=function(data){var obj;try{obj=eval(/^\[/.test(data.responseText)?data.responseText:"("+data.responseText+")")}catch(e){return void this.cancel()}this._callback&&this._callback(obj)},nc.Jsonp=function(url,callbackFunc,callbackString){return this._aborted=0,this.url=url,this._callbackString=callbackString||"callback",this._callback=callbackFunc||null,this},nc.Jsonp.prototype=new nc.Connection,nc.Jsonp.Seek=0,nc.Jsonp.prototype={_complete:!1,setCallbackFunction:function(callback){this._callback=callback},setCallbackString:function(callback){this._callbackString=callback},load:function(){var script=this._script=document.createElement("script"),head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;nc.Jsonp.Seek++,window["_Jsonp_"+nc.Jsonp.Seek]=function(data){this._callback(data)}.binder(this);var url=this.url+(this.url.indexOf("?")<0?"?":"&")+this._callbackString+"=_Jsonp_"+nc.Jsonp.Seek;script.src=url,script.async=!0,head.insertBefore(script,head.firstChild)},run:function(){this.load()},setId:function(id){this._script&&(this._script.id=id)},getScript:function(){return this._script},removeScript:function(){this._script.parentNode().removeChild(this._script)},abort:function(){this._aborted=1,this._clean()},_clean:function(){if(this._script){var script=this._script;script.onload=script.onerror=script.onreadystatechange=null,this._script=null}}},nc.playinG.ModalLayer=function(){this._panel=document.createElement("div"),this._panel.className="modalG"},nc.playinG.ModalLayer.prototype.get=function(){return this._panel},nc.playinG.LoadingController=function(parent){this._parent=parent||document.body,this._panel,this._modalPanel,this._w=600,this._h=600,this._setUI(),this.hide()},nc.playinG.LoadingController.ISSHOW=!1,nc.playinG.LoadingController.__INSTANCE=null,nc.playinG.LoadingController.getInstance=function(){return nc.playinG.LoadingController.__INSTANCE||(nc.playinG.LoadingController.__INSTANCE=new nc.playinG.LoadingController),nc.playinG.LoadingController.__INSTANCE},nc.playinG.LoadingController.prototype={getPanel:function(){return this._panel},_setUI:function(){this._modalPanel=document.createElement("div"),this._modalPanel.className="modalG",nc.setStyle(this._modalPanel,"opacity",.5),this._panel=document.createElement("div"),this._panel.className="wrapLoadingG",this._panel.innerHTML=-1!=location.href.indexOf("aion")?'<img src="'+nc.imgUrl+'static/loading_aion.gif" alt="잠시만 기다려 주세요.">':'<img src="'+nc.imgUrl+'static/loading.gif" alt="잠시만 기다려 주세요.">',this._parent.appendChild(this._modalPanel),this._parent.appendChild(this._panel)},show:function(){nc.setStyle(this._panel,"display","block"),nc.setStyle(this._modalPanel,"display","block")},hide:function(){nc.setStyle(this._panel,"display","none"),nc.setStyle(this._modalPanel,"display","none")},setZIndex:function(idx){nc.setStyle(this._modalPanel,"zIndex",idx),nc.setStyle(this._panel,"zIndex",idx+1)},destroy:function(){this.hide(),this._panel&&(this._panel.parentNode.removeChild(this._panel),this._panel=null),this._modalPanel&&(this._modalPanel.parentNode.removeChild(this._modalPanel),this._modalPanel=null)}},nc.playinG.AlertController=function(parent){this._parent=parent||document.body,this._panel,this._modalPanel,this._w=600,this._h=600,this._setUI(),this._setEvent(),this.hide(),this.setZIndex(1000400)},nc.playinG.AlertController.ISSHOW=!1,nc.playinG.AlertController.__INSTANCE=null,nc.playinG.AlertController.getInstance=function(){return nc.playinG.AlertController.__INSTANCE||(nc.playinG.AlertController.__INSTANCE=new nc.playinG.AlertController),nc.playinG.AlertController.__INSTANCE},nc.playinG.AlertController.prototype={getPanel:function(){return this._panel},_setEvent:function(){nc.playinG.Event.addListener(this._close,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.hide()}.binder(this)),nc.playinG.Event.addListener(this._modalPanel,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.hide()}.binder(this))},_setUI:function(){var _span=(document.createElement("section"),document.createElement("header"),document.createElement("span")),_a=document.createElement("a"),_d=document.createElement("div");this._modalPanel=document.createElement("div"),this._modalPanel.className="modalG",nc.setStyle(this._modalPanel,"opacity",.5),this._panel=document.createElement("div"),this._panel.className="wrapAlertG",this._header=_d.cloneNode(!1),this._header.className="msgHeaderG",this._msg=_span.cloneNode(!1),this._close=_a.cloneNode(!1),this._close.className="msgCloseG",this._close.innerHTML="메시지닫기",this._header.appendChild(this._msg),this._header.appendChild(this._close),this._msgContent=_d.cloneNode(!1),this._msgContent.className="msgContentG",this._panel.appendChild(this._header),this._panel.appendChild(this._msgContent),this._parent.appendChild(this._modalPanel),this._parent.appendChild(this._panel)},show:function(func){nc.setStyle(this._panel,"display","block"),nc.setStyle(this._modalPanel,"display","block"),func&&this.setCallback(func)},hide:function(){nc.setStyle(this._panel,"display","none"),nc.setStyle(this._modalPanel,"display","none"),this.callback&&this.callback()},setCallback:function(func){this.callback=func},setCancelCallback:function(func){this.cancelCallback=func},setZIndex:function(idx){nc.setStyle(this._modalPanel,"zIndex",idx),nc.setStyle(this._panel,"zIndex",idx+1)},setMsg:function(msg){this._msg.innerHTML=msg},setMsgContent:function(msg){this._msgContent.innerHTML=msg},destroy:function(){this.hide(),this._panel&&(this._panel.parentNode.removeChild(this._panel),this._panel=null),this._modalPanel&&(this._modalPanel.parentNode.removeChild(this._modalPanel),this._modalPanel=null)}},nc.playinG.ConfirmController=function(parent){this._parent=parent||document.body,this._panel,this._modalPanel,this._w=600,this._h=600,this._setUI(),this._setEvent(),this.hide(),this.setZIndex(1000400),this._title=""},nc.playinG.ConfirmController.ISSHOW=!1,nc.playinG.ConfirmController.__INSTANCE=null,nc.playinG.ConfirmController.getInstance=function(){return nc.playinG.ConfirmController.__INSTANCE||(nc.playinG.ConfirmController.__INSTANCE=new nc.playinG.ConfirmController),nc.playinG.ConfirmController.__INSTANCE},nc.playinG.ConfirmController.prototype={setTitle:function(txt){this._title=txt},getTitle:function(){return this._title},getPanel:function(){return this._panel},_setEvent:function(){nc.playinG.Event.addListener(this._confirm,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.hide(),this.callback&&this.callback();var tit=this.getTitle();nc.trk("/이미지편집/레이어/"+tit+"/확인/")}.binder(this)),nc.playinG.Event.addListener(this._cancel,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.hide(),this.cancelCallback&&this.cancelCallback();var tit=this.getTitle();nc.trk("/이미지편집/레이어/"+tit+"/취소/")}.binder(this)),nc.playinG.Event.addListener(this._close,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.hide();var tit=this.getTitle();nc.trk("/이미지편집/레이어/"+tit+"/닫기/")}.binder(this))},_setUI:function(){{var _section=document.createElement("section"),_span=(document.createElement("header"),document.createElement("span")),_a=document.createElement("a"),_d=document.createElement("div");document.createElement("p")}this._modalPanel=document.createElement("div"),this._modalPanel.className="modalG",nc.setStyle(this._modalPanel,"opacity",.5),this._panel=document.createElement("div"),this._panel.className="wrapAlertG",this._header=_d.cloneNode(!1),this._header.className="msgHeaderG",this._msg=_span.cloneNode(!1),this._close=_a.cloneNode(!1),this._close.className="msgCloseG",this._close.innerHTML="메시지닫기",this._header.appendChild(this._msg),this._header.appendChild(this._close),this._msgContentWrap=_section.cloneNode(!1),this._msgContentWrap.className="msgContentG",this._msgContent=_span.cloneNode(!1),this._wrapMsgBtnG=_d.cloneNode(!1),this._wrapMsgBtnG.className="wrapMsgBtnG",this._confirm=_a.cloneNode(!1),this._confirm.className="btnTypeG",this._confirm.innerHTML="<span></span>확인",this._cancel=_a.cloneNode(!1),this._cancel.className="linkTypeG",this._cancel.innerHTML="취소",this._wrapMsgBtnG.appendChild(this._confirm),this._wrapMsgBtnG.appendChild(this._cancel),this._msgContentWrap.appendChild(this._msgContent),this._msgContentWrap.appendChild(this._wrapMsgBtnG),this._panel.appendChild(this._header),this._panel.appendChild(this._msgContentWrap),this._parent.appendChild(this._modalPanel),this._parent.appendChild(this._panel)},show:function(func,func2){nc.setStyle(this._panel,"display","block"),nc.setStyle(this._modalPanel,"display","block"),func&&this.setCallback(func),func2&&this.setCancelCallback(func2)},hide:function(){nc.setStyle(this._panel,"display","none"),nc.setStyle(this._modalPanel,"display","none")},setCallback:function(func){this.callback=func},setCancelCallback:function(func){this.cancelCallback=func},setZIndex:function(idx){nc.setStyle(this._modalPanel,"zIndex",idx),nc.setStyle(this._panel,"zIndex",idx+1)},setMsg:function(msg){this._msg.innerHTML=msg},setMsgContent:function(msg){this._msgContent.innerHTML=msg},destroy:function(){this.hide(),this._panel&&(this._panel.parentNode.removeChild(this._panel),this._panel=null),this._modalPanel&&(this._modalPanel.parentNode.removeChild(this._modalPanel),this._modalPanel=null)}},nc.playinG.UploadDom=UploadDom=function(){this._div=document.createElement("div"),this._span=document.createElement("span"),this._button=document.createElement("button"),this._a=document.createElement("a"),nc.playinG.Event.addListener(this._a,"click",function(evt){nc.playinG.Event.preventDefault(evt)}),this._ul=document.createElement("ul"),this._li=document.createElement("li"),this._h3=document.createElement("h3"),this._form=document.createElement("form"),this._textArea=document.createElement("textarea"),this._input=document.createElement("input"),this._header=document.createElement("header"),this._nav=document.createElement("nav"),this._containerG=this._div.cloneNode(!1),this._containerG.className="containerG cf",this._contentG=this._div.cloneNode(!1),this._contentG.className="contentG",this._headerG=this._header.cloneNode(!1),this._headerG.className="headerG",this.setHeader(),this._defaultG=this._div.cloneNode(!1),this._defaultG.className="uploadInitG defaultG",this._fileInitG=this._div.cloneNode(!1),this._fileInitG.className="uploadInitG fileInitG",this._urlInitG=this._div.cloneNode(!1),this._urlInitG.className="uploadInitG urlInitG",this._albumInitG=this._div.cloneNode(!1),this._albumInitG.className="uploadInitG albumInitG",this._dropInitG=this._div.cloneNode(!1),this._dropInitG.className="uploadInitG dropInitG",this._wrapUploadG=this._div.cloneNode(!1),this._wrapUploadG.className="wrapUploadG",this._fileSizeG=this._div.cloneNode(!1),this._fileSizeG.className="fileSizeG",this.currFileSize=this._span.cloneNode(!1),this.currFileSize.innerHTML="0",this.maxFileSize=this._span.cloneNode(!1),this.maxFileSize.innerHTML=" / 30M",this.addChild(this._fileSizeG,this.currFileSize),this.addChild(this._fileSizeG,this.maxFileSize),this._updateListParent=this._div.cloneNode(!1),nc.setCssText(this._updateListParent,"width:100%;height:100%;"),nc.setStyle(this._updateListParent,"position","relative"),nc.setStyle(this._updateListParent,"overflow","hidden"),this._updateList=this._div.cloneNode(!1),this._updateList.id="UpdateListG",this._updateList.className="updateListG cf",this._wrapAlbumG=this._div.cloneNode(!1),this._wrapAlbumG.className="wrapAlbumG",this._albumThumbGParent=this._div.cloneNode(!1),nc.setCssText(this._albumThumbGParent,"width:100%;height:100%;"),nc.setStyle(this._albumThumbGParent,"position","relative"),nc.setStyle(this._albumThumbGParent,"overflow","hidden"),this._albumThumbG=this._ul.cloneNode(!1),this._albumThumbG.className="albumThumbG cf",this._albumBoxShadow=this._div.cloneNode(!1),this._albumBoxShadow.className="albumBoxShadow",this._btnPhotoSelect=this._button.cloneNode(!1),this._btnPhotoSelect.className="btnPhotoSelect",this.addChild(this._albumThumbGParent,[this._albumThumbG,this._albumBoxShadow]),this.addChild(this._wrapAlbumG,[this._albumThumbGParent,this._btnPhotoSelect]),this._closeG=this._button.cloneNode(!1),this._closeG.className="closeG",this._btnPhotoUpload=this._button.cloneNode(!1),this._btnPhotoUpload.className="btnPhotoUpload",this._moveEdit=this._div.cloneNode(!1),this._moveEdit.className="moveEditG";var canvas=document.createElement("canvas");this._moveEdit.innerHTML=canvas.getContext?"<span>편집하기</span> 기능을 이용해서 멋진 사진을 만들어 보세요.":"최신 브라우저를 사용하시면 사진에 멋진 효과들을 적용할 수 있어요.",this.setTree()},nc.playinG.UploadDom.prototype.setTree=function(){this.addChild(this._updateListParent,this._updateList),this.addChild(this._wrapUploadG,this._fileSizeG),this.addChild(this._wrapUploadG,this._updateListParent),this.addChild(this._wrapUploadG,this._btnPhotoUpload),this.addChild(this._wrapUploadG,this._moveEdit),this.addChild(this._contentG,[this._defaultG,this._fileInitG,this._urlInitG,this._albumInitG,this._dropInitG,this._wrapUploadG,this._wrapAlbumG,this._closeG]),this.addChild(this._containerG,[this._headerG,this._contentG])},nc.playinG.UploadDom.prototype.hideEditInfo=function(){nc.setStyle(this._moveEdit,"display","none")},nc.playinG.UploadDom.prototype.get=function(dom){return this["_"+dom]},nc.playinG.UploadDom.prototype.getContainer=function(){return this._containerG},nc.playinG.UploadDom.prototype.getUpdateList=function(){return this._updateList},nc.playinG.UploadDom.prototype.addText=function(parent,text){var txt=document.createTextNode(text);return parent.appendChild(txt),parent},nc.playinG.UploadDom.prototype.addChild=function(parent,childs){if(!(childs instanceof Array))return void parent.appendChild(childs);for(var i=0;childs[i];i++)parent.appendChild(childs[i])},nc.playinG.UploadDom.prototype.setHeader=function(){this._MainMenu=this._nav.cloneNode(!1),this._MainMenu.className="mainMenuG",this._SubMenu=this._nav.cloneNode(!1),this._SubMenu.className="subMenuG moveG",this.imgUploadMenuG=this._ul.cloneNode(!1),this.imgUploadMenuG.className="imgUploadMenuG";var exploreG=this._li.cloneNode(!1),urlG=this._li.cloneNode(!1),albumG=this._li.cloneNode(!1);this._exploreG=this._a.cloneNode(!1),this._exploreG.className="exploreG",exploreG.appendChild(this._exploreG),this._urlG=this._a.cloneNode(!1),this._urlG.className="urlG",urlG.appendChild(this._urlG),this._albumG=this._a.cloneNode(!1),this._albumG.className="albumG",albumG.appendChild(this._albumG),this.addChild(this.imgUploadMenuG,[exploreG,urlG]),this._MainMenu.appendChild(this.imgUploadMenuG),this._SmenuFile=this._div.cloneNode(!1),this._SmenuFile.className="smenuFile";var titFileG=this._h3.cloneNode(!1);titFileG.className="titFileG";var subMenuListG=this._div.cloneNode(!1);subMenuListG.className="subMenuListG",this._iframe=document.createElement("iframe"),this._iframe.width=164,this._iframe.height=42,this._iframe.frameBorder=0,this._iframe.scrolling="no",this._iframe.allowTransparency="true",nc.setStyle(this._iframe,"border","0"),nc.setStyle(this._iframe,"borderStyle","none"),this.addChild(subMenuListG,[this._iframe]),this.addChild(this._SmenuFile,[titFileG,subMenuListG]),this._SmenuUrl=this._div.cloneNode(!1),this._SmenuUrl.className="smenuUrl";var titUrlG=this._h3.cloneNode(!1);titUrlG.className="titUrlG";var subMenuListG=this._div.cloneNode(!1);subMenuListG.className="subMenuListG";var urlForm=this._form.cloneNode(!1);this.urlUpload=this._textArea.cloneNode(!1),this.urlUpload.className="urlUpload",this.btnUrlUpload=this._input.cloneNode(!1),this.btnUrlUpload.className="btnUrlUpload",this.btnUrlUpload.setAttribute("type","button"),this.btnUrlUpload.setAttribute("value","사진 등록"),this.addChild(urlForm,[this.urlUpload,this.btnUrlUpload]),this.addChild(subMenuListG,[urlForm]),this.addChild(this._SmenuUrl,[titUrlG,subMenuListG]),this._SmenuAlbum=this._div.cloneNode(!1),this._SmenuAlbum.className="smenuAlbum";var titAlbumG=this._h3.cloneNode(!1);titAlbumG.className="titAlbumG";var subMenuListG=this._div.cloneNode(!1);subMenuListG.className="subMenuListG",this.albumListGParent=this._div.cloneNode(!1),nc.setStyle(this.albumListGParent,"overflow","hidden"),nc.setStyle(this.albumListGParent,"width",nc.addPx(260)),this.albumListG=this._ul.cloneNode(!1),this.albumListG.id="AlbumListG",this.albumListG.className="albumListG",this.addChild(this.albumListGParent,this.albumListG),this.addChild(subMenuListG,this.albumListGParent),this.addChild(this._SmenuAlbum,[titAlbumG,subMenuListG]),this._returnMenu=this._button.cloneNode(!1),this._returnMenu.className="returnMenuG",this.addChild(this._SubMenu,[this._SmenuFile,this._SmenuUrl,this._SmenuAlbum,this._returnMenu]),this.addChild(this._headerG,[this._MainMenu,this._SubMenu])},nc.playinG.Images=function(){this._images=[]},nc.playinG.Images.prototype.get=function(){return this._images},nc.playinG.Images.prototype.push=function(fileUrl,id,name,size,thumb){this._images.push({fileUrl:fileUrl,id:id,name:name,size:size,thumb:thumb})},nc.playinG.Images.prototype.remove=function(idx){this.splice(idx,1)},nc.playinG.Images.prototype.removeAll=function(){this._images=[]},nc.playinG.Images.prototype.length=function(){return this._images.length},nc.playinG.Images.prototype.splice=function(start,deletecount,items){items?this._images.splice(start,deletecount,items):this._images.splice(start,deletecount)},nc.playinG.Images.prototype.swap=function(s,e){var tmp=this._images[s];this._images[s]=this._images[e],this._images[e]=tmp},nc.playinG.Images.prototype.getSize=function(){for(var sizes=0,i=0,len=this._images.length;len>i;i++)sizes+="number"==typeof this._images[i].size?this._images[i].size:nc.integer(this._images[i].size);return sizes},nc.playinG.Images.prototype.getUrls=function(){for(var tmp=[],i=0,len=this._images.length;len>i;i++)tmp.push(this._images[i].fileUrl);return tmp},nc.playinG.DragUploadController=function(panel){this._panel=panel,this.onDrop=new Observer,this.onDragOver=new Observer,this.onDragOut=new Observer,window.File&&window.FileReader&&window.FileList&&window.Blob&&this._setUI()},nc.playinG.DragUploadController.prototype._setUI=function(){nc.playinG.Event.addListener(this._panel,"dragover",this.handleDragOver.binder(this),!1),nc.playinG.Event.addListener(this._panel,"dragleave",this.handleDragOut.binder(this),!1),nc.playinG.Event.addListener(this._panel,"drop",this.handleFileSelect.binder(this),!1)},nc.playinG.DragUploadController.prototype.handleDragOver=function(evt){evt.stopPropagation(),evt.preventDefault(),this.onDragOver.dispatch()},nc.playinG.DragUploadController.prototype.handleDragOut=function(evt){evt.stopPropagation(),evt.preventDefault(),this.onDragOut.dispatch()},nc.playinG.DragUploadController.prototype.handleFileSelect=function(evt){if(evt.stopPropagation(),evt.preventDefault(),evt.dataTransfer.files){var files=evt.dataTransfer.files;this.onDrop.dispatch(files)}},nc.playinG.Grid=function(parent,useEdit){this._row=1,this._col=1,this._showWidth=810,this._width,this._height,this._margin=30,this._useEdit=useEdit,this._parent=parent||document.body,this._nodes=[],this._imageNodes=[],this._imageWrapNodes=[],this.onChange=new nc.playinG.Observer,this.onRemove=new nc.playinG.Observer,this.onContentResize=new nc.playinG.Observer,this.onAdded=new nc.playinG.Observer,this.onEdit=new nc.playinG.Observer,this._tmp=document.createElement("div"),this._tmp.style.cssText="top:0;left:0;width:100%;",this._tmp.setAttribute("unselectable","on");var s=this._tmp.style;s.webkitUserSelect="none",s.webkitUserDrag="none",s.MozUserSelect="none",this._imgTmp=document.createElement("img"),this.setNodesPosition()},nc.playinG.Grid.prototype={addImage:function(url,isntEditable){this._addImage(url,isntEditable)},_addImage:function(url,isntEditable){var l,n,img,itemWrap;if(url){if(itemWrap=this._tmp.cloneNode(!1),itemWrap.className="updateItemG",imgWrap=this._tmp.cloneNode(!1),imgWrap.className="updateImgG",img=this._imgTmp.cloneNode(!0),img.src=url+"?dummy="+ +new Date,nc.setStyle(itemWrap,"width",nc.addPx(this._width)),nc.setStyle(itemWrap,"height",nc.addPx(this._height)),nc.setStyle(imgWrap,"width",nc.addPx(this._width)),nc.setStyle(imgWrap,"height",nc.addPx(this._height)),this._imageNodes.push(imgWrap),this._imageWrapNodes.push(itemWrap),l=this._imageWrapNodes.length,this._row*this._col<l){this._col++,this._update();var height=this._height*this._col+this._margin*(this._col-1);nc.setStyle(this._parent,"height",nc.addPx(height)),this.onContentResize.dispatch(height)}n=this._nodes[l-1],imgWrap.appendChild(img),itemWrap.appendChild(imgWrap),this._parent.appendChild(itemWrap),nc.setStyle(itemWrap,"top",nc.getStyle(n,"top")),nc.setStyle(itemWrap,"left",nc.getStyle(n,"left")),this.setCloseButton(itemWrap,itemWrap);var canvas=document.createElement("canvas");canvas.getContext&&!isntEditable&&this._useEdit&&this.setEditButton(itemWrap,itemWrap),this.setDraggable(img,itemWrap),this.onAdded.dispatch(itemWrap)}},_endUploadAnimation:function(){for(var animate=nc.playinG.Animate.animate,i=0;animate[i];i++)"upload"===animate[i].type&&animate[i].terminate()},setCloseButton:function(n,p){var close=new nc.playinG.RemoveImageButton(n,p);close.onRemove.add(function(n){var idx=this._imageWrapNodes.indexOf(n);this.removeImage(idx),this.setNodesNum(),this._update(),this.onRemove.dispatch(idx),nc.trk("/이미지업로드/등록이미지/삭제버튼/")},this)},setEditButton:function(n,p){var edit=new nc.playinG.EditImageButton(n,p);edit.onEdit.add(function(n){var idx=this._imageWrapNodes.indexOf(n);this.onEdit.dispatch(idx),nc.trk("/이미지업로드/등록이미지/편집버튼/")},this)},setNodesNum:function(){var l=this._imageWrapNodes.length;this._row*(this._col-1)>=l&&this._col--},setDraggable:function(img,itemWrap){node=new nc.playinG.DraggableUploadNode(img,itemWrap),node.onDragStart.add(function(){this.setZIndex(this.findImage(itemWrap))},this),node.onDrag.add(this.drag,this),node.onDrop.add(this.drop,this)},removeImage:function(idx){if(-1!==idx){var itemWrap=this._imageWrapNodes[idx];itemWrap.parentNode.removeChild(itemWrap),this._imageWrapNodes.splice(idx,1),this._imageNodes.splice(idx,1)}},removeImages:function(){for(var i=this._imageWrapNodes.length-1;i>=0;i--)this.removeImage(i)},drag:function(o){{var img=o.node;this.hitTest(img)}},drop:function(o){var img=o.node,idx=this.hitTest(img);this.swapImage(img,idx)},update:function(){this._update()},_update:function(){this.removeNodes(),this.setNodesPosition(),this.setImagesPosition()},getNodesWidth:function(){return this._width=parseInt(this._showWidth/this._row-this._margin),this._width},getNodesHeight:function(){return this._height=parseInt(this._width/3*2),this._height},getNodesPosition:function(){for(var tmp=[],c=0,clen=this._col;clen>c;c++)for(var i=0,len=this._row;len>i;i++){var obj={};obj.x=0===i?0:this._width*i+this._margin*i,obj.y=0===c?0:this._height*c+this._margin*c,tmp.push(obj)}return tmp},setNodesPosition:function(){var w,pos;w=this.getNodesWidth(),h=this.getNodesHeight(),pos=this.getNodesPosition(),this.createNodes(w,h,pos),this.append(this._nodes)},removeNodes:function(){for(var nodes=this._nodes,i=0,len=nodes.length;len>i;i++)this._parent.removeChild(nodes[i]);this._nodes=[]},setOpacity:function(o){for(var images=this._imageWrapNodes,i=0,len=images.length;len>i;i++)images[i].style.opacity=o||"0.6"},createNodes:function(w,h,pos){for(var p=pos,i=0,len=p.length;len>i;i++){var n=this._tmp.cloneNode(!0),s=n.style;s.width=nc.addPx(w),s.height=nc.addPx(h),s.top=nc.addPx(p[i].y),s.left=nc.addPx(p[i].x),this._nodes.push(n)}return this._nodes},setImagesPosition:function(){for(var n,s,w,i=0,len=this._imageWrapNodes.length;len>i;i++)n=this._nodes[i],s=this._imageNodes[i],w=this._imageWrapNodes[i],s.width=this._width,s.height=this._height,nc.setStyle(s,"width",nc.addPx(this._width)),nc.setStyle(s,"height",nc.addPx(this._height)),nc.setStyle(w,"width",nc.addPx(this._width)),nc.setStyle(w,"height",nc.addPx(this._height)),nc.setStyle(w,"top",nc.getStyle(n,"top")),nc.setStyle(w,"left",nc.getStyle(n,"left"))},findImage:function(n){var idx=this._imageWrapNodes.indexOf(n);return idx},setZIndex:function(n){for(var imgs=this._imageWrapNodes,i=0,len=imgs.length;len>i;i++)imgs[i].style.zIndex=i!==n?0:1},append:function(n){for(var p=this._parent,i=0,len=n.length;len>i;i++)p.insertBefore(n[i],p.firstChild)},hitTest:function(img){for(var n=this._nodes,i=0,len=n.length;len>i;i++)if(nc.nodesHitTest(img,n[i]))return i;return-1},swapImage:function(img,i){var mImg,sImg,mNode,sNode,len=this._imageWrapNodes.length,imgLen=this.findImage(img);if(i>=len||-1===i||1===len||imgLen===i){var ns=this._nodes[imgLen].style;return void new nc.playinG.Animate(img,{top:ns.top,left:ns.left},{duration:300})}var tmp=this._imageWrapNodes[imgLen];this._imageWrapNodes[imgLen]=this._imageWrapNodes[i],this._imageWrapNodes[i]=tmp,mImg=this._imageWrapNodes[imgLen],sImg=this._imageWrapNodes[i],mNode=this._nodes[imgLen],sNode=this._nodes[i],new nc.playinG.Animate(mImg,{top:mNode.style.top,left:mNode.style.left},{duration:300}),new nc.playinG.Animate(sImg,{top:sNode.style.top,left:sNode.style.left},{duration:300}),this.onChange.dispatch({s:imgLen,t:i})},setWidth:function(w){this._width=w,this._update()},setRow:function(r){this._row=r,this._update()},getRow:function(){return this._row},setCol:function(r){this._col=r,this._update()},setShowCol:function(){this._update()},setMargin:function(m){this._margin=m,this._update()},setInit:function(){this.removeImages(),this._imageNodes=[],this._imageWrapNodes=[],this._update()},getNodes:function(){return this._nodes},setShowWidth:function(w){this._showWidth=w},getHeight:function(){return this._height*this._col+this._margin*this._col+2}},nc.playinG.RemoveImageButton=function(node,parent){this._nodePanel=node,this._parent=parent,this._panel=null,this.onOver=new nc.playinG.Observer,this.onOut=new nc.playinG.Observer,this.onRemove=new nc.playinG.Observer,this._setUI(),this._addEvent()},nc.playinG.RemoveImageButton.prototype={_setUI:function(){this._panel=document.createElement("a"),this._panel.innerHTML="삭제",this._panel.className="deleteImg",this._parent&&this._parent.appendChild(this._panel)},_addEvent:function(){nc.playinG.Event.addListener(this._panel,"click",this._onClick.binder(this)),nc.playinG.Event.addListener(this._panel,"over",this._onOver.binder(this)),nc.playinG.Event.addListener(this._panel,"out",this._onOut.binder(this))},_onClick:function(evt){nc.playinG.Event.preventDefault(evt),this.onRemove.dispatch(this._nodePanel)},_onOver:function(){nc.playinG.Event.preventDefault(evt),this.show(),this.onOver.dispatch(this._nodePanel)},_onOut:function(){nc.playinG.Event.preventDefault(evt),this.hide(),this.onOut.dispatch(this._nodePanel)},show:function(){nc.setStyle(this._panel,"display","block")},hide:function(){nc.setStyle(this._panel,"display","none")}},nc.playinG.EditImageButton=function(node,parent){this._nodePanel=node,this._parent=parent,this._panel=null,this.onOver=new nc.playinG.Observer,this.onOut=new nc.playinG.Observer,this.onEdit=new nc.playinG.Observer,this._setUI(),this._addEvent()},nc.playinG.EditImageButton.prototype={_setUI:function(){this._panel=document.createElement("a"),this._panel.innerHTML="편집",this._panel.className="editImgG",this._parent&&this._parent.appendChild(this._panel)},_addEvent:function(){nc.playinG.Event.addListener(this._panel,"click",this._onClick.binder(this)),nc.playinG.Event.addListener(this._panel,"over",this._onOver.binder(this)),nc.playinG.Event.addListener(this._panel,"out",this._onOut.binder(this))},_onClick:function(evt){nc.playinG.Event.preventDefault(evt),this.onEdit.dispatch(this._nodePanel)},_onOver:function(){nc.playinG.Event.preventDefault(evt),this.show(),this.onOver.dispatch(this._nodePanel)},_onOut:function(){nc.playinG.Event.preventDefault(evt),this.hide(),this.onOut.dispatch(this._nodePanel)},show:function(){nc.setStyle(this._panel,"display","block")},hide:function(){nc.setStyle(this._panel,"display","none")}},nc.playinG.DraggableUploadNode=function(node,pnode){if(node){this.node=node,this.pnode=pnode,this.onDrag=new Observer,this.onDragStart=new Observer,this.onDrop=new Observer,this.node.setAttribute("unselectable","on");var s=this.node.style;return s.webkitUserSelect="none",s.webkitUserDrag="none",s.MozUserSelect="none",s.cursor="pointer",this.startDrag(),nc.playinG.Event.addListener(this.node,"click",this.clickNode.binder(this)),this}},nc.playinG.DraggableUploadNode.prototype=new nc.playinG.DraggableNode,nc.playinG.DraggableUploadNode.prototype.dragNode=function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt);
var x=evt.screenX-this._x,y=evt.screenY-this._y;if(x||y){var ns=this.pnode.style,top=nc.integer(ns.top)+y;ns.top=nc.addPx(top),ns.left=nc.addPx(nc.integer(ns.left)+x),this._x=evt.screenX,this._y=evt.screenY,this.onDrag.dispatch({node:this.pnode})}},nc.playinG.DraggableUploadNode.prototype.releaseNode=function(){this._dragEventHandler&&this._dragEventHandler.remove(),this._releaseEventHandler&&this._releaseEventHandler.remove(),this._outEventHandler&&this._outEventHandler.remove(),this.onDrop.dispatch({node:this.pnode})},nc.playinG.ExternalUploadController=function(){this._url=null,this.onLoad=new nc.playinG.Observer,this.onError=new nc.playinG.Observer},nc.playinG.ExternalUploadController.prototype.addImage=function(url){this._url=url;var img=new Image;nc.playinG.Event.addListener(img,"load",this.onLoadImage.binder(this)),nc.playinG.Event.addListener(img,"error",this.onErrorImage.binder(this)),img.src=url},nc.playinG.ExternalUploadController.prototype.onLoadImage=function(){this.onLoad.dispatch(this._url)},nc.playinG.ExternalUploadController.prototype.onErrorImage=function(){this.onError.dispatch()},nc.playinG.UploadController=function(parent,dropPanel,frame,options){this._panel=parent||document.body,this._dragPanel=dropPanel,this._frame=frame,this._options=options,this._thumbPanel,this._images=new nc.playinG.Images,this._THUMBNAILLISTNUM=4,this.onAdded=new nc.playinG.Observer,this.onDragOver=new nc.playinG.Observer,this.onDragOut=new nc.playinG.Observer,this.onRemove=new nc.playinG.Observer,this.onEdit=new nc.playinG.Observer,this._grid=new nc.playinG.Grid(this._panel,this._options.useEdit),this._grid.onAdded.add(function(){this.onAdded.dispatch(this._grid.getHeight())},this),this._grid.onChange.add(function(d){this._onSwapImage(d)},this),this._grid.onRemove.add(function(idx){this._removeFile(idx),this.onRemove.dispatch(this._grid.getHeight())},this),this._grid.onEdit.add(function(d){this.onEdit.dispatch(d)},this),this._external=new nc.playinG.ExternalUploadController,this._external.onLoad.add(this.addImage,this),this._external.onError.add(this.errorExternalImage,this),this._local=new nc.playinG.LocalUploadController(this._options),this._local.onAttach.add(this.addImage,this),this._dragPanel&&(this._dragUpload=new nc.playinG.DragUploadController(this._dragPanel),this._dragUpload.onDrop.add(this.onFileDrop,this),this._dragUpload.onDragOver.add(this.onFileDragOver,this),this._dragUpload.onDragOut.add(this.onFileDragOut,this)),this.fileDropList=[]},nc.playinG.UploadController.prototype={getFrameDocument:function(){var frmDoc,frm=this._frame;if(frm)return frmDoc=frm.contentWindow||frm.contentDocument,frmDoc.document&&(frmDoc=frmDoc.document),frmDoc},_removeFile:function(idx){this._images._images[idx].id&&this._local.remove(this._images._images[idx].id),this._images.remove(idx),0===this._images.length()&&(this._grid._row=1,this._grid._col=1)},onLocalSuccess:function(){this._local.onSuccess()},onFileDragOut:function(){this.onDragOut.dispatch()},onFileDragOver:function(){this.onDragOver.dispatch()},onFileUploadContinue:function(){this.fileDropList.length>0&&this.onFileUpload(this.fileDropList.shift())},onFileUpload:function(file){if(file){var imageType=/image.*/;if(!file.type.match(imageType))return nc.playinG.LoadingController.getInstance().hide(),nc.playinG.AlertController.getInstance().setMsg("사진 경로를 찾을 수 없습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>JPG, GIF, PNG, BMP 형식만 등록할 수 있습니다.</p><p>사진의 주소(URL)가 잘못 입력 되었거나</p><p>지원되지 않는 형식일 수 있으니 확인 후 </p><p>다시 등록해 주시기 바랍니다.</p>"),void nc.playinG.AlertController.getInstance().show(this.onFileUploadContinue.binder(this));var reader=new FileReader;reader.onloadend=function(evt){var img=evt.target.result,fDoc=this.getFrameDocument();fDoc&&fDoc.getElementById("imgStr")&&(fDoc.getElementById("imgStr").value=img.split(",")[1],fDoc.getElementById("uploadStringForm").submit())}.binder(this),reader.readAsDataURL(file)}},onFileDrop:function(files){for(var i=0,len=files.length;len>i;i++)this.fileDropList.push(files[i]);files.length>0&&(nc.playinG.LoadingController.getInstance().setZIndex(this._options.zIndex+2),nc.playinG.LoadingController.getInstance().show()),this.onFileUpload(this.fileDropList.shift())},addExternalImage:function(url){this._external.addImage(url)},errorExternalImage:function(){nc.playinG.AlertController.getInstance().setMsg("사진 경로를 찾을 수 없습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>JPG, GIF, PNG, BMP 형식만 등록할 수 있습니다.</p><p>사진의 주소(URL)가 잘못 입력 되었거나</p><p>지원되지 않는 형식일 수 있으니 확인 후 </p><p>다시 등록해 주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show()},setMaxImages:function(m){this._options.maxImages=m},addImage:function(data){var len=this._images.length();if(0===this._options.maxImages||this._options.maxImages<=len)return nc.playinG.AlertController.getInstance().setMsg("등록된 파일 개수가 너무 많습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>한 번에 등록할 수 있는 파일 개수가 초과되었습니다.</p><p>불필요한 사진은 삭제 후 다시 등록해 주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show(),this.fileDropList=[],nc.playinG.LoadingController.getInstance().hide(),void this._local.remove(data.id);if(len<this._THUMBNAILLISTNUM?this._THUMBNAILLISTNUM!==this._grid.getRow()&&this._grid.setRow(len+1):(this._grid._update(),this._grid.setRow(this._THUMBNAILLISTNUM)),"object"==typeof data){if(data.size>5242880)return nc.playinG.AlertController.getInstance().setMsg("사진 용량이 초과 되었습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>한 파일당 최대 5MB까지 등록할 수 있습니다.</p>"),nc.playinG.AlertController.getInstance().show(),this.fileDropList=[],nc.playinG.LoadingController.getInstance().hide(),void this._local.remove(data.id);if(this._images.getSize()+nc.integer(data.size)>31457280)return nc.playinG.AlertController.getInstance().setMsg("사진 용량이 초과 되었습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>첨부하신 사진의 용량이 큽니다.</p><p>최대 30MB까지 등록할 수 있습니다.</p>"),nc.playinG.AlertController.getInstance().show(),this.fileDropList=[],nc.playinG.LoadingController.getInstance().hide(),void this.remove(data.id);this._images.push(data.fileURL,data.id,data.name,data.size,data.thumbnailURL),this._grid.addImage(data.fileURL)}else this._images.push(data,"","",0,""),this._grid.addImage(data,!0);this.fileDropList.length>0?this.onFileUpload(this.fileDropList.shift()):nc.playinG.LoadingController.getInstance().hide()},addImages:function(arr){for(var i=(arr.length,0);arr[i];i++)this.addImage(arr[i])},_onSwapImage:function(d){this._images.swap(d.s,d.t)},show:function(){this._panel.style.display="block"},hide:function(){this._panel.style.display="none"},init:function(){this._grid.setInit();for(var tmpImg=[],i=this._images._images.length-1;i>=0;i--)tmpImg.push(this._images._images[i].id);this._images.removeAll(),0===this._images.length()&&(this._grid._row=1,this._grid._col=1)},getImages:function(){return this._images},getFileList:function(data){var lastAddedImage=data[data.length-1];this.addImage(lastAddedImage)},setGridWidth:function(w){this._grid.setShowWidth(w)}},nc.playinG.ImageUpload=function(parent,options){this.parent=parent||document.body,this.options={margin:50,minWidth:400,iframe:"btnFileUpload.html",editFrame:"FileModify.html",token:null,tokenUrl:null,channel:null,fileInfo:null,removeFileInfo:null,validateTokenInfo:null,thumbMargin:30,onComplete:null,uploadUrl:"http://"+nc.staticUrl+"upload.plaync.co.kr/file",modalZindex:999998,zIndex:999999,thumbnailUrl:null,maxImages:99,objectName:null,onShowFunc:null,onHideFunc:null,isUrlUpload:!0,removePrevTokenImages:!0,localFileEnable:!1,useEdit:!0,stringActionUrl:null,base64Modify:null,isCharacterProfile:!1,characterImgStringDownload:null,characterCategoryId:"0301",characterServerId:"1",characterId:null,isProfileUpload:!1},nc.extend(this.options,options),this.options.tmpFileInfo=this.options.fileInfo,this.options.tmpRemoveFileInfo=this.options.removeFileInfo,this.options.tmpUploadUrl=this.options.uploadUrl,this.options.tokenUrl?this.setOptionsConfig():(this.options.token,this._setInit()),this._isShowSubMenu=!1},nc.playinG.ImageUpload.prototype={setOptionsConfig:function(){var dummy,tokenUrl=this.options.tokenUrl,channelParam="";dummy=/\?/.test(tokenUrl)?"&dummy="+ +new Date:"?dummy="+ +new Date;var conClass=-1!==tokenUrl.indexOf(".jsonp")?nc.Jsonp:nc.JsonConnection,token=new conClass(tokenUrl+dummy+channelParam,function(data){if(!data)return nc.playinG.AlertController.getInstance().setMsg("죄송합니다. 오류가 발생했습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>오류가 발생해서 페이지를 '새로 고침(F5)' 해야 합니다.</p><p>작성하셨던 소중한 글이 모두 지워지게 되므로,</p><p>다른 곳에 저장 후 '새로 고침' 해주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show(),null;if(!data.token&&!data.tokenId&&!data.createToken)return nc.playinG.AlertController.getInstance().setMsg("죄송합니다. 오류가 발생했습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>오류가 발생해서 페이지를 '새로 고침(F5)' 해야 합니다.</p><p>작성하셨던 소중한 글이 모두 지워지게 되므로,</p><p>다른 곳에 저장 후 '새로 고침' 해주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show(),null;if(data.isBanned)return nc.playinG.AlertController.getInstance().setMsg("죄송합니다."),nc.playinG.AlertController.getInstance().setMsgContent('<p>회원님께서는 제재로 인해 서비스 이용이 중지되었습니다.</p><p><a href="http://cscenter.plaync.co.kr"><strong>고객센터 바로가기</strong></a></p>'),nc.playinG.AlertController.getInstance().show(),null;var t=data.token||data.tokenId||data.createToken.tokenid;(data.token||data.tokenId||data.createToken.tokenid)&&(this.options.token=t,nc.$("token")&&(nc.$("token").value=t),this.options.fileInfo=/\?token=\d+/.test(this.options.tmpFileInfo)?this.options.tmpFileInfo:this.options.tmpFileInfo+"?token="+this.options.token,("SNS"!==this.options.channel||"ProfileImage"!==this.options.channel)&&(this.options.removeFileInfo=this.options.tmpRemoveFileInfo)),this.options.uploadUrl=this.options.tmpUploadUrl+"/"+this.options.channel+"/upload/"+this.options.token,(data.uploadUrl||data.createToken.uploadurl)&&(this.options.uploadUrl=data.uploadUrl||data.createToken.uploadurl),data.channel&&(this.options.channel=data.channel),this.options.base64Modify=this.options.tmpUploadUrl+"/"+this.options.channel+"/base64upload/"+this.options.token+"/",this.options.stringActionUrl="http://"+nc.staticUrl+"upload.plaync.co.kr/file/"+this.options.channel+"/base64upload/"+this.options.token,this.options.base64Modify=this.options.tmpUploadUrl+"/"+this.options.channel+"/base64upload/"+this.options.token+"/",this.setUploadFrame(),this.editor&&this.editor.setFrame(),this._setInit()}.binder(this));"SNS"===this.options.channel||"ProfileImage"===this.options.channel?token.run("channel="+this.options.channel):token.run()},validateToken:function(){if(this.options.validateTokenInfo){var validateTokenInfo=this.options.validateTokenInfo,conClass=-1!==validateTokenInfo.indexOf(".jsonp")?nc.Jsonp:nc.JsonConnection,token=new conClass(validateTokenInfo,function(data){data&&(data.validateToken.result?this.show():(this.setOptionsConfig(),this.show()))}.binder(this));token.run("token="+this.options.token)}},getToken:function(){return this.options.token},_setInit:function(){this.modal&&this.html||(this.modal=new nc.playinG.ModalLayer,this.parent.appendChild(this.modal.get()),this.html=new UploadDom,this.parent.appendChild(this.html.getContainer()),this.mainMenuPanel=this.html._MainMenu,this.subMenuPanel=this.html._SubMenu,this.submenu=[this.html._SmenuFile,this.html._SmenuUrl,this.html._SmenuAlbum],this.menuButton=[this.html._exploreG,this.html._urlG],this.content=[this.html._fileInitG,this.html._urlInitG,this.html._albumInitG,this.html._dropInitG,this.html._wrapUploadG,this.html._wrapAlbumG,this.html._defaultG],this.options.isUrlUpload||(nc.setStyle(this.html._urlG,"display","none"),nc.removeClassName(this.html._defaultG,"defaultG"),nc.addClassName(this.html._defaultG,"sandboxG")),this.frame=this.html._iframe,this.albumListGParent=this.html.albumListGParent,this.albumListG=this.html.albumListG,this.btnPhotoUpload=this.html._btnPhotoUpload,this._currMenu=null,this.btnUploadSize=98,this.upload=new nc.playinG.UploadController(this.html._updateList,this.html._contentG,this.frame,this.options),this.upload.onDragOver.add(function(){this.showContent(3)}.binder(this)),this.upload.onDragOut.add(function(){var idx=this.menuButton.indexOf(this._currMenu);-1===idx&&(idx=6),this.showContent(idx)}.binder(this)),this.upload.onAdded.add(function(h){var listParentH=h;this.html.urlUpload.value="",this.showContent(),listParentH>this.setGridSize().h&&(listParentH=this.setGridSize().h),nc.setStyle(this.html._updateListParent,"height",nc.addPx(listParentH)),nc.setStyle(this.content[4],"height",listParentH+this.btnUploadSize),this.uploadContentScroll&&(this.uploadContentScroll.changeHeight(h,listParentH),this.uploadContentScroll.moveBottom()),this.setUploadAndAlbumSize(),this.html.currFileSize.innerHTML=Math.round(this.upload._images.getSize()/1024/1024*100)/100,this.show()},this),this.upload.onRemove.add(function(h){var listParentH=h,idx=this.menuButton.indexOf(this._currMenu);-1===idx&&(idx=6),this.showContent(idx),listParentH>this.setGridSize().h&&(listParentH=this.setGridSize().h),nc.setStyle(this.html._updateListParent,"height",nc.addPx(listParentH)),nc.setStyle(this.content[4],"height",listParentH+this.btnUploadSize),this.uploadContentScroll&&this.uploadContentScroll.changeHeight(h,listParentH),this.setUploadAndAlbumSize(),this.html.currFileSize.innerHTML=Math.round(this.upload._images.getSize()/1024/1024*100)/100},this),this.upload.onEdit.add(function(i){this.editor||(this.editor=new nc.playinG.ImageEditor(this.parent,this.options),this.editor.onComplete.add(function(){this.editor.hide(),this.editor.initMenu(),this.editor.initCommand()},this),this.editor.onHide.add(function(){this.initMenu(),this.show()},this)),this.editor.initCommand(),this._currEditFileId=this.upload._images._images[i].id,this.editor.getImageString(this._currEditFileId),this.hide(),this.editor.initMenu(),this.editor.show()},this),this.menuSize={w:300,h:null},this.setGridSize(),this.upload.setGridWidth(this.gridSize.w-this.options.thumbMargin),this._setUI(),this._addEvent(),this.show())},init:function(){var opts=this.options;opts.token&&(this.upload.init(),this.initMenu(),this.upload.onRemove.dispatch(this.upload._grid.getHeight()),this._setUI(),this.html.urlUpload.value="")},getActionUrl:function(){return this.options.uploadUrl},getStringActionUrl:function(){return this.options.stringActionUrl},getCategoryId:function(){return this.options.characterCategoryId},getServerId:function(){return this.options.characterServerId},getCharacterId:function(){return this.options.characterId},setMaxImages:function(val){this.options.maxImages=val,this.upload.setMaxImages(val)},setUploadFrame:function(){this.options.iframe&&this.frame&&(this.frame.src=this.options.iframe),this.options.objectName&&this.frame&&(this.frame.src+="?parentName="+this.options.objectName+"&")},_setUI:function(){nc.setStyle(this.modal.get(),"zIndex",this.options.modalZindex),nc.setStyle(this.html._containerG,"zIndex",this.options.zIndex),nc.setStyle(this.html._containerG,"overflow-y","scroll"),this.setUploadFrame(),this.setUploadAndAlbumSize(),nc.setStyle(this.subMenuPanel,"left",nc.addPx(310)),this.showContent(6),nc.setStyle(this.albumListGParent,"height",nc.addPx(this.setGridSize().h)),this.uploadContentScroll=new nc.Scrollbar(this.html._updateListParent,this.html._updateList,"#ccc")},_addEvent:function(){nc.playinG.Event.addListener(this.html.urlUpload,"focus",function(){var url=this.html.urlUpload,val=url.value;val||(this.html.urlUpload.className="urlUpload_")}.binder(this)),nc.playinG.Event.addListener(this.html.urlUpload,"blur",function(){var url=this.html.urlUpload,val=url.value;val||(this.html.urlUpload.className="urlUpload")}.binder(this)),nc.playinG.Event.addListener(this.html._exploreG,"click",function(){this._currMenu=this.html._exploreG,this.setButton(0),this.showSubMenu(0),this.showContent(0),nc.trk("/이미지업로드/내PC에서찾기/")}.binder(this)),nc.playinG.Event.addListener(this.html._urlG,"click",function(){this._currMenu=this.html._urlG,this.setButton(1),this.showSubMenu(1),this.showContent(1),nc.trk("/이미지업로드/URL로등록하기/")}.binder(this)),nc.playinG.Event.addListener(this.html._returnMenu,"click",function(){this._isShowSubMenu=!1,this.initMenu(),nc.trk("/이미지업로드/홈버튼/")}.binder(this)),nc.playinG.Event.addListener(this.html.btnUrlUpload,"click",function(){var url=this.html.urlUpload,val=url.value;return val?(this.upload._external.addImage(val),void nc.trk("/이미지업로드/URL로등록하기/등록버튼/")):(nc.playinG.AlertController.getInstance().setMsg("입력된 주소(URL)가 없습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>등록할 사진의 주소(URL)를 입력해 주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show(),!1)}.binder(this)),nc.playinG.Event.addListener(this.html._closeG,"click",function(){this.hide(),nc.trk("/이미지업로드/닫기버튼/")}.binder(this)),nc.playinG.Event.addListener(this.html._btnPhotoSelect,"click",function(){for(var i=0;this._albumSelect[i];i++)this.upload._external.addImage(this._albumSelect[i])}.binder(this)),nc.playinG.Event.addListener(this.btnPhotoUpload,"click",function(){this.options.onComplete&&this.options.onComplete(this.upload._images._images),this.hide(),nc.trk("/이미지업로드/사진올리기버튼/")}.binder(this)),nc.playinG.Event.addListener(window,"resize",function(){this.setUploadAndAlbumSize()}.binder(this)),nc.playinG.Event.addListener(this.html._headerG,"mousemove",function(evt){if(this._isShowSubMenu){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt);var point=nc.getMousePosToScreen(evt);point.x>0&&point.x<18&&new nc.playinG.Animate(this.subMenuPanel,{left:nc.addPx(89)},{duration:150,easing:nc.playinG.Easing.bounceIn,callback:function(){this._isShowSubMenuAnimate=!0}.binder(this)}),point.x>90&&this._isShowSubMenuAnimate&&new nc.playinG.Animate(this.subMenuPanel,{left:nc.addPx(15)},{duration:80,callback:function(){this._isShowSubMenuAnimate=!1}.binder(this)})}}.binder(this))},initMenu:function(){this._currMenu=null,nc.removeClassName(this.mainMenuPanel,"on"),nc.setStyle(this.mainMenuPanel,"left",nc.addPx(89));new nc.playinG.Animate(this.subMenuPanel,{left:nc.addPx(310)},{duration:300,callback:function(){this._isShowSubMenu=!1}.binder(this)});this.setButton(-1),this.showContent(6)},getAlbumList:function(data){if(this._albumData=data,data){this._albumButton=[];for(var i=0;data[i];i++){var li=document.createElement("li"),button=document.createElement("a"),tmp='<div class="bgAlbumBox1"></div><div class="bgAlbumBox2"></div><div class="wrapAlbumImgG">	<img src="'+data[i].list[0].imgUrl+'" alt="" />	<div class="albumMaskG">오른쪽 리스트에서<br />원하시는 사진을<br />선택해 주세요</div>	<span class="glossyG"></span></div><p>'+data[i].albumNm+" ("+data[i].length+")</p></a>";!function(idx,button,obj){nc.playinG.Event.addListener(button,"click",function(){obj.showAlbumContent(idx)})}(i,button,this),button.innerHTML=tmp,li.appendChild(button),this.albumListG.appendChild(li),this._albumButton.push(button)}}},showAlbumContent:function(idx){this.showContent(5);for(var i=0;this._albumButton[i];i++)i===idx?nc.addClassName(this._albumButton[i],"on"):nc.removeClassName(this._albumButton[i],"on");if(this._albumData){var tmp=document.createElement("li"),label=document.createElement("label"),img=document.createElement("img"),input=document.createElement("input"),parent=this.html._albumThumbG;parent.innerHTML="",this._albumSelect=[];for(var i=0;this._albumData[idx].list[i];i++){var album=this._albumData[idx],li=tmp.cloneNode(!1);li.className="albumItem";var cl=label.cloneNode(!1);cl["for"]=i;var cImg=img.cloneNode(!1);cImg.src=album.list[i].imgUrl,nc.setCssText(cImg,"width:100%;");var cInput=input.cloneNode(!1);cInput.type="checkbox",cl.appendChild(cImg),cl.appendChild(cInput),li.appendChild(cl),function(item,album,idx,cInput,obj){nc.playinG.Event.addListener(item,"click",function(evt){if(nc.playinG.Event.preventDefault(evt),nc.hasClassName(item,"checked")){nc.removeClassName(item,"checked");var imgIdx=obj._albumSelect.indexOf(album.list[idx].imgUrl);cInput.checked=!1,obj._albumSelect.splice(imgIdx)}else nc.addClassName(item,"checked"),cInput.checked=!0,obj._albumSelect.push(album.list[idx].imgUrl)})}(li,album,i,cInput,this),parent.appendChild(li)}var h=parent.offsetHeight;h>this.setGridSize().h&&(h=this.setGridSize().h),nc.setStyle(this.content[5],"height",nc.addPx(h))}},setUploadAndAlbumSize:function(){var size=this.setGridSize(),listParentH=nc.integer(nc.getStyle(this.html._updateListParent,"height")),h=this.btnUploadSize+listParentH,top=50;nc.getBrowserSize().h>h&&(top=(nc.getBrowserSize().h-h)/2),nc.setStyle(this.content[4],"top",nc.addPx(top)),nc.setStyle(this.content[4],"height",nc.addPx(h)),nc.setStyle(this.content[4],"width",nc.addPx(size.w)),nc.setStyle(this.content[4],"left",nc.addPx(size.l))},setGridSize:function(){var bsize=nc.getBrowserSize(),sSize=nc.getAvailSize(),gWidth=sSize.w/10*7-this.menuSize.w-2*this.options.margin,minWidth=this.options.minWidth,margin=this.options.margin;return this.gridSize={w:gWidth,h:gWidth/3*2,t:0,l:0},this.gridSize.w<minWidth&&(this.gridSize.w=minWidth),this.gridSize.h<minWidth/3*2&&(this.gridSize.h=minWidth/3*2),this.gridSize.l=bsize.w<this.gridSize.w+margin+this.menuSize.w?margin+this.menuSize.w:(bsize.w-this.menuSize.w-this.gridSize.w)/2+this.menuSize.w,this.gridSize.t=bsize.h<(bsize.h-this.gridSize.h)/2+this.gridSize.h+margin+68?margin:(bsize.h-this.gridSize.h)/2-68,{w:this.gridSize.w,h:this.gridSize.h,l:this.gridSize.l,t:this.gridSize.t}},setButton:function(idx){for(var i=0;this.menuButton[i];i++)idx===i?nc.addClassName(this.menuButton[i],"select"):nc.removeClassName(this.menuButton[i],"select")},showSubMenu:function(idx){var bRemovePrevAnimate=!1;nc.addClassName(this.mainMenuPanel,"on"),nc.setStyle(this.mainMenuPanel,"left",nc.addPx(0)),this.options.localFileEnable&&(bRemovePrevAnimate=!0);for(var i=(new nc.playinG.Animate(this.subMenuPanel,{left:nc.addPx(15)},{duration:300,removePrevAnimate:bRemovePrevAnimate,callback:function(){this._isShowSubMenu=!0}.binder(this)}),0);this.submenu[i];i++)idx===i?nc.setStyle(this.submenu[i],"display","block"):nc.setStyle(this.submenu[i],"display","none")},showContent:function(idx){var tmp=idx;6===idx&&(tmp=6),this.upload._images.length()>0&&(tmp=4),(5===idx||this._currMenu===this.content[5])&&(tmp=5),window.File&&window.FileReader&&window.FileList&&window.Blob||0===tmp&&(tmp=6);for(var i=0;this.content[i];i++)tmp===i?nc.setStyle(this.content[i],"display","block"):nc.setStyle(this.content[i],"display","none")},hide:function(){this.options.onHideFunc&&this.options.onHideFunc(),nc.setStyle(document.documentElement,"overflowY","scroll"),nc.setStyle(document.documentElement,"overflowX","auto"),nc.removeClassName(this.parent,"activeG"),nc.setStyle(this.html.getContainer(),"display","none"),nc.setStyle(this.modal.get(),"display","none"),nc.setStyle(this.subMenuPanel,"left",nc.addPx(310))},showNewToken:function(){this.show(),this.setOptionsConfig()},showAfterValidateToken:function(){this.options.token&&(this.options.validateTokenInfo?this.validateToken():this.show())},show:function(){var opts=this.options;opts.token&&(this.options.onShowFunc&&this.options.onShowFunc(),nc.setStyle(document.documentElement,"overflowY","hidden"),nc.setStyle(document.documentElement,"overflow","hidden"),nc.addClassName(this.parent,"activeG"),nc.setStyle(this.html.getContainer(),"display","block"),nc.setStyle(this.modal.get(),"display","block"),this.html.getContainer().focus(),this.options.localFileEnable&&(this._currMenu=this.html._exploreG,this.setButton(0),this.showContent(0),this.showSubMenu(0)),nc.trk("/이미지업로드/실행/"))},onSearchFileClick:function(){nc.trk("/이미지업로드/내PC에서찾기/파일찾기/")},onFileServerError:function(){nc.playinG.AlertController.getInstance().setMsg("파일 서버 에러입니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>파일 서버 에러입니다.</p><p>서비스 이용에 불편을 드려 죄송합니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onExceedMaxUpload:function(){nc.playinG.AlertController.getInstance().setMsg("허용 업로드 용량 초과"),nc.playinG.AlertController.getInstance().setMsgContent("<p>허용 업로드 용량을 초과하였습니다.</p><p>서비스 이용에 불편을 드려 죄송합니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onExceedFileSize:function(){nc.playinG.AlertController.getInstance().setMsg("사진 용량이 초과 되었습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>한 파일당 최대 5MB까지 등록 할 수 있습니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onExceedFileSize3M:function(){nc.playinG.AlertController.getInstance().setMsg("사진 용량이 초과 되었습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>한 파일당 최대 3MB까지 등록 할 수 있습니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onInvalidRequest:function(){nc.playinG.AlertController.getInstance().setMsg("잘못된 요청입니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>서비스 이용에 불편을 드려 죄송합니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onInvalidChannel:function(){nc.playinG.AlertController.getInstance().setMsg("잘못된 요청입니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>서비스 이용에 불편을 드려 죄송합니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onInvalidType:function(){nc.playinG.AlertController.getInstance().setMsg("사진 경로를 찾을 수 없습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>JPG, JPEG, PNG, BMP 형식만 등록할 수 있습니다.</p><p>사진의 주소(URL)가 잘못 입력 되었거나</p><p>지원되지 않는 형식일 수 있으니 확인 후 </p><p>다시 등록해 주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onInvalidToken:function(){nc.playinG.AlertController.getInstance().setMsg("죄송합니다. 오류가 발생했습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>오류가 발생해서 페이지를 '새로 고침(F5)' 해야 합니다.</p><p>작성하셨던 소중한 글이 모두 지워지게 되므로,</p><p>다른 곳에 저장 후 '새로 고침' 해주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onExpiredToken:function(){nc.playinG.AlertController.getInstance().setMsg("죄송합니다. 오류가 발생했습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>오류가 발생해서 페이지를 '새로 고침(F5)' 해야 합니다.</p><p>작성하셨던 소중한 글이 모두 지워지게 되므로,</p><p>다른 곳에 저장 후 '새로 고침' 해주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onExceedFile:function(){nc.playinG.AlertController.getInstance().setMsg("등록된 파일 개수가 너무 많습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>한 번에 등록할 수 있는 파일 개수가 초과되었습니다.</p><p>불필요한 사진은 삭제 후 다시 등록해 주시기 바랍니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onAuthFail:function(){nc.playinG.AlertController.getInstance().setMsg("죄송합니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>로그아웃 되었거나 권한이 없습니다.</p>"),nc.playinG.AlertController.getInstance().show(),nc.playinG.LoadingController.getInstance().hide()},onLocalSuccess:function(){this.upload._local.onSuccess()},onModifySuccess:function(){for(var i=0;this.upload._images._images[i];i++)if(this.upload._images._images[i].id===this._currEditFileId){var f=nc.getFirstChild(this.upload._grid._imageNodes[i]),img=new Image;nc.playinG.Event.addListener(img,"load",function(){f.src=img.src,nc.playinG.LoadingController.getInstance().hide()}.binder(this)),img.src=f.src+"?modify="+new Date;break}},getImages:function(){return this.upload._images._images},getSize:function(){return this.upload._images.getSize()},destroy:function(){var container=this.html.getContainer(),modal=this.modal.get();container.parentNode.removeChild(container),modal.parentNode.removeChild(modal),this.upload=null}},nc.playinG.LocalUploadController=function(options){this._options=options,this.onAttach=new nc.playinG.Observer,this.onRemove=new nc.playinG.Observer},nc.playinG.LocalUploadController.prototype={onSuccess:function(){var fileInfo=this._options.fileInfo,dummy=/\?/.test(fileInfo)?"&dummy="+ +new Date:"?dummy="+ +new Date,conClass=-1!==fileInfo.indexOf(".jsonp")?nc.Jsonp:nc.JsonConnection,fileInfo=new conClass(fileInfo+dummy,this.getFileInfo.binder(this));"SNS"===this._options.channel||"ProfileImage"===this._options.channel?fileInfo.run("channel="+this._options.channel):fileInfo.run()},getFileInfo:function(data){var d=data;data.tokenfileinfo&&(d=data.tokenfileinfo,d=eval(d));var _obj={},len=d.length;if(!(0>=len)){var fid=d[len-1].id;d[len-1].fileURL||(d[len-1].fileURL=this._options.thumbnailUrl+"/"+fid),this.onAttach.dispatch(d[len-1])}},remove:function(){this.onRemoved()},onRemoved:function(){this.onRemove.dispatch()}},nc.playinG.SlideBar=function(track,handle,range){this._track=track,this._handle=handle,this._currValue=0,this._range=range||{min:0,max:130,width:130,valueMin:-45,valueMax:45},this.onMove=new Observer,this._setData(),this._addEvent()},nc.playinG.SlideBar.prototype={_addEvent:function(){this.draggable=new nc.playinG.DraggableNode(this._handle,"off","on",this._range),nc.setStyle(this._handle,"cursor","e-resize"),this.draggable.onDrag.add(function(){var l=nc.integer(nc.getStyle(this._handle,"left"));this._currValue=this._range.valueMin+l*this.point,this.onMove.dispatch(this._currValue)},this)},_setData:function(){this.point=(Math.abs(this._range.valueMin)+Math.abs(this._range.valueMax))/this._range.width}},nc.playinG.CanvasManager=function(parent,w,h){this._canvasArr=[],this._parent=parent,this.w=w,this.h=h,this.mode=null},nc.playinG.CanvasManager.prototype.setMode=function(mode){this.mode=mode},nc.playinG.CanvasManager.prototype.getMode=function(){return this.mode},nc.playinG.CanvasManager.prototype.addEvent=function(){nc.playinG.Event.addListener(document.body,"mousedown",this.onMousedown.binder(this))},nc.playinG.CanvasManager.prototype.push=function(c){this._canvasArr.push(c)},nc.playinG.CanvasManager.prototype.pop=function(){this._canvasArr.pop()},nc.playinG.CanvasManager.prototype.shift=function(){this._canvasArr.shift()},nc.playinG.CanvasManager.prototype.unshift=function(){this._canvasArr.unshift()},nc.playinG.CanvasManager.prototype.pushFirst=function(c){return this._canvasArr.splice(0,0,c),this._canvasArr[0]},nc.playinG.CanvasManager.prototype.lastCanvas=function(){var c=this._canvasArr;return c.length>0?c[c.length-1]:null},nc.playinG.CanvasManager.prototype.onMousedown=function(evt){nc.getMousePosition(evt)},nc.playinG.CanvasManager.prototype.getCurrCanvasContext=function(){var c=this._canvasArr,ctx=null;return 0===c.length?!1:ctx=c[c.length-1].getContext()},nc.playinG.CanvasManager.prototype.getCanvas=function(){return this._canvasArr},nc.playinG.CanvasManager.prototype.setCanvasAllZindex=function(idx){for(var c=this._canvasArr,i=0;c[i];i++){var cs=c[i];cs.isImageCanvas||cs.isMainCanvas||nc.setStyle(cs.getCanvas(),"zIndex",idx)}},nc.playinG.Canvas=function(parent,w,h,isMainCanvas,isImageCanvas){this._parent=parent,this.w=w,this.h=h,this.ctx,this.isMainCanvas=isMainCanvas||!1,this.isImageCanvas=isImageCanvas||!1,this._drawState=null,this._create()},nc.playinG.Canvas.LENGTH=0,nc.playinG.Canvas.prototype._create=function(){var p=this._parent,c=this.canvas=document.createElement("canvas"),cs=c.style;c.width=this.w||600,c.height=this.h||600,c.setAttribute("unselectable","on");var s=c.style;s.webkitUserSelect="none",s.webkitUserDrag="none",s.MozUserSelect="none",c.setAttribute("is-main-canvas",this.isMainCanvas),c.setAttribute("is-Image-canvas",this.isImageCanvas),c["is-main-canvas"]=this.isMainCanvas,c["is-Image-canvas"]=this.isImageCanvas,cs.position="absolute",cs.zIndex=this.isMainCanvas?10:1,cs.top=this.canvas.style.left=0,cs.cursor="pointer",c.getContext&&(this.ctx=c.getContext("2d")),this.isMainCanvas?(this.onDown=new Observer,this.onMove=new Observer,this.onUp=new Observer,this._addEvent(c),p&&p.appendChild(c)):p&&p.insertBefore(c,p.lastChild)},nc.playinG.Canvas.prototype._remove=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.ctx=this.canvas=null
},nc.playinG.Canvas.prototype.getCanvas=function(){return this.canvas},nc.playinG.Canvas.prototype.getContext=function(){return this.ctx},nc.playinG.Canvas.prototype._addEvent=function(c){this.eDown=nc.playinG.Event.addListener(c,"mousedown",this.onMousedown.binder(this))},nc.playinG.Canvas.prototype._removeEvent=function(){this.eMove&&this.eMove.remove(),this.eUp&&this.eUp.remove(),this.eOut&&this.eOut.remove()},nc.playinG.Canvas.prototype.onMousedown=function(evt){var m=nc.getMousePosition(evt),c=this.canvas;this.eMove=nc.playinG.Event.addListener(c,"mousemove",this.onMousemove.binder(this)),this.eUp=nc.playinG.Event.addListener(c,"mouseup",this.onMouseup.binder(this)),this.eOut=nc.playinG.Event.addListener(c,"mouseout",this.onMouseup.binder(this)),this.onDown.dispatch(m)},nc.playinG.Canvas.prototype.onMousemove=function(evt){var m=nc.getMousePosition(evt);this.onMove.dispatch(m)},nc.playinG.Canvas.prototype.onMouseup=function(evt){var m=nc.getMousePosition(evt);this._removeEvent(),this.onUp.dispatch(m)},nc.playinG.Canvas.prototype.onMouseout=function(evt){nc.getMousePosition(evt)},nc.playinG.Canvas.prototype.setSize=function(w,h){this.w=w,this.h=h,this.canvas.setAttribute("width",this.w),this.canvas.setAttribute("height",this.h)},nc.playinG.Canvas.prototype.getSize=function(){return{w:this.w,h:this.h}},TransFormController=function(Canvas){this._panel,this.imgCanvas=Canvas,this._canvas=Canvas.canvas,this._x=0,this._y=0,this._w=200,this._h=200,this._edgeW=10,this._edgeH=10,this.transResize=["nw","ne","sw","se"],this._edges=[],this._init()},TransFormController.prototype._init=function(){this._canvas&&(this.setPanel(),this.createEdge(),this.setEdgePosition())},TransFormController.prototype.setPosition=function(x,y){this._x=x,this._y=y},TransFormController.prototype.setSize=function(w,h){this._w=w,this._h=h},TransFormController.prototype.setSizeAndPosition=function(x,y,w,h){this.setPosition(x,y),this.setSize(w,h)},TransFormController.prototype.getSizeAndPosition=function(){return{x:this._x,y:this._y,w:this._w,h:this._h}},TransFormController.prototype.getSelectPixels=function(){return{x:this._x,y:this._y,w:this._x+this._w,h:this._y+this._h}},TransFormController.prototype.getParent=function(){return this._canvas.parentNode},TransFormController.prototype.setPanel=function(){if(this._panel)return this._panel;var size=this.imgCanvas.getSize();this._panel=document.createElement("div");var panel=new Draggable(this._panel);panel.onDrag.add(function(k){var p=this._panel,s=p.style,y=parseInt(s.top)+k.y,x=parseInt(s.left)+k.x;s.top=y+"px",s.left=x+"px",this.setPosition(x,y),this.setEdgePosition()},this),this.getParent().appendChild(this._panel),this.setPosition(size.w/2-this._w/2,size.h/2-this._h/2),this.setStyle()},TransFormController.prototype.setStyle=function(){if(this._panel){var s=this._panel.style;s.cssText="position:absolute;top:"+this._y+"px;left:"+this._x+"px;",s.cssText+="width:"+this._w+"px;height:"+this._h+"px",s.cssText+="border:2px dashed #000000;cursor:move;z-index:2;"}},TransFormController.prototype.display=function(){if(this._panel){var s=this._panel.style;s.top=this._y+"px",s.left=this._x+"px",s.width=this._w+"px",s.height=this._h+"px"}},TransFormController.prototype.setEdgePosition=function(){this.createEdge();for(var ew=this._edgeW/2,eh=this._edgeH/2,pos=[{x:this._x-ew,y:this._y-eh},{x:this._x+this._w-ew,y:this._y-eh},{x:this._x-ew,y:this._y+this._h-eh},{x:this._x+this._w-ew,y:this._y+this._h-eh}],i=0,len=4;len>i;i++){var edge=this._edges[i];edge.style.cssText="width:"+this._edgeW+"px;height:"+this._edgeH+"px",edge.style.cssText+="position:absolute;border:1px solid #000000;background-color:#ccc;",edge.style.cssText+="top:"+pos[i].y+"px;left:"+pos[i].x+"px;z-index:2;cursor:pointer;"}},TransFormController.prototype.destroy=function(){this._panel.parentNode.removeChild(this._panel);for(var i=0,len=4;len>i;i++){var edge=this._edges[i];edge.parentNode.removeChild(edge)}},TransFormController.prototype.createEdge=function(){if(!this._panel)return!1;if(this._edges.length>0)return this._edges;for(var div=document.createElement("div"),tmp=document.createDocumentFragment(),i=0,len=4;len>i;i++){this._edges[i]=div.cloneNode(!1);var edgePanel=new Draggable(this._edges[i]);edgePanel.onDrag.add(function(i){return function(k){var p=this._edges[i],s=p.style,ew=this._edgeW/2,top=(this._edgeH/2,parseInt(s.top)+k.y+"px"),left=parseInt(s.left)+k.x+"px";switch(s.top=top,s.left=left,i){case 1:this._edges[0].style.top=top,this._edges[3].style.left=left;break;case 2:this._edges[0].style.left=left,this._edges[3].style.top=top;break;case 3:this._edges[1].style.left=left,this._edges[2].style.top=top;break;case 0:this._edges[1].style.top=top,this._edges[2].style.left=left}var t0=this._getPosition(this._edges[0]),t1=this._getPosition(this._edges[1]),t2=this._getPosition(this._edges[2]),t3=this._getPosition(this._edges[3]),px=Math.min(t0.x,t1.x,t2.x,t3.x);py=Math.min(t0.y,t1.y,t2.y,t3.y),sx=Math.max(t0.x,t1.x,t2.x,t3.x),sy=Math.max(t0.y,t1.y,t2.y,t3.y),this.setSizeAndPosition(px+ew,py+ew,sx-px,sy-py),this.display()}}(i),this),tmp.appendChild(this._edges[i])}this.getParent().appendChild(tmp)},TransFormController.prototype.getScrolled=function(){var t=document.body.scrollTop,l=document.body.scrollLeft;return t||(t=document.documentElement.scrollTop),l||(l=document.documentElement.scrollLeft),{t:t,l:l}},TransFormController.prototype._getPosition=function(node){for(var c={x:0,y:0,w:0,h:0},e=node,w=e.offsetWidth,h=e.offsetHeight;e&&(c.x+=e.offsetLeft||0,c.y+=e.offsetTop||0,e=e.offsetParent,this._canvas.parentNode!=e););return c.w=c.x+w,c.h=c.y+h,c},nc.Effect={},nc.Effect.list=["effect1","effect2","effect3","effect4","effect5","effect6","effect7","effect8","effect9","effect10","effect11","effect12"],nc.Effect.setImage=function(filterImageUrl){nc.Effect.overalyImg1=new Image,nc.Effect.overalyImg1.src=filterImageUrl+"pattern_mask.jpg",nc.Effect.overalyImg2=new Image,nc.Effect.overalyImg2.src=filterImageUrl+"overlay_mask.jpg",nc.Effect.overalyImg3=new Image,nc.Effect.overalyImg3.src=filterImageUrl+"multiply_mask.jpg"},nc.Effect.range=function(n){return Math.min(255,Math.max(0,n))},nc.Effect.grayscale=function(pixels){for(var d=pixels.data,i=0,len=d.length;len>i;i+=4)nc.Effect.setGrayscale(d,i);return pixels},nc.Effect.setGrayscale=function(pixels,offset){var d=pixels,r=d[offset],g=d[offset+1],b=d[offset+2],v=.2126*r+.7152*g+.0722*b;d[offset]=d[offset+1]=d[offset+2]=v},nc.Effect.xray=function(pixels){for(var d=pixels.data,i=0,len=d.length;len>i;i+=4)nc.Effect.setXray(d,i);return pixels},nc.Effect.setXray=function(pixels,offset){var d=pixels;d[offset+0]=255-d[offset+0],d[offset+1]=255-d[offset+1],d[offset+2]=255-d[offset+2]},nc.Effect.threshold=function(pixels){for(var d=pixels.data,i=0,len=d.length;len>i;i+=4)nc.Effect.setThreshold(d,i);return pixels},nc.Effect.setThreshold=function(pixels,offset){var d=pixels,t=113,r=d[offset],g=d[offset+1],b=d[offset+2],v=.2126*r+.7152*g+.0722*b>=t?255:0;return d[offset]=d[offset+1]=d[offset+2]=v,pixels},nc.Effect.brightness=function(pixels){for(var d=pixels.data,i=0,len=d.length;len>i;i+=4)nc.Effect.setBrightness(d,i);return pixels},nc.Effect.setBrightness=function(pixels,offset){var d=pixels,a=33;return d[offset]+=a,d[offset+1]+=a,d[offset+2]+=a,pixels},nc.Effect.mosaic=function(pixels,s,w,h){var d=pixels.data;if(s&&w&&h)return nc.Effect.selectApplyMosaic(pixels,s,w,h);for(var i=0,len=d.length;len>i;i+=4*nc.Effect.mosaic.SIZE)nc.Effect.setMosaic(d,i);return pixels},nc.Effect.mosaic.SIZE=8,nc.Effect.selectApplyMosaic=function(pixels,s,w){for(var d=pixels.data,k=0,i=4*(s.y*w+s.x),len=4*(s.y*w+s.w);len>i;i+=4){k=nc.Effect.mosaic.SIZE;for(var j=i,jlen=4*(s.h*w+s.x);jlen>j;j+=4*w)nc.Effect.mosaic.SIZE===k&&(r=d[j],g=d[j+1],b=d[j+2],k=1),d[j]=r,d[j+1]=g,d[j+2]=b,k++}return pixels},nc.Effect.setMosaic=function(pixels,offset){for(var d=pixels,i=offset,len=offset+4*nc.Effect.mosaic.SIZE;len>i;i+=4)i===offset&&(r=d[offset],g=d[offset+1],b=d[offset+2]),d[i]=r,d[i+1]=g,d[i+2]=b;return pixels},nc.Effect.selectApply=function(func,pixels,s,w){for(var d=pixels.data,i=4*(s.y*w+s.x),len=4*(s.y*w+s.w);len>i;i+=4)for(var j=i,jlen=4*(s.h*w+s.x);jlen>j;j+=4*w)func(d,j);return pixels},nc.Effect.Filter={},nc.Effect.Filter.saturation=function(pixels,t){t||(t=.3);for(var d=pixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2],avg=(r+g+b)/3;r=nc.Effect.range(avg+t*(r-avg)),g=nc.Effect.range(avg+t*(g-avg)),b=nc.Effect.range(avg+t*(b-avg)),d[i]=r,d[i+1]=g,d[i+2]=b}return pixels},nc.Effect.Filter.posterize=function(pixels,levels){levels||(levels=70);for(var s=Math.floor(255/levels),d=pixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2];r=nc.Effect.range(Math.floor(r/s)*s),g=nc.Effect.range(Math.floor(g/s)*s),b=nc.Effect.range(Math.floor(b/s)*s),d[i]=r,d[i+1]=g,d[i+2]=b}return pixels},nc.Effect.Filter.tint=function(pixels,min,max){min||(min=[50,35,10]),max||(max=[190,190,230]);for(var d=pixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2];r=nc.Effect.range((r-min[0])*(255/(max[0]-min[0]))),g=nc.Effect.range((g-min[1])*(255/(max[1]-min[1]))),b=nc.Effect.range((b-min[2])*(255/(max[2]-min[2]))),d[i]=r,d[i+1]=g,d[i+2]=b}return pixels},nc.Effect.Filter.contrast=function(pixels,val){val||(val=.8);for(var d=pixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2];r=nc.Effect.range(255*((r/255-.5)*val+.5)),g=nc.Effect.range(255*((g/255-.5)*val+.5)),b=nc.Effect.range(255*((b/255-.5)*val+.5)),d[i]=r,d[i+1]=g,d[i+2]=b}return pixels},nc.Effect.Filter.grayScale=function(pixels){for(var d=pixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2],avg=(r+g+b)/3;d[i]=avg,d[i+1]=avg,d[i+2]=avg}return pixels},nc.Effect.Filter.bias=function(pixels,val){for(var d=pixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2];r=nc.Effect.range(r*(r/255/((1/val-1.9)*(.9-r/255)+1))),g=nc.Effect.range(g*(g/255/((1/val-1.9)*(.9-g/255)+1))),b=nc.Effect.range(b*(b/255/((1/val-1.9)*(.9-b/255)+1))),d[i]=r,d[i+1]=g,d[i+2]=b}return pixels},nc.Effect.Filter.brightness=function(pixels,t){t||(t=20);for(var d=pixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2];r=nc.Effect.range(r+t),g=nc.Effect.range(g+t),b=nc.Effect.range(b+t),d[i]=r,d[i+1]=g,d[i+2]=b}return pixels},nc.Effect.Filter.adjust=function(pixels,ra,ga,ba){ra||(ra=1),ga||(ga=1),ba||(ba=1);for(var d=pixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2];r=nc.Effect.range(r*(1+ra)),g=nc.Effect.range(g*(1+ga)),b=nc.Effect.range(b*(1+ba)),d[i]=r,d[i+1]=g,d[i+2]=b}return pixels},nc.Effect.Filter.softLight=function(pixels){for(var top=nc.Effect.copyCanvas(pixels),tPixels=top.getContext().getImageData(0,0,pixels.width,pixels.height),d=pixels.data,t=tPixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2],tr=(d[i+3],t[i]),tg=t[i+1],tb=t[i+2];r=r>128?255-(255-r)*(255-(tr-128))/255:r*(tr+128)/255,g=g>128?255-(255-g)*(255-(tg-128))/255:g*(tg+128)/255,b=b>128?255-(255-b)*(255-(tb-128))/255:b*(tb+128)/255,d[i]=r,d[i+1]=g,d[i+2]=b}return pixels},nc.Effect.Filter.screen=function(pixels){for(var top=nc.Effect.copyCanvas(pixels),tPixels=top.getContext().getImageData(0,0,pixels.width,pixels.height),d=pixels.data,t=tPixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2],a=d[i+3],tr=t[i],tg=t[i+1],tb=t[i+2];r=nc.Effect.range(255-(255-tr)*(255-r)/255),g=nc.Effect.range(255-(255-tg)*(255-g)/255),b=nc.Effect.range(255-(255-tb)*(255-b)/255),d[i]=r,d[i+1]=g,d[i+2]=b,d[i+3]=a}return pixels},nc.Effect.copyCanvas=function(pixels,img){var canvas=new nc.playinG.Canvas(null,pixels.width,pixels.height,!1,!0);return img?canvas.getContext().drawImage(img,0,0,pixels.width,pixels.height):canvas.getContext().putImageData(pixels,0,0),canvas},nc.Effect.Filter.add=function(pixels,pixels2){pixels2||(pixels2=pixels);for(var top=nc.Effect.copyCanvas(pixels),bot=nc.Effect.copyCanvas(pixels2),tPixels=top.getContext().getImageData(0,0,pixels.width,pixels.height),bPixels=bot.getContext().getImageData(0,0,pixels.width,pixels.height),d=bPixels.data,t=tPixels.data,i=0,len=d.length;len>i;i+=4){var tr=(d[i],d[i+1],d[i+2],d[i+3],t[i]),tg=t[i+1],tb=t[i+2];d[i]=tr,d[i+1]=tg,d[i+2]=tb}return bPixels},nc.Effect.Filter.overlay=function(pixels,pixels2){pixels2||(pixels2=pixels);for(var top=nc.Effect.copyCanvas(pixels),bot=nc.Effect.copyCanvas(pixels2),tPixels=top.getContext().getImageData(0,0,pixels.width,pixels.height),bPixels=bot.getContext().getImageData(0,0,pixels.width,pixels.height),d=bPixels.data,t=tPixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2],a=d[i+3],tr=t[i],tg=t[i+1],tb=t[i+2];r=nc.Effect.range(r>128?255-2*(255-tr)*(255-r)/255:r*tr*2/255),g=nc.Effect.range(g>128?255-2*(255-tg)*(255-g)/255:g*tg*2/255),b=nc.Effect.range(b>128?255-2*(255-tb)*(255-b)/255:b*tb*2/255),d[i]=r,d[i+1]=g,d[i+2]=b,d[i+3]=a}return bPixels},nc.Effect.Filter.multiply=function(pixels,pixels2){pixels2||(pixels2=pixels);for(var top=nc.Effect.copyCanvas(pixels),bot=nc.Effect.copyCanvas(pixels2),tPixels=top.getContext().getImageData(0,0,pixels.width,pixels.height),bPixels=bot.getContext().getImageData(0,0,pixels.width,pixels.height),d=bPixels.data,t=tPixels.data,i=0,len=d.length;len>i;i+=4){var r=d[i],g=d[i+1],b=d[i+2],a=d[i+3],tr=t[i],tg=t[i+1],tb=t[i+2];r=nc.Effect.range(tr*r/255),g=nc.Effect.range(tg*g/255),b=nc.Effect.range(tb*b/255),d[i]=r,d[i+1]=g,d[i+2]=b,d[i+3]=a}return bPixels},nc.Effect.Filter.maskOverlay=function(pixels){var patt=nc.Effect.copyCanvas(pixels,nc.Effect.overalyImg2),pPixels=patt.getContext().getImageData(0,0,pixels.width,pixels.height),bot=nc.Effect.copyCanvas(pixels),bPixels=bot.getContext().getImageData(0,0,pixels.width,pixels.height),npPixels=nc.Effect.Filter.overlay(pPixels,bPixels);return npPixels},nc.Effect.Filter.maskOverlay2=function(pixels){var patt=nc.Effect.copyCanvas(pixels,nc.Effect.overalyImg1),pPixels=patt.getContext().getImageData(0,0,pixels.width,pixels.height),over=nc.Effect.copyCanvas(pixels,nc.Effect.overalyImg2),oPixels=over.getContext().getImageData(0,0,pixels.width,pixels.height),normal=nc.Effect.copyCanvas(pixels,nc.Effect.overalyImg3),nPixels=normal.getContext().getImageData(0,0,pixels.width,pixels.height),bottom=nc.Effect.copyCanvas(pixels),bPixels=bottom.getContext().getImageData(0,0,pixels.width,pixels.height),newPix=null;return newPix=nc.Effect.Filter.multiply(pPixels,bPixels),newPix=nc.Effect.Filter.overlay(oPixels,newPix),newPix=nc.Effect.Filter.multiply(nPixels,newPix)},nc.Effect.Cloudy=function(pixels){var p,over,p=nc.Effect.Filter.tint(pixels,[0,0,-100],[220,220,210]);return over=nc.Effect.copyCanvas(p),over.getContext().globalAlpha=.8,oPixels=over.getContext().getImageData(0,0,pixels.width,pixels.height),p=nc.Effect.Filter.overlay(p,oPixels)},nc.Effect.DreamBlur=function(pixels){var p=nc.Effect.Filter.multiply(pixels);return p},nc.Effect.CreamyGreen=function(pixels){var p=nc.Effect.Filter.screen(pixels);return p},nc.Effect.Romantic=function(pixels){var p=nc.Effect.Filter.overlay(pixels);return p},nc.Effect.maskOverlay=function(pixels){var p=nc.Effect.Filter.maskOverlay(pixels);return p},nc.Effect.maskOverlay2=function(pixels){var p=nc.Effect.Filter.maskOverlay2(pixels);return p},nc.Effect.zIndex=2e6,nc.Effect.loading=function(){nc.playinG.LoadingController.getInstance().setZIndex(nc.Effect.zIndex),nc.playinG.LoadingController.getInstance().show()},nc.Effect.loaded=function(){nc.playinG.LoadingController.getInstance().hide()},nc.Effect.effect1=function(pixels){var p=nc.Effect.Filter.saturation(pixels,.9);return p=nc.Effect.Filter.contrast(p,1.15),p=nc.Effect.Filter.tint(pixels,[0,-40,-80],[210,250,200]),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect2=function(pixels){var p=nc.Effect.Filter.tint(pixels,[-20,-20,-20],[255,355,355]);return p=nc.Effect.Filter.screen(p),p=nc.Effect.Filter.softLight(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect3=function(pixels){var p=nc.Effect.Filter.grayScale(pixels),p=nc.Effect.Filter.tint(p,[0,-20,-20],[245,235,280]);return p=nc.Effect.Filter.softLight(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect4=function(pixels){var p=nc.Effect.Filter.tint(pixels,[30,30,0],[300,300,450]);return p=nc.Effect.Filter.screen(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect5=function(pixels){var p=nc.Effect.Filter.tint(pixels,[0,0,-100],[220,220,210]);return p=nc.Effect.Filter.softLight(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect6=function(pixels){var p=nc.Effect.Filter.saturation(pixels,.8);return p=nc.Effect.Filter.tint(p,[-20,-40,-20],[280,220,240]),p=nc.Effect.Filter.softLight(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect7=function(pixels){var p=nc.Effect.Filter.contrast(pixels,1.15);return p=nc.Effect.Filter.tint(p,[-30,-30,-60],[260,270,160]),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect8=function(pixels){var p=nc.Effect.Filter.tint(pixels,[30,30,-130],[210,210,320]);return p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect9=function(pixels){var p=nc.Effect.Filter.tint(pixels,[0,0,-40],[250,400,250]);return p=nc.Effect.Filter.softLight(p),p=nc.Effect.Filter.screen(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect10=function(pixels){var p=nc.Effect.Filter.saturation(pixels,.5);return p=nc.Effect.Filter.contrast(p,1.15),p=nc.Effect.Filter.tint(pixels,[0,0,0],[350,350,350]),p=nc.Effect.Filter.screen(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect11=function(pixels){var p=nc.Effect.Filter.saturation(pixels,.2);return p=nc.Effect.Filter.contrast(p,1.15),p=nc.Effect.Filter.tint(p,[-50,-50,-20],[300,300,400]),p=nc.Effect.Filter.screen(p),p=nc.Effect.Filter.softLight(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.Effect.effect12=function(pixels){var p=nc.Effect.Filter.saturation(pixels,.2);return p=nc.Effect.Filter.tint(p,[10,30,10],[280,350,280]),p=nc.Effect.Filter.screen(p),p=nc.Effect.Filter.maskOverlay2(p)},nc.playinG.Guideline=function(){this._edgeSize=7,this._minRange=[100,100],this._maxRange=[],this._show=!1,this._append=!1,this.onApply=new nc.playinG.Observer,this.onChange=new nc.playinG.Observer,this.onCancel=new nc.playinG.Observer},nc.playinG.Guideline.prototype._edges=[],nc.playinG.Guideline.prototype.setSizeBox=function(){this.sizeBox=new nc.playinG.GuideSizeBox,this.panel.appendChild(this.sizeBox.getPanel())},nc.playinG.Guideline.prototype.show=function(){nc.setStyle(this.panel,"display","block"),this._show=!0},nc.playinG.Guideline.prototype.hide=function(){nc.setStyle(this.panel,"display","hide"),this._show=!1},nc.playinG.Guideline.prototype.appendTo=function(parent){parent.appendChild(this.panel),this._append=!0},nc.playinG.Guideline.prototype.removeTo=function(parent){parent.removeChild(this.panel),this._append=!1},nc.playinG.Guideline.prototype.isShow=function(){return this._show},nc.playinG.Guideline.prototype.isAppend=function(){return this._append},nc.playinG.Guideline.prototype.getSize=function(){},nc.playinG.Guideline.prototype.setSize=function(w,h){this.setWidth(w),this.setHeight(h)},nc.playinG.Guideline.prototype.setPosition=function(t,l){this.setTop(t),this.setLeft(l)},nc.playinG.Guideline.prototype.setSizeAndPosition=function(t,l,w,h){this.setSize(w,h),this.setPosition(t,l)},nc.playinG.Guideline.prototype.setSizeRatio=function(ratio){this._ratioSize=ratio},nc.playinG.Guideline.prototype.setFixSizeAndPosition=function(t,l,w,h){this._maxRange=[t,l,w,h]},nc.playinG.Guideline.prototype.setMaxSizeAndPosition=function(t,l,w,h){this.setSize(w,h),this.setPosition(t,l),this._w=w,this._h=h,this._t=t,this._l=l,this._initSize=this.getPanelSize(),this._sizeRatio=Math.round(Math.abs((this._initSize.w-this._initSize.l)/(this._initSize.h-this._initSize.t)),2),this.sizeBox&&this.sizeBox.setSize(this._w,this._h)},nc.playinG.Guideline.prototype.setEdges=function(){},nc.playinG.Guideline.prototype.setWidth=function(w){void 0===w||isNaN(w)||(nc.setStyle(this.panel,"width",nc.addPx(w)),this.image&&nc.setStyle(this.image,"width",nc.addPx(w)))},nc.playinG.Guideline.prototype.setHeight=function(h){void 0===h||isNaN(h)||(nc.setStyle(this.panel,"height",nc.addPx(h)),this.image&&nc.setStyle(this.image,"height",nc.addPx(h)))},nc.playinG.Guideline.prototype.setTop=function(t){void 0===t||isNaN(t)||(nc.setStyle(this.panel,"top",nc.addPx(t)),this.image&&nc.setStyle(this.image,"top",nc.addPx(t)))},nc.playinG.Guideline.prototype.setLeft=function(l){void 0===l||isNaN(l)||(nc.setStyle(this.panel,"left",nc.addPx(l)),this.image&&nc.setStyle(this.image,"left",nc.addPx(l)))},nc.playinG.Guideline.prototype.getPanelSize=function(){var t=nc.integer(nc.getStyle(this.panel,"top")),l=nc.integer(nc.getStyle(this.panel,"left")),w=nc.integer(nc.getStyle(this.panel,"width")),h=nc.integer(nc.getStyle(this.panel,"height"));return{t:t,l:l,w:w,h:h}},nc.playinG.Guideline.prototype.setEvent=function(){this._edges=[this.lt,this.rt,this.lb,this.rb];for(var i=0,len=4;len>i;i++){var edgePanel=new nc.playinG.Draggable(this._edges[i]);edgePanel.onDrag.add(function(i){return function(k){switch(i){case 0:this._t+=k.y,this._l+=k.x,this._w-=k.x,this._h-=k.y;break;case 1:this._t+=k.y,this._w+=k.x,this._h-=k.y;break;case 2:this._l+=k.x,this._w-=k.x,this._h+=k.y;break;case 3:this._w+=k.x,this._h+=k.y}this._w<=0&&(this._w=1),this._h<=0&&(this._h=1),this.display(this._t,this._l,this._w,this._h),this.sizeBox&&this.sizeBox.setSize(this._w,this._h)}}(i),this)}},nc.playinG.Guideline.prototype.display=function(t,l,w,h){this._ratio&&(h=w/this._ratioSize),this.setSize(w,h),this.setPosition(t,l),this.onChange.dispatch({t:this._t,l:this._l,w:this._w,h:this._h})},nc.playinG.Guideline.prototype.addMoveEvent=function(){var draggable=new nc.playinG.Draggable(this.panel);draggable.onDrag.add(function(pos){this._t+=pos.y,this._l+=pos.x,this.display(this._t,this._l,this._w,this._h)}.binder(this))},nc.playinG.Guideline.prototype.addApplyEvent=function(){this.__applyEvent=nc.playinG.Event.addListener(this.apply,"click",function(){this.onApplyHandler()}.binder(this))},nc.playinG.Guideline.prototype.addCancelEvent=function(){this.__cancelEvent=nc.playinG.Event.addListener(this.cancel,"click",function(){this.onCancelHandler()}.binder(this))},nc.playinG.Guideline.prototype.removeApplyEvent=function(){nc.playinG.Event.removeListener(this.apply,"click",this.__applyEvent.handler)},nc.playinG.Guideline.prototype.removeCancelEvent=function(){nc.playinG.Event.removeListener(this.cancel,"click",this.__cancelEvent.handler)},nc.playinG.Guideline.prototype.removeObserver=function(){this.onApply.removeAll(),this.onChange.removeAll(),this.onCancel.removeAll()},nc.playinG.Guideline.prototype._getPosition=function(node){for(var c={x:0,y:0,w:0,h:0},e=node,w=e.offsetWidth,h=e.offsetHeight;e&&(c.x+=e.offsetLeft||0,c.y+=e.offsetTop||0,e=e.offsetParent,this.panel.parentNode!=e););return c.w=c.x+w,c.h=c.y+h,c},nc.playinG.RotateGuideline=function(){this.setUI()},nc.playinG.RotateGuideline.prototype=new nc.playinG.Guideline,nc.playinG.RotateGuideline.prototype.setUI=function(){var _div=document.createElement("div"),_button=document.createelement("button");this.panel=_div.cloneNode(!1),nc.setStyle(this.panel,"zIndex",11),this.panel.className="rotateAreaG",this.canvasButton=_div.cloneNode(!1),this.canvasButton.className="wrapCanvasBtnG",this.cancel=_button.cloneNode(!1),this.cancel.className="btnActionG",this.cancel.innerHTML="취소",this.apply=_button.cloneNode(!1),this.apply.className="btnActionG  strong",this.apply.innerHTML="회전 적용",this.canvasButton.appendChild(this.cancel),this.canvasButton.appendChild(this.apply),this.panel.appendChild(this.canvasButton)},nc.playinG.SizeGuideline=function(){this._isCreate=!1;var _div=document.createElement("div");this.panel=_div.cloneNode(!1),nc.setStyle(this.panel,"zIndex",11),this.panel.className="resizeAreaG",this.setSizeBox()},nc.playinG.SizeGuideline.prototype=new nc.playinG.Guideline,nc.playinG.SizeGuideline.prototype.onApplyHandler=function(){this.onApply.dispatch()},nc.playinG.SizeGuideline.prototype.setRatio=function(bool){var pw=nc.integer(nc.getStyle(this.panel,"width")),ph=nc.integer(nc.getStyle(this.panel,"height"));this._ratio=bool,this._ratioSize=pw/ph},nc.playinG.SizeGuideline.prototype.onCancelHandler=function(){this.onCancel.dispatch()},nc.playinG.SizeGuideline.prototype.getImage=function(){return this.image},nc.playinG.SizeGuideline.prototype.setImage=function(url){this._bg=url,this.setUI()},nc.playinG.SizeGuideline.prototype.setUI=function(){var _div=document.createElement("div"),_button=document.createElement("button"),_px=nc.addPx(-7);this.image&&(this.panel.removeChild(this.image),this.image=null),this.image=new Image,nc.playinG.Event.addListener(this.image,"load",function(){this.setMaxSizeAndPosition(0,0,this.image.width,this.image.height),this.setSizeRatio(this.image.width/this.image.height),this._isCreate||(this.lt=_div.cloneNode(!1),this.lt.className="handleCircleG",nc.setStyle(this.lt,"left",_px),nc.setStyle(this.lt,"top",_px),this.lb=_div.cloneNode(!1),this.lb.className="handleCircleG",nc.setStyle(this.lb,"left",_px),nc.setStyle(this.lb,"bottom",_px),this.rt=_div.cloneNode(!1),this.rt.className="handleCircleG",nc.setStyle(this.rt,"right",_px),nc.setStyle(this.rt,"top",_px),this.rb=_div.cloneNode(!1),this.rb.className="handleCircleG",nc.setStyle(this.rb,"right",_px),nc.setStyle(this.rb,"bottom",_px),this.canvasButton=_div.cloneNode(!1),this.canvasButton.className="wrapCanvasBtnG",this.cancel=_button.cloneNode(!1),this.cancel.className="btnActionG",this.cancel.innerHTML="취소",this.apply=_button.cloneNode(!1),this.apply.className="btnActionG  strong",this.apply.innerHTML="크기조절 적용",this.canvasButton.appendChild(this.cancel),this.canvasButton.appendChild(this.apply),this.panel.appendChild(this.lt),this.panel.appendChild(this.lb),this.panel.appendChild(this.rt),this.panel.appendChild(this.rb),this.panel.appendChild(this.canvasButton),this.setEvent(),this.addApplyEvent(),this.addCancelEvent(),this._isCreate=!0),this.panel.appendChild(this.image)}.binder(this)),this.image.src=this._bg},nc.playinG.CropGuideline=function(t,l,w,h){this.setUI(),this.setEvent(),this.addApplyEvent(),this.addCancelEvent(),this.addMoveEvent(),t&&l&&w&&h&&this.setSizeAndPosition(t,l,w,h),this.setSizeBox()},nc.playinG.CropGuideline.prototype=new nc.playinG.Guideline,nc.playinG.CropGuideline.prototype.onApplyHandler=function(){this.onApply.dispatch()},nc.playinG.CropGuideline.prototype.onCancelHandler=function(){this.onCancel.dispatch()},nc.playinG.CropGuideline.prototype.setUI=function(){var _div=document.createElement("div"),_button=document.createElement("button"),_px=nc.addPx(-6);this.panel=_div.cloneNode(!1),nc.setStyle(this.panel,"zIndex",11),this.panel.className="cutAreaG",this.hg=_div.cloneNode(!1),this.hg.className="cutGridHG",this.vg=_div.cloneNode(!1),this.vg.className="cutGridVG",this.lt=_div.cloneNode(!1),this.lt.className="handleSquareG",nc.setStyle(this.lt,"left",_px),nc.setStyle(this.lt,"top",_px),this.lb=_div.cloneNode(!1),this.lb.className="handleSquareG",nc.setStyle(this.lb,"left",_px),nc.setStyle(this.lb,"bottom",_px),this.rt=_div.cloneNode(!1),this.rt.className="handleSquareG",nc.setStyle(this.rt,"right",_px),nc.setStyle(this.rt,"top",_px),this.rb=_div.cloneNode(!1),this.rb.className="handleSquareG",nc.setStyle(this.rb,"right",_px),nc.setStyle(this.rb,"bottom",_px),this.canvasButton=_div.cloneNode(!1),this.canvasButton.className="wrapCanvasBtnG",this.cancel=_button.cloneNode(!1),this.cancel.className="btnActionG",this.cancel.innerHTML="취소",this.apply=_button.cloneNode(!1),this.apply.className="btnActionG  strong",this.apply.innerHTML="자르기 적용",this.canvasButton.appendChild(this.cancel),this.canvasButton.appendChild(this.apply),this.panel.appendChild(this.hg),this.panel.appendChild(this.vg),this.panel.appendChild(this.lt),this.panel.appendChild(this.lb),this.panel.appendChild(this.rt),this.panel.appendChild(this.rb),this.panel.appendChild(this.canvasButton)},nc.playinG.MosaicGuideline=function(t,l,w,h){this.setUI(),this.setEvent(),this.addMoveEvent(),this.addApplyEvent(),this.addCancelEvent(),t&&l&&w&&h&&this.setSizeAndPosition(t,l,w,h),this.setSizeBox()},nc.playinG.MosaicGuideline.prototype=new nc.playinG.Guideline,nc.playinG.MosaicGuideline.prototype.onApplyHandler=function(){this.onApply.dispatch()},nc.playinG.MosaicGuideline.prototype.onCancelHandler=function(){this.onCancel.dispatch()},nc.playinG.MosaicGuideline.prototype.setUI=function(){var _div=document.createElement("div"),_button=document.createElement("button"),_px=nc.addPx(-6);this.panel=_div.cloneNode(!1),nc.setStyle(this.panel,"zIndex",11),this.panel.className="mosaicAreaG",this.lt=_div.cloneNode(!1),this.lt.className="handleSquareG",nc.setStyle(this.lt,"left",_px),nc.setStyle(this.lt,"top",_px),this.lb=_div.cloneNode(!1),this.lb.className="handleSquareG",nc.setStyle(this.lb,"left",_px),nc.setStyle(this.lb,"bottom",_px),this.rt=_div.cloneNode(!1),this.rt.className="handleSquareG",nc.setStyle(this.rt,"right",_px),nc.setStyle(this.rt,"top",_px),this.rb=_div.cloneNode(!1),this.rb.className="handleSquareG",nc.setStyle(this.rb,"right",_px),nc.setStyle(this.rb,"bottom",_px),this.canvasButton=_div.cloneNode(!1),this.canvasButton.className="wrapCanvasBtnG",this.cancel=_button.cloneNode(!1),this.cancel.className="btnActionG",this.cancel.innerHTML="취소",this.apply=_button.cloneNode(!1),this.apply.className="btnActionG  strong",this.apply.innerHTML="모자이크 적용",this.canvasButton.appendChild(this.cancel),this.canvasButton.appendChild(this.apply),this.panel.appendChild(this.lt),this.panel.appendChild(this.lb),this.panel.appendChild(this.rt),this.panel.appendChild(this.rb),this.panel.appendChild(this.canvasButton)},nc.playinG.SkewGuideline=function(t,l,w,h){this._edgeW=12,this._edgeH=12,this.setUI(),this.addApplyEvent(),this.addCancelEvent(),t&&l&&w&&h&&this.setSizeAndPosition(t,l,w,h)},nc.playinG.SkewGuideline.prototype=new nc.playinG.Guideline,nc.playinG.SkewGuideline.prototype.onApplyHandler=function(){this.onApply.dispatch()},nc.playinG.SkewGuideline.prototype.onCancelHandler=function(){this.onCancel.dispatch()},nc.playinG.SkewGuideline.prototype.setUI=function(){var _div=document.createElement("div"),_button=document.createElement("button");this.panel=_div.cloneNode(!1),nc.setStyle(this.panel,"zIndex",11),this.panel.className="rotateAreaG",this.canvasButton=_div.cloneNode(!1),this.canvasButton.className="wrapCanvasBtnG",this.cancel=_button.cloneNode(!1),this.cancel.className="btnActionG",this.cancel.innerHTML="취소",this.apply=_button.cloneNode(!1),this.apply.className="btnActionG  strong",this.apply.innerHTML="회전 적용",this.canvasButton.appendChild(this.cancel),this.canvasButton.appendChild(this.apply),this.panel.appendChild(this.canvasButton)},nc.playinG.SymbolGuideline=function(bg,canvasSize){this._bg=bg,this._ratio=!0,this._canvasSize=canvasSize,this.setUI()},nc.playinG.SymbolGuideline.prototype=new nc.playinG.Guideline,nc.playinG.SymbolGuideline.prototype.onApplyHandler=function(){this.onApply.dispatch()},nc.playinG.SymbolGuideline.prototype.onCancelHandler=function(){this.onCancel.dispatch()},nc.playinG.SymbolGuideline.prototype.getImage=function(){return this.image},nc.playinG.SymbolGuideline.prototype.setImage=function(url){this.image.src=url},nc.playinG.Guideline.prototype.setRatioSizeAndPosition=function(t,l,w,h){this.setSize(w,h),this.setPosition(t,l)},nc.playinG.Guideline.prototype.setImageSize=function(w,h){this._canvasSize&&(this._canvasSize.w<w&&(rate=w/this._canvasSize.w,w=this._canvasSize.w,h/=rate),this._canvasSize.h<h&&(rate=h/this._canvasSize.h,w/=rate,h=this._canvasSize.h)),t=(this._canvasSize.h-h)/2,l=(this._canvasSize.w-w)/2,this.setMaxSizeAndPosition(t,l,w,h)},nc.playinG.SymbolGuideline.prototype.setUI=function(){var _div=document.createElement("div"),_button=document.createElement("button"),_px=nc.addPx(-6);this.panel=_div.cloneNode(!1),nc.setStyle(this.panel,"zIndex",11),this.panel.className="resizeAreaG",this.image=new Image,nc.playinG.Event.addListener(this.image,"load",function(){this.setImageSize(this.image.width,this.image.height),this.setSizeRatio(this.image.width/this.image.height),this.lt=_div.cloneNode(!1),this.lt.className="handleSquareG",nc.setStyle(this.lt,"left",_px),nc.setStyle(this.lt,"top",_px),this.lb=_div.cloneNode(!1),this.lb.className="handleSquareG",nc.setStyle(this.lb,"left",_px),nc.setStyle(this.lb,"bottom",_px),this.rt=_div.cloneNode(!1),this.rt.className="handleSquareG",nc.setStyle(this.rt,"right",_px),nc.setStyle(this.rt,"top",_px),this.rb=_div.cloneNode(!1),this.rb.className="handleSquareG",nc.setStyle(this.rb,"right",_px),nc.setStyle(this.rb,"bottom",_px),this.canvasButton=_div.cloneNode(!1),this.canvasButton.className="wrapCanvasBtnG",this.cancel=_button.cloneNode(!1),this.cancel.className="btnActionG",this.cancel.innerHTML="취소",this.apply=_button.cloneNode(!1),this.apply.className="btnActionG  strong",this.apply.innerHTML="문양 적용",this.canvasButton.appendChild(this.cancel),this.canvasButton.appendChild(this.apply),this.panel.appendChild(this.image),this.panel.appendChild(this.lt),this.panel.appendChild(this.lb),this.panel.appendChild(this.rt),this.panel.appendChild(this.rb),this.panel.appendChild(this.canvasButton),this.setEvent(),this.addMoveEvent(),this.addApplyEvent(),this.addCancelEvent()
}.binder(this)),this.image.src=this._bg},nc.playinG.command={},nc.playinG.command.ICommand=function(){},nc.playinG.command.ICommand.prototype.execute=function(){},nc.playinG.command.ICommand.prototype.undo=function(){},nc.playinG.command.CommandManager={commands:[],redos:[],MAXCOMMAND:30,lastCommand:null,executeCommand:function(command){return command instanceof nc.playinG.command.Undo?void this.undo():command instanceof nc.playinG.command.Redo?void this.redo():void(command.execute()&&this.addToHistory(command))},addToHistory:function(command){this.MAXCOMMAND<=this.commands.length&&this.commands.shift(),this.commands.push(command),this.lastCommand=command},undo:function(){if(this.commands.length>0){var undo=this.commands.pop();undo.undo(),this.redos.push(undo)}},redo:function(){if(this.redos.length>0){var redo=this.redos.pop();redo.execute(),this.commands.push(redo)}}},nc.playinG.command.AbstractCommand=function(){},nc.playinG.command.AbstractCommand.prototype=new nc.playinG.command.ICommand,nc.playinG.command.AbstractCommand.prototype.getMode=function(){return this._mode},nc.playinG.command.Redo=function(){nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.Redo.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.Redo.prototype.execute=function(){return!0},nc.playinG.command.Undo=function(){nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.Undo.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.Undo.prototype.execute=function(){return!0},nc.playinG.command.SizeCommand=function(editor,w,h,oldPixels){this._mode="SizeCommand",this._editor=editor,this._w=w,this._h=h,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.SizeCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.SizeCommand.prototype.execute=function(){return this._editor._setSize(this._oldPixels,this._w,this._h),!0},nc.playinG.command.SizeCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.command.RotateCommand=function(editor,d,oldPixels){this._mode="RotateCommand",this._editor=editor,this._deg=d,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.RotateCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.RotateCommand.prototype.execute=function(){return this._editor._setRotate(this._deg),!0},nc.playinG.command.RotateCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.command.EffectCommand=function(editor,pixels,oldPixels){this._mode="EffectCommand",this._editor=editor,this._pixels=pixels,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.EffectCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.EffectCommand.prototype.execute=function(){return this._editor._setEffect(this._pixels),!0},nc.playinG.command.EffectCommand.prototype.undo=function(){this._editor._setEffect(this._oldPixels)},nc.playinG.command.CropCommand=function(editor,x,y,w,h,oldPixels){this._mode="CropCommand",this._editor=editor,this._w=w,this._h=h,this._x=x,this._y=y,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.CropCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.CropCommand.prototype.execute=function(){return this._editor._setCrop(this._x,this._y,this._w,this._h),!0},nc.playinG.command.CropCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.command.MosaicCommand=function(editor,size,oldPixels){this._mode="MosaicCommand",this._editor=editor,this._size=size,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.MosaicCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.MosaicCommand.prototype.execute=function(){return this._editor._setMosaic(this._size),!0},nc.playinG.command.MosaicCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.command.FlipCommand=function(editor,canvas,oldPixels){this._editor=editor,this._canvas=canvas,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.FlipCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.FlipCommand.prototype.execute=function(){return this._editor._setFlip(this._canvas),!0},nc.playinG.command.FlipCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.command.ResetCommand=function(editor,oldPixels){this._mode="ResetCommand",this._editor=editor,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.ResetCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.ResetCommand.prototype.execute=function(){return this._editor._onReset(),!0},nc.playinG.command.ResetCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.command.PenCommand=function(editor,pixels,oldPixels){this._mode="MosaicCommand",this._editor=editor,this._pixels=pixels,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.PenCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.PenCommand.prototype.execute=function(){return this._editor.putImageData(this._pixels),!0},nc.playinG.command.PenCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.command.SkewCommand=function(editor,pixels,oldPixels){this._mode="SkewCommand",this._editor=editor,this._pixels=pixels,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.SkewCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.SkewCommand.prototype.execute=function(){return this._editor.putImageData(this._pixels),!0},nc.playinG.command.SkewCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.command.SymbolCommand=function(editor,pixels,oldPixels){this._mode="SymbolCommand",this._editor=editor,this._pixels=pixels,this._oldPixels=oldPixels,nc.playinG.command.CommandManager.executeCommand(this)},nc.playinG.command.SymbolCommand.prototype=new nc.playinG.command.AbstractCommand,nc.playinG.command.SymbolCommand.prototype.execute=function(){return this._editor.putImageData(this._pixels),!0},nc.playinG.command.SymbolCommand.prototype.undo=function(){this._editor.putImageData(this._oldPixels)},nc.playinG.PenController=function(){this.mode="Line",this.sPoint={x:0,y:0},this.ePoint={x:0,y:0},this.currPoint={x:0,y:0},this._enable=!1,this.style={fillStyle:"#000000",lineWidth:6,strokeStyle:"#000000",globalAlpha:.2}},nc.playinG.PenController.prototype.isEnable=function(){return this._enable},nc.playinG.PenController.prototype.setEnable=function(bool){this._enable=bool},nc.playinG.PenController.prototype.setOpaticy=function(o){this.style.globalAlpha=o/100},nc.playinG.PenController.prototype.setWidth=function(w){this.style.lineWidth=w},nc.playinG.PenController.prototype.setColor=function(c){this.style.strokeStyle=c},nc.playinG.PenController.prototype.begin=function(sPoint,ctx){ctx.fillStyle=this.style.fillStyle,ctx.lineWidth=this.style.lineWidth,ctx.lineStyle=this.style.strokeStyle,ctx.strokeStyle=this.style.strokeStyle,ctx.globalAlpha=this.style.globalAlpha,ctx.lineCap="round",ctx.beginPath(),ctx.moveTo(sPoint.x,sPoint.y)},nc.playinG.PenController.prototype.draw=function(sPoint,cPoint,ctx){sPoint||(sPoint=this.sPoint),cPoint||(cPoint=this.ePoint),this._draw(sPoint,cPoint,ctx)},nc.playinG.PenController.prototype.drawEnd=function(sPoint,cPoint,ctx){ctx.lineCap="round",ctx.globalAlpha=this.style.globalAlpha,ctx.lineTo(cPoint.x,cPoint.y),ctx.stroke(),ctx.closePath()},nc.playinG.PenController.prototype.clear=function(w,h,ctx){ctx.beginPath(),ctx.clearRect(0,0,w,h),ctx.closePath()},nc.playinG.PenController.prototype._draw=function(sPoint,cPoint,ctx){ctx.lineCap="round",ctx.globalAlpha=this.style.globalAlpha,ctx.lineTo(cPoint.x,cPoint.y),ctx.stroke()},nc.playinG.SelectBox=function(){},nc.playinG.SelectBox.prototype.getPanel=function(){return this.panel},nc.playinG.CropSelector=function(){this.panel=document.createElement("ul"),this.tmpList=document.createElement("li"),this.panel.className="selectUIListG",this.onClick=new nc.playinG.Observer,this._setUI()},nc.playinG.CropSelector.prototype=new nc.playinG.SelectBox,nc.playinG.CropSelector.prototype={px:[{name:"샌드박스 프로필",code:"SBProfile",size:{w:210,h:210}},{name:"아이온 프로필",code:"aionBoard",size:{w:73,h:69}},{name:"페이스북 프로필",code:"FBProfile",size:{w:200,h:200}},{name:"트위터 프로필",code:"TWProfile",size:{w:128,h:128}},{name:"유튜브 프로필",code:"youtubeProfile",size:{w:125,h:125}}],_setUI:function(){for(var i=0;this.px[i];i++){var c=this.px[i],li=this.tmpList.cloneNode(!1);li.innerHTML='<input type="radio" name="resizeSelect" id="'+c.code+'" value="'+c.name+'"><label for="'+c.code+'">'+c.name+"</label>",function(li,i,obj){nc.playinG.Event.addListener(li,"click",function(){obj.onClick.dispatch(obj.px[i])})}(li,i,this),this.panel.appendChild(li)}},getPanel:function(){return this.panel}},nc.playinG.ColorPicker=function(){this.panel=document.createElement("ul"),this.tmpList=document.createElement("li"),this.panel.className="colorSetG cf",this.onClick=new nc.playinG.Observer,this._setUI()},nc.playinG.ColorPicker.prototype=new nc.playinG.SelectBox,nc.playinG.ColorPicker.prototype={colors:["#ffffff","#ed1818","#de7a18","#debb18","#b7de18","#009d24","#c0c0c0","#e97c80","#d1b173","#cfcca1","#bbd498","#60b876","#7c7c7c","#650000","#652a00","#654300","#415200","#003e0f","#454545","#00afa1","#0074c8","#3931c2","#771fb8","#ef007b","#282828","#7ec9c4","#508eba","#6964ba","#9953ce","#e572ad","#000000","#004540","#002e4f","#16134d","#2f0d49","#5f0031"],_setUI:function(){for(var i=0;this.colors[i];i++){var c=this.colors[i],li=this.tmpList.cloneNode(!1);li.innerHTML='<a href="javascript:;" style="background-color:'+c+'">'+c+"</a>",function(li,i,obj){nc.playinG.Event.addListener(li,"click",function(){obj.onClick.dispatch(obj.colors[i])})}(li,i,this),this.panel.appendChild(li)}},getPanel:function(){return this.panel}},nc.playinG.DrawSizeSelector=function(){this.panel=document.createElement("ul"),this.tmpList=document.createElement("li"),this.panel.className="selectUIListG",this.onClick=new nc.playinG.Observer,this._setUI()},nc.playinG.DrawSizeSelector.prototype=new nc.playinG.SelectBox,nc.playinG.DrawSizeSelector.prototype={px:["3","5","10","20","40","60"],_setUI:function(){for(var i=0;this.px[i];i++){var c=this.px[i],li=this.tmpList.cloneNode(!1);li.innerHTML='<input type="radio" name="drawSize" id="drawSizeVal'+c+'" value="'+c+'px"><label for="drawSizeVal'+c+'">'+c+"px</label>",function(li,i,obj){nc.playinG.Event.addListener(li,"click",function(){obj.onClick.dispatch(obj.px[i])})}(li,i,this),this.panel.appendChild(li)}},getPanel:function(){return this.panel}},nc.playinG.SymbolSelector=function(symbols){this.panel=document.createElement("ul"),this.tmpList=document.createElement("li"),this.tmpBtn=document.createElement("button"),this.tmpDiv=document.createElement("div"),this.tmpA=document.createElement("a"),this.panel.className="symbolListG cf",this.symbols=symbols,this.onClick=new nc.playinG.Observer,this._setUI()},nc.playinG.SymbolSelector.prototype=new nc.playinG.SelectBox,nc.playinG.SymbolSelector.prototype={_setUI:function(){for(var i=0;this.symbols[i];i++){var c=this.symbols[i],li=this.tmpList.cloneNode(!1),a=this.tmpA.cloneNode(!1),div=this.tmpDiv.cloneNode(!1);nc.addClassName(a,c.name);var symbolB,symbolW,symbolR,symbolY;div.className="wrapSymbolType",c.symbolB&&(symbolB=this.tmpBtn.cloneNode(!1),symbolB.className="symbolB",div.appendChild(symbolB)),c.symbolW&&(symbolW=this.tmpBtn.cloneNode(!1),symbolW.className="symbolW",div.appendChild(symbolW)),c.symbolR&&(symbolR=this.tmpBtn.cloneNode(!1),symbolR.className="symbolR",div.appendChild(symbolR)),c.symbolY&&(symbolY=this.tmpBtn.cloneNode(!1),symbolY.className="symbolY",div.appendChild(symbolY)),li.appendChild(a),li.appendChild(div),function(symbolB,symbolW,symbolR,symbolY,i,obj,a){symbolB&&(nc.playinG.Event.addListener(symbolB,"click",function(){obj.onClick.dispatch({idx:i,symbol:"symbolB"})}),nc.playinG.Event.addListener(a,"click",function(){obj.onClick.dispatch({idx:i,symbol:"symbolB"})})),symbolW&&nc.playinG.Event.addListener(symbolW,"click",function(){obj.onClick.dispatch({idx:i,symbol:"symbolW"})}),symbolR&&nc.playinG.Event.addListener(symbolR,"click",function(){obj.onClick.dispatch({idx:i,symbol:"symbolR"})}),symbolY&&nc.playinG.Event.addListener(symbolY,"click",function(){obj.onClick.dispatch({idx:i,symbol:"symbolY"})})}(symbolB,symbolW,symbolR,symbolY,i,this,a),this.panel.appendChild(li)}},getPanel:function(){return this.panel}},nc.playinG.SkewController=function(canvas){this._canvas=canvas,this._ctx=this._canvas.getContext("2d"),this.onChange=new nc.playinG.Observer,this.onChange.add(this.changeSkew,this),this._deg=0},nc.playinG.SkewController.prototype.setDeg=function(canvas,deg){this._deg=deg,this.onChange.dispatch({canvas:canvas,deg:deg})},nc.playinG.SkewController.prototype.changeSkew=function(info){var c=info.canvas,canvas=document.createElement("canvas"),ctxTmp=canvas.getContext("2d"),halfW=c.width/2,halfH=c.height/2;canvas.width=c.width,canvas.height=c.height,ctxTmp.putImageData(c,0,0),this._ctx.clearRect(0,0,c.width,c.height),this._ctx.save(),this._ctx.translate(halfW,halfH),this._ctx.rotate(info.deg*Math.PI/180),this._ctx.translate(-1*halfW,-1*halfH),this._ctx.drawImage(canvas,0,0),this._ctx.restore()},nc.playinG.ImageEditDom=ImageEditDom=function(){this._div=document.createElement("div"),this._span=document.createElement("span"),this._button=document.createElement("button"),this._a=document.createElement("a"),nc.playinG.Event.addListener(this._a,"click",function(evt){nc.playinG.Event.preventDefault(evt)}),this._ul=document.createElement("ul"),this._li=document.createElement("li"),this._h3=document.createElement("h3"),this._form=document.createElement("form"),this._textArea=document.createElement("textarea"),this._input=document.createElement("input"),this._header=document.createElement("header"),this._nav=document.createElement("nav"),this._containerG=this._div.cloneNode(!1),this._containerG.className="containerG cf",this._headerG=this._header.cloneNode(!1),this._headerG.className="headerG",this.setHeader(),this._contentG=this._div.cloneNode(!1),this._contentG.className="contentG",this.setContent(),this.setTree(),this.preLoad()},nc.playinG.ImageEditDom.prototype.preLoad=function(){this.mosaicPattern=new Image,this.mosaicPattern.src=nc.imgUrl+"static/pattern_mosaic_area.png"},nc.playinG.ImageEditDom.prototype.setTree=function(){this.addChild(this._containerG,[this._headerG,this._contentG])},nc.playinG.ImageEditDom.prototype.get=function(dom){return this["_"+dom]},nc.playinG.ImageEditDom.prototype.getContainer=function(){return this._containerG},nc.playinG.ImageEditDom.prototype.getUpdateList=function(){return this._updateList},nc.playinG.ImageEditDom.prototype.addText=function(parent,text){var txt=document.createTextNode(text);return parent.appendChild(txt),parent},nc.playinG.ImageEditDom.prototype.addChild=function(parent,childs){if(!(childs instanceof Array))return void parent.appendChild(childs);for(var i=0;childs[i];i++)parent.appendChild(childs[i])},nc.playinG.ImageEditDom.prototype.setHeader=function(){this._MainMenu=this._nav.cloneNode(!1),this._MainMenu.className="mainMenuG",this._SubMenu=this._nav.cloneNode(!1),this._SubMenu.className="subMenuG moveG",this.imgUploadMenuG=this._ul.cloneNode(!1),this.imgUploadMenuG.className="imgUploadMenuG";var baseEditorG=this._li.cloneNode(!1),filterG=this._li.cloneNode(!1),drawG=this._li.cloneNode(!1);this._baseEditorG=this._a.cloneNode(!1),this._baseEditorG.className="baseEditorG",baseEditorG.appendChild(this._baseEditorG),this._filterG=this._a.cloneNode(!1),this._filterG.className="filterG",filterG.appendChild(this._filterG),this._drawG=this._a.cloneNode(!1),this._drawG.className="drawG",drawG.appendChild(this._drawG),this.addChild(this.imgUploadMenuG,[baseEditorG,filterG,drawG]),this._MainMenu.appendChild(this.imgUploadMenuG),this._smenuBaseEditor=this._div.cloneNode(!1),this._smenuBaseEditor.className="smenuBaseEditor";var titBaseEditorG=this._h3.cloneNode(!1);titBaseEditorG.className="titBaseEditorG",this._BaseEditorSubMenuListG=this._div.cloneNode(!1),this._BaseEditorSubMenuListG.className="subMenuListG",this.addChild(this._smenuBaseEditor,[titBaseEditorG,this._BaseEditorSubMenuListG]),this._smenuFilter=this._div.cloneNode(!1),this._smenuFilter.className="smenuFilter";var titFilterG=this._h3.cloneNode(!1);titFilterG.className="titFilterG";var subMenuListG=this._div.cloneNode(!1);subMenuListG.className="subMenuListG",this._filterParent=this._div.cloneNode(!1),nc.setStyle(this._filterParent,"overflow","hidden"),this._filterListG=this._ul.cloneNode(!1),this._filterListG.className="filterListG",this.addChild(this._filterParent,this._filterListG),this.addChild(subMenuListG,this._filterParent),this.addChild(this._smenuFilter,[titFilterG,subMenuListG]),this._smenuDraw=this._div.cloneNode(!1),this._smenuDraw.className="smenuDraw";var titDrawG=this._h3.cloneNode(!1);titDrawG.className="titDrawG",this._DrawSubMenuListG=this._div.cloneNode(!1),this._DrawSubMenuListG.className="subMenuListG",this.addChild(this._smenuDraw,[titDrawG,this._DrawSubMenuListG]),this._btnHistory=this._div.cloneNode(!1),this._btnHistory.className="btnHistory",this._btnPrev=this._button.cloneNode(!1),this._btnPrev.className="btnPrevStepG",this._btnNext=this._button.cloneNode(!1),this._btnNext.className="btnNextStepG",this._btnReset=this._button.cloneNode(!1),this._btnReset.className="btnResetEditorG",this.addChild(this._btnHistory,[this._btnPrev,this._btnNext,this._btnReset]),this._returnMenu=this._button.cloneNode(!1),this._returnMenu.className="returnMenuG",this.addChild(this._SubMenu,[this._smenuBaseEditor,this._smenuFilter,this._smenuDraw,this._btnHistory,this._returnMenu]),this.addChild(this._headerG,[this._MainMenu,this._SubMenu])},nc.playinG.ImageEditDom.prototype.insertCanvas=function(){},nc.playinG.ImageEditDom.prototype.setContent=function(){this.wrapUploadG=this._div.cloneNode(!1),this.wrapUploadG.className="wrapUploadG",this.wrapUploadG.setAttribute("unselectable","on");var s=this.wrapUploadG.style;s.webkitUserSelect="none",s.webkitUserDrag="none",s.MozUserSelect="none",this.canvasWrap=this._div.cloneNode(!1),this.canvasWrap.className="canvasWrap";var cs=this.canvasWrap.style;cs.webkitUserSelect="none",cs.webkitUserDrag="none",cs.MozUserSelect="none",nc.setStyle(this.canvasWrap,"position","relative"),nc.setStyle(this.canvasWrap,"top",0),nc.setStyle(this.canvasWrap,"left",0),this.addChild(this.wrapUploadG,this.canvasWrap),this._imgCurrSize=this._div.cloneNode(!1),this._imgCurrSize.className="fileSizeG",this.currWidth=this._span.cloneNode(!1),this.currWidth.innerHTML="0",this.currSizeInfo=this._span.cloneNode(!1),this.currSizeInfo.innerHTML=" x ",this.currHeight=this._span.cloneNode(!1),this.currHeight.innerHTML="0",this.addChild(this._imgCurrSize,this.currWidth),this.addChild(this._imgCurrSize,this.currSizeInfo),this.addChild(this._imgCurrSize,this.currHeight),this.addChild(this.canvasWrap,this._imgCurrSize),this._notifyGuideG=this._div.cloneNode(!1),this._notifyGuideG.className="notifyGuideG",this._notifyGuideG.innerHTML="사진 편집은 <strong>전체화면</strong>모드에서 이용해 주세요",nc.setOpacity(this._notifyGuideG,0),nc.setStyle(this._notifyGuideG,"display","none"),this._closeG=this._button.cloneNode(!1),this._closeG.className="closeG",this.btnEditComplete=this._button.cloneNode(!1),this.btnEditComplete.className="btnEditComplete",this._editInfo=this._div.cloneNode(!1),this._editInfo.className="moveEditG",this._editInfo.innerHTML="편집 환경에서는 사진이 화면에 최적화된 사이즈로 조절됩니다.",this.addChild(this.wrapUploadG,[this.btnEditComplete,this._editInfo]),this.addChild(this._contentG,[this.wrapUploadG,this._notifyGuideG,this._closeG])},nc.playinG.Filters=function(){this._filter=[{name:"새벽안개"},{name:"갈대바람"},{name:"나무의기억"},{name:"노스텔지어"},{name:"환상여행"},{name:"녹차빛"},{name:"바다유리"},{name:"캐러멜"},{name:"퍼플레인"},{name:"하현달"},{name:"풀피리"},{name:"제비꽃"}],this.list=["effect1","effect2","effect3","effect4","effect5","effect6","effect7","effect8","effect9","effect10","effect11","effect12"]},nc.playinG.Filters.prototype={get:function(){return this._filter},setFilter:function(){}},nc.playinG.GuideSizeBox=function(){this.panel=null,this.setUI()},nc.playinG.GuideSizeBox.prototype={setUI:function(){if(!this.panel){var tmp=document.createElement("span");this.panel=document.createElement("div"),this.panel.className="notifySizeG",nc.setCssText(this.panel,"position:absolute;top:10px;left:10px;"),this.wPanel=tmp.cloneNode(!1),this.hPanel=tmp.cloneNode(!1),this.xnode=document.createTextNode("X"),this.panel.appendChild(this.wPanel),this.panel.appendChild(this.xnode),this.panel.appendChild(this.hPanel)}},getPanel:function(){return this.panel},show:function(){nc.setstyle(this.panel,"display","block")},hide:function(){nc.setstyle(this.panel,"display","none")},setSize:function(w,h){this._w=w,this._h=h,this.wPanel.innerHTML=this._w,this.hPanel.innerHTML=this._h}},nc.playinG.ImageEditor=function(parent,options){var canvas=document.createElement("canvas");if(!canvas.getContext)return canvas=null,nc.playinG.AlertController.getInstance().setMsg("이미지편집에디터를 지원하지 않는 브라우저 입니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>이미지편집에디터를 지원하지 않는 브라우저 입니다.</p>"),void nc.playinG.AlertController.getInstance().show(this.onFileUploadContinue.binder(this));canvas=null,this.parent=parent||document.body,this.modal=new nc.playinG.ModalLayer,this.parent.appendChild(this.modal.get()),this.onComplete=new nc.playinG.Observer,this.onHide=new nc.playinG.Observer,this.setOptionsConfig(options),this.menuSize={w:300},this._w=0,this._h=0,this._t=0,this._l=0,this._deg=0,this._edited=!1,this._editCancel=null,this.filters=new nc.playinG.Filters,this.pen=new nc.playinG.PenController,this.html=new ImageEditDom,this.parent.appendChild(this.html.getContainer()),nc.setStyle(this.modal.get(),"zIndex",this.options.modalZindex+1),nc.setStyle(this.html.getContainer(),"zIndex",this.options.zIndex+2),this._frame=document.createElement("iframe"),this._frame.width=0,this._frame.height=0,this._frame.frameBorder=0,this._frame.scrolling="no",this._frame.allowTransparency="true",nc.setStyle(this._frame,"border","0"),nc.setStyle(this._frame,"borderStyle","none"),this.addChild(this.html.getContainer(),this._frame),this.setFrame(),this.mainMenuPanel=this.html._MainMenu,this.subMenuPanel=this.html._SubMenu,this.submenu=[this.html._smenuBaseEditor,this.html._smenuFilter,this.html._smenuDraw],this.menuButton=[this.html._baseEditorG,this.html._filterG,this.html._drawG],this.wrap=this.html.wrapUploadG,this.btnComplete=this.html.btnEditComplete,this.canvasWrap=this.html.canvasWrap,this._orign={bitmap:null,w:0,h:0},this._setGridSize(),this._setUI(),this._addEvent(),this._init();this.createImageCanvas();this.hide(),this._isShowSubMenu=!1,nc.Effect.zIndex=this.options.zIndex+3,this.options.isFilter||nc.setStyle(this.html._filterG,"display","none"),this.options.isDraw||nc.setStyle(this.html._drawG,"display","none")},nc.playinG.ImageEditor.prototype={setOptionsConfig:function(options){this.options={token:null,channel:null,margin:20,minWidth:500,slideW:100,zIndex:9999999,modalZindex:9999998,filterImageUrl:null,editFrame:null,isDraw:!0,isFilter:!0,isProfileUpload:!1,isCharacterProfile:!1},nc.extend(this.options,options),nc.Effect&&this.options.filterImageUrl&&nc.Effect.setImage(this.options.filterImageUrl),this.options.imgStringDownload="http://"+nc.staticUrl+"upload.plaync.co.kr/file/"+this.options.channel+"/download/",this.options.imgStringModify="http://"+nc.staticUrl+"upload.plaync.co.kr/file/"+this.options.channel+"/base64modify/"+this.options.token+"/"},setFrame:function(){this._frame&&(this._frame.src=this.options.editFrame),this.options.objectName&&(this._frame.src+="?parentName="+this.options.objectName+"&")},getFrameDocument:function(){var frmDoc,frm=this._frame;if(frm)return frmDoc=frm.contentWindow||frm.contentDocument,frmDoc.document&&(frmDoc=frmDoc.document),frmDoc},getImageStringProfile:function(fileId){this.fileId=fileId;var cid=this.options.characterCategoryId,sid=this.options.characterServerId,enCid=this.options.characterId,channelParam="",param="?categoryId="+cid+"&serverId="+sid+"&encodedCharacterId="+enCid,imgStringDownload=this.options.characterImgStringDownload+param,dummy=/\?/.test(imgStringDownload)?"&dummy="+ +new Date:"?dummy="+ +new Date;this.options.isProfileUpload&&(channelParam="&channel="+this.options.channel),nc.playinG.LoadingController.getInstance().setZIndex(this.options.zIndex+2),nc.playinG.LoadingController.getInstance().show();var imgInfo=new nc.Jsonp(imgStringDownload+dummy+channelParam,this.getData.binder(this));imgInfo.load()},getImageString:function(fileId){this.fileId=fileId;var channelParam="",imgStringDownload=this.options.imgStringDownload+fileId,dummy=/\?/.test(imgStringDownload)?"&dummy="+ +new Date:"?dummy="+ +new Date;this.options.isProfileUpload&&(channelParam="&channel="+this.options.channel),nc.playinG.LoadingController.getInstance().setZIndex(this.options.zIndex+2),nc.playinG.LoadingController.getInstance().show();var imgInfo=new nc.Jsonp(imgStringDownload+dummy+channelParam,this.getData.binder(this));imgInfo.load()},getData:function(data){var d="data:image/png;base64,"+data;this.loadImage(d)},modifyImg:function(){var data=this.getCurrImageString();if(data){var fDoc=this.getFrameDocument();fDoc&&(fDoc.getElementById("uploadModifyStringForm")&&(fDoc.getElementById("uploadModifyStringForm").action=this.options.imgStringModify+this.fileId),fDoc.getElementById("imgStr")&&(fDoc.getElementById("imgStr").value=data.split(",")[1],fDoc.getElementById("uploadModifyStringForm").submit()))}},getModifyResult:function(data){},_setGridSize:function(){this._gridSize={};var avail=nc.getAvailSize(),ratio=avail.w/avail.h;this._gridSize.w=avail.w-(2*this.options.margin+this.menuSize.w+this.options.slideW),this._gridSize.h=this._gridSize.h=ratio>1?this._gridSize.w/ratio:this._gridSize.w},getImageSize:function(w,h){this._setGridSize();var size={w:w,h:h},rate=0,buttonHeight=128,sizeW=nc.integer(size.w),sizeH=nc.integer(size.h),gSizeW=nc.integer(this._gridSize.w),gSizeH=nc.integer(this._gridSize.h-buttonHeight);return sizeW>gSizeW&&(rate=sizeW/gSizeW,sizeW=gSizeW,sizeH/=rate),sizeH>gSizeH&&(rate=sizeH/gSizeH,sizeW/=rate,sizeH=gSizeH),size.w=sizeW,size.h=sizeH,size},_setImageSize:function(w,h){var size=this.getImageSize(w,h);return this._w=nc.integer(size.w),this._h=nc.integer(size.h),size},_setCanvasWrapSize:function(w,h){nc.setStyle(this.canvasWrap,"width",nc.addPx(w)),nc.setStyle(this.canvasWrap,"height",nc.addPx(h));{var wrapW=nc.getStyle(this.wrap,"width");nc.getStyle(this.wrap,"height")}nc.setStyle(this.canvasWrap,"left",nc.addPx((nc.integer(wrapW)-w)/2))},_setCanvasWrapPos:function(){var wrapH=nc.getStyle(this.wrap,"height"),t=(nc.getBrowserSize().h,wrapH>this._h+30?(wrapH-this._h+30)/2:0);nc.setStyle(this.canvasWrap,"top",nc.addPx(t)),this._setBtnCompletePos(t+30)},_setBtnCompletePos:function(top){nc.setStyle(this.btnComplete,"marginTop",nc.addPx(top))},getCanvasWrapSizeAndPos:function(){var w=nc.getStyle(this.canvasWrap,"width"),h=nc.getStyle(this.canvasWrap,"height"),t=nc.getStyle(this.canvasWrap,"top"),l=nc.getStyle(this.canvasWrap,"left");return{w:nc.integer(w),h:nc.integer(h),t:nc.integer(t),l:nc.integer(l)}},loadImage:function(imgUrl){var img,ctx,imgCanvas,self=this;if(imgUrl){imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d"),img=new Image,img.onload=function(){self._setImageSize(img.width,img.height),self._setCanvasWrapSize(self._w,self._h),self._setCanvasSize(self._w,self._h),self._setCanvasWrapPos(),ctx.clearRect(0,0,self._w,self._h),ctx.drawImage(img,0,0,self._w,self._h),self.setSizeInfo(),self._orign.bitmap=ctx.getImageData(0,0,self._w,self._h),self._orign.w=self._w,self._orign.h=self._h},img.src=imgUrl,nc.playinG.LoadingController.getInstance().hide(),nc.setStyle(this.html._notifyGuideG,"display","block"),nc.setOpacity(this.html._notifyGuideG,1);{new nc.playinG.Animate(this.html._notifyGuideG,{opacity:0},{duration:2300,callback:function(){nc.setStyle(this.html._notifyGuideG,"display","none")}.binder(this)})}}},setOrign:function(){this._orign&&this.putImageData(this._orign,0,0)},cloneCurrImage:function(){return this.imageCanvas?(this._cloneCurrImage=this.imageCanvas.getContext().getImageData(0,0,this._w,this._h),this._cloneCurrImage):null},removeCloneImageCanvas:function(){this._cloneCurrImage&&(this._cloneCurrImage=null)},createImageCanvas:function(){if(this.imageCanvas)return this.imageCanvas;var c=this.imageCanvas=new nc.playinG.Canvas(this.canvasWrap,this._w,this._h,!1,!0);return this.canvasManager.pushFirst(c)},setSizeInfo:function(){this.html.currWidth.innerHTML=nc.integer(this._w),this.html.currHeight.innerHTML=nc.integer(this._h)},_setCanvasSize:function(w,h){var c=this.canvasManager.getCanvas(),len=c.length;this._w=w,this._h=h;var p=this._canvas.getContext().getImageData(0,0,this._w,this._h);this._canvas.setSize(this._w,this._h),this._canvas.getContext().putImageData(p,0,0);for(var i=0;len>i;i++){var ctx=c[i].getContext(),pixels=ctx.getImageData(0,0,this._w,this._h);c[i].setSize(this._w,this._h),ctx.putImageData(pixels,0,0)}},_init:function(){this.canvasManager=new nc.playinG.CanvasManager,this._createMainCanvas()},_removePenCanvas:function(){this._penCanvas&&(this._penCanvas._remove(),this._penCanvas=null)},_createPenCanvas:function(){return this._penCanvas||(this._penCanvas=new nc.playinG.Canvas(this.canvasWrap,this._w,this._h)),this._penCanvas},_createMainCanvas:function(){var c=this._canvas=new nc.playinG.Canvas(this.canvasWrap,this._gridSize.w,this._gridSize.h,!0);this._ctx=this._canvas.getContext("2d");var sPoint;c.onDown.add(function(m){if(this.pen&&this.pen.isEnable()){this._createPenCanvas();var ctx=this._createPenCanvas().getContext();sPoint=m,sPoint.y-=nc.getScrollHeight(),this.pen.begin(sPoint,ctx)}},this),c.onMove.add(function(m){if(this.pen&&this.pen.isEnable()){var ctx=this._createPenCanvas().getContext();m.y-=nc.getScrollHeight(),this.pen.draw(sPoint,m,ctx)}},this),c.onUp.add(function(m){if(this.pen&&this.pen.isEnable()){var ctx=this._createPenCanvas().getContext(),imageCanvas=this.createImageCanvas(),old=this.createImageData();sPoint.y-=nc.getScrollHeight(),m.y-=nc.getScrollHeight(),this.pen.drawEnd(sPoint,m,ctx),imageCanvas.getContext().drawImage(this._createPenCanvas().getCanvas(),0,0,this._w,this._h);{new nc.playinG.command.PenCommand(this,this.createImageData(),old)}this._removePenCanvas()}},this)},_setUI:function(){nc.setStyle(this.wrap,"left",nc.addPx(this.menuSize.w+this.options.margin)),nc.setStyle(this.wrap,"top",nc.addPx(this.options.margin)),nc.setStyle(this.wrap,"width",nc.addPx(this._gridSize.w)),nc.setStyle(this.wrap,"height",nc.addPx(this._gridSize.h)),this._setCanvasWrapSize(this._gridSize.w,this._gridSize.h),nc.setStyle(this.html._filterParent,"height",nc.addPx(this._gridSize.h)),this._filterScroll=new nc.Scrollbar(this.html._filterParent,this.html._filterListG,"#333"),this._filterScroll.defaultHeight=nc.getStyle(this.html._filterParent,"height"),nc.setStyle(this.subMenuPanel,"left",nc.addPx(310)),this._setBaseMenu(),this._setFilterMenu(),this._setDrawMenu(),nc.playinG.Event.addListener(window,"resize",function(){this.setFilterScrollHeight()}.binder(this)),nc.playinG.Event.addListener(window,"resize",function(){this.setSymbolScrollHeight()}.binder(this)),this.setFilterScrollHeight(),this._filterScroll.moveTop(),this.setSymbolScrollHeight(),this._symbolScroll&&this._symbolScroll.moveTop()},setFilterScrollHeight:function(){{var h=nc.integer(nc.getStyle(this.html._filterListG,"height")),ph=nc.integer(nc.getStyle(this.html._filterParent,"height")),bh=nc.getBrowserSize().h;
nc.integer(this._filterScroll.defaultHeight)}ph=bh-200,180>ph&&(ph=180),nc.integer(nc.setStyle(this.html._filterParent,"height",nc.addPx(ph))),this._filterScroll.changeHeight(h,ph),this._filterScroll.moveTop()},setSymbolScrollHeight:function(){if(this.options.filterImageUrl){{var h=nc.integer(nc.getStyle(this.SymbolContent,"height")),ph=nc.integer(nc.getStyle(this.wrapSymbolListG,"height")),bh=nc.getBrowserSize().h;nc.integer(this._symbolScroll.defaultHeight)}ph=bh-450,180>ph&&(ph=180),nc.integer(nc.setStyle(this.wrapSymbolListG,"height",nc.addPx(ph))),this._symbolScroll.changeHeight(h,ph),this._symbolScroll.moveTop()}},_addEvent:function(){nc.playinG.Event.addListener(this.btnComplete,"click",function(){this.editCompleteConfirm(),nc.trk("/이미지편집/편집완료버튼/")}.binder(this)),nc.playinG.Event.addListener(this.html._baseEditorG,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this._currMenu=this.html._baseEditorG,this.setButton(0),this.showSubMenu(0),nc.trk("/이미지편집/기본편집/")}.binder(this)),nc.playinG.Event.addListener(this.html._filterG,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this._currMenu=this.html._filterG,this.setButton(1),this.showSubMenu(1),nc.trk("/이미지편집/사진효과/")}.binder(this)),nc.playinG.Event.addListener(this.html._drawG,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this._currMenu=this.html._drawG,this.setButton(2),this.showSubMenu(2),nc.trk("/이미지편집/그림그리기/")}.binder(this)),nc.playinG.Event.addListener(this.html._returnMenu,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this._isShowSubMenu=!1,this.initMenu(),nc.trk("/이미지편집/홈버튼/")}.binder(this)),nc.playinG.Event.addListener(this.html._btnPrev,"click",function(){this.resetBaseEdit(),this.resetDrawEdit();new nc.playinG.command.Undo;nc.trk("/이미지편집/이전/")}.binder(this)),nc.playinG.Event.addListener(this.html._btnNext,"click",function(){this.resetBaseEdit(),this.resetDrawEdit();new nc.playinG.command.Redo;nc.trk("/이미지편집/다음/")}.binder(this)),nc.playinG.Event.addListener(this.html._btnReset,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this.resetFilterEdit(),this.onReset(),nc.trk("/이미지편집/처음으로/")}.binder(this)),nc.playinG.Event.addListener(this.html._headerG,"mousemove",function(evt){if(this._isShowSubMenu){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt);var point=nc.getMousePosToScreen(evt);point.x>0&&point.x<18&&new nc.playinG.Animate(this.subMenuPanel,{left:nc.addPx(89)},{duration:150,easing:nc.playinG.Easing.bounceIn,callback:function(){this._isShowSubMenuAnimate=!0}.binder(this)}),point.x>90&&this._isShowSubMenuAnimate&&new nc.playinG.Animate(this.subMenuPanel,{left:nc.addPx(15)},{duration:80,callback:function(){this._isShowSubMenuAnimate=!1}.binder(this)})}}.binder(this)),nc.playinG.Event.addListener(this.html._closeG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this._isShowSubMenu=!1,nc.playinG.command.CommandManager.commands.length>0?this.hideConfirm():this.hide(),nc.trk("/이미지편집/닫기버튼/")}.binder(this))},onReset:function(){new nc.playinG.command.ResetCommand(this,this.createImageData())},_onReset:function(){var o=this._orign;this.putImageData(o.bitmap,o.w,o.h)},putImageData:function(pixels,w,h){var imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d"),w=w||pixels.width,h=h||pixels.height;this._setCanvasWrapSize(w,h),this._setCanvasSize(w,h),this._setCanvasWrapPos(),this.setSizeInfo(),ctx.clearRect(0,0,w,h),ctx.putImageData(pixels,0,0)},addChild:function(parent,childs){if(!(childs instanceof Array))return void parent.appendChild(childs);for(var i=0;childs[i];i++)parent.appendChild(childs[i])},_setDrawMenu:function(){{var p=this.html._DrawSubMenuListG,dl=document.createElement("dl"),dt=document.createElement("dt"),dd=document.createElement("dd"),d=document.createElement("div");document.createElement("ul"),document.createElement("li"),document.createElement("span")}radio=document.createElement("input"),label=document.createElement("label"),radio.type="radio";var wrap=dl.cloneNode(!1),drawSizeG=dt.cloneNode(!1);drawSizeG.className="drawSizeG",drawSizeG.innerHTML='<span class="ic"></span>붓 크기';var drawSizeDd=dd.cloneNode(!1),wrapDrawSizeG=d.cloneNode(!1);wrapDrawSizeG.className="wrapDrawSizeG",this.drawSizeSelect=d.cloneNode(!1),this.drawSizeSelect.className="selectUIG",this.drawSizeSelect.innerHTML="크기 선택",this.drawSizeSelector=new nc.playinG.DrawSizeSelector,this.drawSizeSelector.onClick.add(function(size){this.resetDrawEdit(),this.pen&&this.pen.setEnable(!0),this.pen.setWidth(size),this.drawSizeSelect.innerHTML=size+"px",nc.trk("/이미지편집/그림그리기/붓크기/"+size+"px/")}.binder(this)),this.addChild(wrapDrawSizeG,this.drawSizeSelector.getPanel());var drawColorG=dt.cloneNode(!1);drawColorG.className="drawColorG",drawColorG.innerHTML='<span class="ic"></span>붓 색상';var drawColorDd=dd.cloneNode(!1);this.colorSelectG=d.cloneNode(!1),this.colorSelectG.className="colorSelectG",this.colorSelectG.innerHTML='<em style="background-color:#000">#000000</em><span></span>',this.wrapColorSetG=d.cloneNode(!1),this.wrapColorSetG.className="wrapColorSetG",this.colorPicker=new nc.playinG.ColorPicker,this.colorPicker.onClick.add(function(color){this.colorSelectG.innerHTML='<em style="background-color:'+color+'">'+color+"</em><span></span>",this.pen.setColor(color),nc.removeClassName(this.drawSizeSelect,"on"),nc.removeClassName(this.drawSizeSelector.getPanel(),"on"),nc.removeClassName(this.colorSelectG,"on"),nc.removeClassName(this.wrapColorSetG,"on"),nc.removeClassName(this.colorPicker.getPanel(),"on"),nc.trk("/이미지편집/그림그리기/붓색상/"+color+"/")}.binder(this));var drawSymbolG=dt.cloneNode(!1);drawSymbolG.className="drawSymbolG",drawSymbolG.innerHTML='<span class="ic"></span>꾸미기 문양';var drawSymbolDd=dd.cloneNode(!1);this.wrapSymbolListG=d.cloneNode(!1),this.wrapSymbolListG.className="wrapSymbolListG",this.SymbolContent=d.cloneNode(!1),nc.setStyle(this.SymbolContent,"height",nc.addPx(1356));var symbols=[];this.options.filterImageUrl&&(symbols=[{name:"jobG01",type:"암살자",symbolB:this.options.filterImageUrl+"job_01_b.png",symbolW:this.options.filterImageUrl+"job_01_w.png"},{name:"jobG02",type:"역사",symbolB:this.options.filterImageUrl+"job_02_b.png",symbolW:this.options.filterImageUrl+"job_02_w.png"},{name:"jobG03",type:"기공사",symbolB:this.options.filterImageUrl+"job_03_b.png",symbolW:this.options.filterImageUrl+"job_03_w.png"},{name:"jobG04",type:"권사",symbolB:this.options.filterImageUrl+"job_04_b.png",symbolW:this.options.filterImageUrl+"job_04_w.png"},{name:"jobG05",type:"검사",symbolB:this.options.filterImageUrl+"job_05_b.png",symbolW:this.options.filterImageUrl+"job_05_w.png"},{name:"jobG06",type:"소환사",symbolB:this.options.filterImageUrl+"job_06_b.png",symbolW:this.options.filterImageUrl+"job_06_w.png"},{name:"raceG01",type:"진족",symbolB:this.options.filterImageUrl+"race_01_b.png",symbolW:this.options.filterImageUrl+"race_01_w.png"},{name:"raceG02",type:"곤족",symbolB:this.options.filterImageUrl+"race_02_b.png",symbolW:this.options.filterImageUrl+"race_02_w.png"},{name:"raceG03",type:"린족",symbolB:this.options.filterImageUrl+"race_03_b.png",symbolW:this.options.filterImageUrl+"race_03_w.png"},{name:"raceG04",type:"건족",symbolB:this.options.filterImageUrl+"race_04_b.png",symbolW:this.options.filterImageUrl+"race_04_w.png"},{name:"effectG01",type:"효과1",symbolB:this.options.filterImageUrl+"effect_01_b.png",symbolW:this.options.filterImageUrl+"effect_01_w.png",symbolR:this.options.filterImageUrl+"effect_01_r.png"},{name:"effectG02",type:"효과2",symbolB:this.options.filterImageUrl+"effect_02_b.png",symbolW:this.options.filterImageUrl+"effect_02_w.png",symbolR:this.options.filterImageUrl+"effect_02_r.png"},{name:"effectG03",type:"효과3",symbolB:this.options.filterImageUrl+"effect_03_b.png",symbolW:this.options.filterImageUrl+"effect_03_w.png",symbolR:this.options.filterImageUrl+"effect_03_r.png"},{name:"effectG04",type:"효과4",symbolB:this.options.filterImageUrl+"effect_04_b.png",symbolW:this.options.filterImageUrl+"effect_04_w.png",symbolR:this.options.filterImageUrl+"effect_04_r.png"},{name:"effectG05",type:"효과5",symbolB:this.options.filterImageUrl+"effect_05_b.png",symbolW:this.options.filterImageUrl+"effect_05_w.png",symbolR:this.options.filterImageUrl+"effect_05_r.png"},{name:"effectG06",type:"효과6",symbolB:this.options.filterImageUrl+"effect_06_b.png",symbolW:this.options.filterImageUrl+"effect_06_w.png"},{name:"logoG01",type:"로고1",symbolB:this.options.filterImageUrl+"logo_01_b.png",symbolW:this.options.filterImageUrl+"logo_01_w.png"},{name:"logoG02",type:"로고2",symbolB:this.options.filterImageUrl+"logo_02_b.png",symbolW:this.options.filterImageUrl+"logo_02_w.png"},{name:"figureG01",type:"도형1",symbolB:this.options.filterImageUrl+"figure_01_b.png",symbolW:this.options.filterImageUrl+"figure_01_w.png",symbolR:this.options.filterImageUrl+"figure_01_r.png",symbolY:this.options.filterImageUrl+"figure_01_y.png"},{name:"figureG02",type:"도형2",symbolB:this.options.filterImageUrl+"figure_02_b.png",symbolW:this.options.filterImageUrl+"figure_02_w.png",symbolY:this.options.filterImageUrl+"figure_02_y.png"},{name:"figureG03",type:"도형3",symbolB:this.options.filterImageUrl+"figure_03_b.png",symbolW:this.options.filterImageUrl+"figure_03_w.png",symbolY:this.options.filterImageUrl+"figure_03_y.png"},{name:"figureG04",type:"도형4",symbolB:this.options.filterImageUrl+"figure_04_b.png",symbolW:this.options.filterImageUrl+"figure_04_w.png",symbolY:this.options.filterImageUrl+"figure_04_y.png"},{name:"figureG05",type:"도형5",symbolB:this.options.filterImageUrl+"figure_05_b.png",symbolW:this.options.filterImageUrl+"figure_05_w.png",symbolR:this.options.filterImageUrl+"figure_05_r.png",symbolY:this.options.filterImageUrl+"figure_05_y.png"},{name:"figureG06",type:"도형6",symbolB:this.options.filterImageUrl+"figure_06_b.png",symbolW:this.options.filterImageUrl+"figure_06_w.png",symbolR:this.options.filterImageUrl+"figure_06_r.png",symbolY:this.options.filterImageUrl+"figure_06_y.png"}],symbolsImages=[],this.symbolSelector=new nc.playinG.SymbolSelector(symbols),this.symbolSelector.onClick.add(function(symbol){this.resetDrawEdit(),this._symbolGuide&&(this._onSymbolCancel(),this._symbolGuide.removeObserver(),this._symbolGuide=null),this._symbolGuide=new nc.playinG.SymbolGuideline(symbols[symbol.idx][symbol.symbol],this.getCanvasWrapSizeAndPos()),this._symbolGuide.onApply.add(function(){this._onApplySymbol()}.binder(this)),this._symbolGuide.onCancel.add(function(){this._onSymbolCancel()}.binder(this)),this._symbolGuide.isAppend()||this._symbolGuide.appendTo(this.canvasWrap),this._symbolGuide.isShow()||this._symbolGuide.show(),this.setEditCancelFunction(this._onSymbolCancel),nc.trk("/이미지편집/그림그리기/문양/"+symbols[symbol.idx][symbol.symbol]+"/")}.binder(this)),this.addChild(this.SymbolContent,this.symbolSelector.getPanel()),this.addChild(this.wrapSymbolListG,this.SymbolContent),this.addChild(drawSymbolDd,this.wrapSymbolListG),this.addChild(this.wrapColorSetG,this.colorPicker.getPanel()),this.addChild(drawColorDd,[this.colorSelectG,this.wrapColorSetG]),this.addChild(wrapDrawSizeG,[this.drawSizeSelect,this.drawSizeSelector.getPanel()]),this.addChild(drawSizeDd,[wrapDrawSizeG]),this.addChild(wrap,[drawSizeG,drawSizeDd,drawColorG,drawColorDd,drawSymbolG,drawSymbolDd]),this.addChild(p,wrap),this._symbolScroll=new nc.Scrollbar(this.wrapSymbolListG,this.SymbolContent,"#333"),this._symbolScroll.defaultHeight=nc.getStyle(this.wrapSymbolListG,"height")),nc.playinG.Event.addListener(this.drawSizeSelect,"click",function(){this.resetDrawEdit(),nc.addClassName(this.drawSizeSelect,"on"),nc.addClassName(this.drawSizeSelector.getPanel(),"on")}.binder(this)),nc.playinG.Event.addListener(this.colorSelectG,"click",function(){nc.addClassName(this.wrapColorSetG,"on"),nc.addClassName(this.colorPicker.getPanel(),"on")}.binder(this))},_setBaseMenu:function(){{var p=this.html._BaseEditorSubMenuListG,b=document.createElement("button"),d=document.createElement("div"),radio=(document.createElement("span"),document.createElement("ul"),document.createElement("li"),document.createElement("input"));document.createElement("label")}radio.type="radio",radio.name="resizeSelect",nc.addClassName(b,"btnGrayG"),nc.addClassName(b,"lSizeG"),this._btnSize=b.cloneNode(!1),nc.addClassName(this._btnSize,"resizeG"),this._btnSize.innerHTML='<span class="ic"></span>크기조절',this._checkRatioWrap=d.cloneNode(!1),this._checkRatioWrap.className="ratioFixedG checkUIG",this._chkRatio=document.createElement("input"),this._chkRatio.type="checkbox",this._chkRatioLabel=document.createElement("label"),this._chkRatioLabel.setAttribute("for","ratioG"),this._chkRatioLabel.innerHTML="비율유지",this._checkRatioWrap.appendChild(this._chkRatio),this._checkRatioWrap.appendChild(this._chkRatioLabel),this._btnCrop=b.cloneNode(!1),nc.removeClassName(this._btnCrop,"lSizeG"),nc.addClassName(this._btnCrop,"mSizeG"),nc.addClassName(this._btnCrop,"cutG"),this._btnCrop.innerHTML='<span class="ic"></span>자르기';var wrapResizeCustomG=d.cloneNode(!1);wrapResizeCustomG.className="wrapResizeCustomG",this.resizeCustomG=d.cloneNode(!1),this.resizeCustomG.className="selectUIG",this.resizeCustomG.innerHTML="사용자지정",this.cropSelector=new nc.playinG.CropSelector,this.cropSelector.onClick.add(function(value){this.resetBaseEdit(),this.resetDrawEdit(),this.setCropGuideline(value.size.w,value.size.h),nc.trk("/이미지편집/기본편집/사용자지정/"+value.name+"/")}.binder(this)),this.addChild(wrapResizeCustomG,[this.resizeCustomG,this.cropSelector.getPanel()]),this._btnRotate90=b.cloneNode(!1),nc.addClassName(this._btnRotate90,"rotate90G"),this._btnRotate90.innerHTML='<span class="ic"></span>90도회전',this._btnRotateHG=b.cloneNode(!1),nc.addClassName(this._btnRotateHG,"rotateHG"),this._btnRotateHG.innerHTML='<span class="ic"></span>좌우반전',this._btnRotateVG=b.cloneNode(!1),nc.addClassName(this._btnRotateVG,"rotateVG"),this._btnRotateVG.innerHTML='<span class="ic"></span>상하반전',this._btnMosaicG=b.cloneNode(!1),nc.addClassName(this._btnMosaicG,"mosaicG"),this._btnMosaicG.innerHTML='<span class="ic"></span>모자이크',nc.playinG.Event.addListener(this._btnSize,"click",function(){this.setSizeGuideline(),nc.trk("/이미지편집/기본편집/크기조절/")}.binder(this)),nc.playinG.Event.addListener(this._chkRatioLabel,"click",function(){nc.hasClassName(this._chkRatioLabel,"on")?(this.resetBaseEdit(),this.resetDrawEdit()):(this.setSizeGuideline(),this._sizeGuide.setRatio(!0),nc.addClassName(this._chkRatioLabel,"on")),nc.trk("/이미지편집/기본편집/비율유지/")}.binder(this)),nc.playinG.Event.addListener(this._btnCrop,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this._cropGuide||(this._cropGuide=new nc.playinG.CropGuideline,this._cropGuide.onApply.add(function(){this._onApplyCrop()}.binder(this)),this._cropGuide.onCancel.add(function(){this._onCropCancel()}.binder(this)));var c=this.getCanvasWrapSizeAndPos();this._cropGuide.setMaxSizeAndPosition(-2,-2,c.w,c.h),this._cropGuide.isAppend()||this._cropGuide.appendTo(this.canvasWrap),this._cropGuide.isShow()||this._cropGuide.show(),this.setEditCancelFunction(this._onCropCancel),nc.trk("/이미지편집/기본편집/자르기/")}.binder(this)),nc.playinG.Event.addListener(this._btnMosaicG,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this._mosaicGuide||(this._mosaicGuide=new nc.playinG.MosaicGuideline,this._mosaicGuide.onApply.add(function(){this._onApplyMosaic()}.binder(this)),this._mosaicGuide.onCancel.add(function(){this._onMosaicCancel()}.binder(this)));var c=this.getCanvasWrapSizeAndPos();this._mosaicGuide.setMaxSizeAndPosition(-2,-2,c.w,c.h),this._mosaicGuide.isAppend()||this._mosaicGuide.appendTo(this.canvasWrap),this._mosaicGuide.isShow()||this._mosaicGuide.show(),this.setEditCancelFunction(this._onMosaicCancel),nc.trk("/이미지편집/기본편집/모자이크/")}.binder(this)),nc.playinG.Event.addListener(this._btnRotate90,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this.setRotate("cw"),this._edited=!0,nc.trk("/이미지편집/기본편집/90도회전/")}.binder(this)),nc.playinG.Event.addListener(this._btnRotateHG,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this.setFlip(),this._edited=!0,nc.trk("/이미지편집/기본편집/좌우반전/")}.binder(this)),nc.playinG.Event.addListener(this._btnRotateVG,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),this.setFlip("v"),this._edited=!0,nc.trk("/이미지편집/기본편집/상하반전/")}.binder(this)),nc.playinG.Event.addListener(this.resizeCustomG,"click",function(){this.resetBaseEdit(),this.resetDrawEdit(),nc.addClassName(this.resizeCustomG,"on"),nc.addClassName(this.cropSelector.getPanel(),"on"),nc.trk("/이미지편집/기본편집/사용자지정/")}.binder(this)),this.addChild(p,[this._btnSize,this._checkRatioWrap,this._btnCrop,wrapResizeCustomG,this._btnRotate90,this._btnRotateHG,this._btnRotateVG,this._btnMosaicG])},resetEdit:function(){this._editCancel&&(this._editCancel(),this.removeEditCancelFunction())},removeEditCancelFunction:function(){this._editCancel=null},setEditCancelFunction:function(func){this._editCancel=func},setSizeGuideline:function(){this.resetBaseEdit(),this.resetDrawEdit(),this.cloneCurrImage(),this._sizeGuide||(this._sizeGuide=new nc.playinG.SizeGuideline,this._sizeGuide.onChange.add(function(){}.binder(this)),this._sizeGuide.onApply.add(function(){this._onApplyResize()}.binder(this)),this._sizeGuide.onCancel.add(function(){this._onResizeCancel()}.binder(this))),this._sizeGuide.setImage(this.getCurrImageString());var c=this.getCanvasWrapSizeAndPos();this._sizeGuide.setMaxSizeAndPosition(-2,-2,c.w,c.h);var csize=this.getCanvasWrapSizeAndPos();this._sizeGuide.setFixSizeAndPosition(-csize.t,-csize.l,this._w,this._h),nc.setStyle(this.createImageCanvas().getCanvas(),"opacity",.4),this._sizeGuide.isAppend()||this._sizeGuide.appendTo(this.canvasWrap),this._sizeGuide.isShow()||this._sizeGuide.show(),this.setEditCancelFunction(this._onResizeCancel)},setCropGuideline:function(w,h){var browserH=nc.getStyle(this.canvasWrap,"height"),canvasW=nc.getStyle(this.canvasWrap,"width"),guideL=(nc.integer(canvasW)-w)/2,guideT=(nc.integer(browserH)-h)/2;this.resetBaseEdit(),this.resetDrawEdit(),this._cropGuide||(this._cropGuide=new nc.playinG.CropGuideline,this._cropGuide.onApply.add(function(){this._onApplyCrop()}.binder(this)),this._cropGuide.onCancel.add(function(){this._onCropCancel()}.binder(this))),this._cropGuide.setMaxSizeAndPosition(guideT,guideL,w,h),this._cropGuide.isAppend()||this._cropGuide.appendTo(this.canvasWrap),this._cropGuide.isShow()||this._cropGuide.show(),this.setEditCancelFunction(this._onCropCancel)},_onApplySkew:function(){var c=this._skewGuide.getPanelSize(),pixels=this.createImageData(c.t,c.l,c.w,c.h);this._setCanvasWrapSize(c.w,c.h),this._setCanvasSize(c.w,c.h),this._setCanvasWrapPos();new nc.playinG.command.SkewCommand(this,pixels,this.skewOld);this._skewGuide.removeTo(this.canvasWrap),this.removeEditCancelFunction()},_onSkewCancel:function(){if(this.skewOld&&(this.skewOld=null),this._skewGuide&&this._skewGuide.isAppend()&&this._skewGuide.removeTo(this.canvasWrap),this._cloneCurrImage){{var imgCanvas=this.createImageCanvas();imgCanvas.getCanvas(),imgCanvas.getContext("2d")}this.putImageData(this._cloneCurrImage,this._w,this._h),this.removeCloneImageCanvas()}},_onApplyMosaic:function(){{var c=this._mosaicGuide.getPanelSize();new nc.playinG.command.MosaicCommand(this,c,this.createImageData())}this._mosaicGuide.removeTo(this.canvasWrap),this.removeEditCancelFunction()},_setMosaic:function(size){var c=size,pixelData=this.createImageData(),imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext(),mSize={x:c.l,y:c.t,w:c.l+c.w,h:c.t+c.h},pixels=nc.Effect.mosaic(pixelData,mSize,this._w,this._h);ctx.putImageData(pixels,0,0)},_onMosaicCancel:function(){this._mosaicGuide&&this._mosaicGuide.isAppend()&&this._mosaicGuide.removeTo(this.canvasWrap),this.removeEditCancelFunction()},_onSymbolCancel:function(){this._symbolGuide&&this._symbolGuide.isAppend()&&this._symbolGuide.removeTo(this.canvasWrap),this.removeEditCancelFunction()},_onApplyCrop:function(){{var c=this._cropGuide.getPanelSize();new nc.playinG.command.CropCommand(this,c.l,c.t,c.w,c.h,this.createImageData())}this._cropGuide.removeTo(this.canvasWrap),this.removeEditCancelFunction()},_onCropCancel:function(){this._cropGuide&&this._cropGuide.isAppend()&&this._cropGuide.removeTo(this.canvasWrap),this.removeEditCancelFunction()},_setCrop:function(x,y,w,h){var imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d"),pixels=this.createImageData(x,y,w,h),canvas=document.createElement("canvas");canvas.width=w,canvas.height=h,canvas.getContext("2d").putImageData(pixels,0,0),ctx.clearRect(0,0,this._w,this._h),this._setCanvasWrapSize(w,h),this._setCanvasSize(w,h),this._setCanvasWrapPos(),this.setSizeInfo(),ctx.drawImage(canvas,0,0,w,h),canvas=null},_onApplySymbol:function(){var c=this._symbolGuide.getPanelSize(),old=this.createImageData(),imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d");ctx.drawImage(this._symbolGuide.getImage(),c.l,c.t,c.w,c.h);new nc.playinG.command.SymbolCommand(this,this.createImageData(),old);this._symbolGuide.removeTo(this.canvasWrap),this.removeEditCancelFunction()},_setSize:function(pixels,w,h){if(pixels){var imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d"),canvas=document.createElement("canvas");canvas.width=pixels.width,canvas.height=pixels.height,canvas.getContext("2d").putImageData(pixels,0,0),this._setCanvasWrapSize(w,h),this._setCanvasSize(w,h),this._setCanvasWrapPos(),this.setSizeInfo(),ctx.clearRect(0,0,w,h),ctx.drawImage(canvas,0,0,pixels.width,pixels.height,0,0,w,h),canvas=null}},_onApplyResize:function(){{var imgcanvas=this.createImageCanvas(),canvas=imgcanvas.getCanvas(),c=this._sizeGuide.getPanelSize();new nc.playinG.command.SizeCommand(this,c.w,c.h,this._cloneCurrImage)}nc.setStyle(canvas,"top",nc.addPx(0)),nc.setStyle(canvas,"left",nc.addPx(0)),this._sizeGuide.removeTo(this.canvasWrap),this.removeEditCancelFunction(),nc.setStyle(this.createImageCanvas().getCanvas(),"opacity",1)},_onResizeCancel:function(){if(this._sizeGuide&&this._sizeGuide.isAppend()&&this._sizeGuide.removeTo(this.canvasWrap),this._cloneCurrImage){var imgCanvas=this.createImageCanvas(),canvas=imgCanvas.getCanvas(),ctx=imgCanvas.getContext("2d");canvas.width=this._w,canvas.height=this._h,ctx.clearRect(0,0,this._w,this._h),this._setCanvasWrapSize(this._w,this._h),this._setCanvasSize(this._w,this._h),this._setCanvasWrapPos(),nc.setStyle(canvas,"top",nc.addPx(0)),nc.setStyle(canvas,"left",nc.addPx(0)),this.putImageData(this._cloneCurrImage,this._w,this._h),this.removeCloneImageCanvas(),nc.setStyle(this.createImageCanvas().getCanvas(),"opacity",1)}},resetBaseEdit:function(){this.resetEdit(),nc.removeClassName(this.resizeCustomG,"on"),nc.removeClassName(this.cropSelector.getPanel(),"on"),this._sizeGuide&&this._sizeGuide.setRatio(!1),nc.removeClassName(this._chkRatioLabel,"on")},resetFilterEdit:function(){for(var i=0;this._filterList[i];i++){var fl=this._filterList[i];nc.removeClassName(fl,"on")}},resetDrawEdit:function(){nc.removeClassName(this.drawSizeSelect,"on"),nc.removeClassName(this.drawSizeSelector.getPanel(),"on"),nc.removeClassName(this.colorSelectG,"on"),nc.removeClassName(this.wrapColorSetG,"on"),nc.removeClassName(this.colorPicker.getPanel(),"on"),this.pen.setEnable(!1),this.drawSizeSelect.innerHTML="크기지정"},initMenu:function(){this._currMenu=null,nc.removeClassName(this.mainMenuPanel,"on"),nc.setStyle(this.mainMenuPanel,"left",nc.addPx(89));new nc.playinG.Animate(this.subMenuPanel,{left:nc.addPx(310)},{duration:300,callback:function(){this._isShowSubMenu=!1}.binder(this)});this.setButton(-1)},setButton:function(idx){for(var i=0;this.menuButton[i];i++)idx===i?nc.addClassName(this.menuButton[i],"select"):nc.removeClassName(this.menuButton[i],"select")},showSubMenu:function(idx){nc.addClassName(this.mainMenuPanel,"on"),nc.setStyle(this.mainMenuPanel,"left",nc.addPx(0));for(var i=(new nc.playinG.Animate(this.subMenuPanel,{left:nc.addPx(15)},{duration:300,callback:function(){this._isShowSubMenu=!0}.binder(this)}),0);this.submenu[i];i++)if(idx===i){if(nc.setStyle(this.submenu[i],"display","block"),1===idx){var h=nc.getStyle(this.html._filterListG,"height"),ph=nc.getStyle(this.html._filterParent,"height");this._filterScroll.changeHeight(h,ph)}}else nc.setStyle(this.submenu[i],"display","none")},_setFilterMenu:function(){this._filterList=[];for(var _li=document.createElement("li"),_a=document.createElement("a"),_div=document.createElement("div"),_span=document.createElement("span"),num=0,i=0;this.filters.get()[i];i++){var li=_li.cloneNode(!1),a=_a.cloneNode(!1),thumb=_div.cloneNode(!1);thumb.className="filterThumbG";var name=_div.cloneNode(!1);name.className="filterNameG",name.innerHTML=this.filters.get()[i].name;var span=_span.cloneNode(!1);span.className="filterMaskG",span.innerHTML="효과없애기",num=9>i?"0"+(i+1):i+1,thumb.innerHTML='<img src="'+nc.imgUrl+"static/filter"+num+'.png" alt="" />',a.appendChild(thumb),a.appendChild(name),a.appendChild(span),li.appendChild(a),this._filterList.push(li),function(obj,li){nc.playinG.Event.addListener(li,"click",function(){obj.setFillterOnClick(li)}.binder(obj))}(this,li),this.html._filterListG.appendChild(li)}},setFillterOnClick:function(li){for(var i=0;this._filterList[i];i++){var fl=this._filterList[i];li===fl?(nc.addClassName(fl,"on"),this.setFilter(i)):nc.removeClassName(fl,"on")}},setFilter:function(idx){var effectNm=this.filters.list[idx];this.setEffect(effectNm),nc.trk("/이미지편집/사진효과/"+effectNm+"/")},initCommand:function(){nc.playinG.command.CommandManager.commands=[],nc.playinG.command.CommandManager.redos=[],nc.playinG.command.CommandManager.lastCommand=null,this._tmpPixelImage=null},setEffect:function(effect){if(effect){var pixels;(null===nc.playinG.command.CommandManager.lastCommand||"EffectCommand"!==nc.playinG.command.CommandManager.lastCommand.getMode())&&(this._tmpPixelImage=this.createImageData()),nc.playinG.command.CommandManager.lastCommand&&"EffectCommand"===nc.playinG.command.CommandManager.lastCommand.getMode()&&this._setEffect(this._tmpPixelImage);for(var e=nc.Effect.list,b=!1,i=0,len=e.length;len>i;i++)if(effect==e[i]){b=!0;break}if(b){this.selectPixels?(pixels=nc.Effect[effect](this.createImageData(),this.selectPixels.getSelectPixels(),this._w,this._h),this.selectPixels.destroy(),this.selectPixels=null):pixels=nc.Effect[effect](this.createImageData());{new nc.playinG.command.EffectCommand(this,pixels,this._tmpPixelImage||this.createImageData())}}}},_setEffect:function(pixels){var imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext();ctx.putImageData(pixels,0,0),nc.Effect.loaded()},createImageData:function(x,y,w,h){var canvas,ctx;return canvas=this.createImageCanvas(),ctx=canvas.getContext("2d"),x&&y&&w&&h?ctx.getImageData(x,y,w,h):ctx.getImageData(0,0,this._w,this._h)},setRotate:function(cw){var d="cw"==cw?90:-90;d+=this._deg,d>=360&&(d=0),0>d&&(d+=360);new nc.playinG.command.RotateCommand(this,d,this.createImageData())},_setRotate:function(deg){var imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d"),pixels=this.createImageData(),w=0,h=0,trans={x:0,y:0};this._deg=deg,w=this._h,h=this._w,trans.x=w,trans.y=0;var canvas=document.createElement("canvas"),ctxTmp=canvas.getContext("2d");canvas.width=this._w,canvas.height=this._h,ctxTmp.putImageData(pixels,0,0),this._setCanvasWrapSize(w,h),this._setCanvasSize(w,h),this._setCanvasWrapPos(),ctx.save(),ctx.clearRect(0,0,w,h),ctx.translate(trans.x,trans.y),ctx.rotate(90*Math.PI/180),ctx.drawImage(canvas,0,0),ctx.restore(),canvas=null,this.rotateResize()},rotateResize:function(){var size=this.getImageSize(this._w,this._h);this._setSize(this.createImageData(),size.w,size.h)},setFlip:function(v){var imgCanvas=this.createImageCanvas(),canvas=(imgCanvas.getContext("2d"),document.createElement("canvas"));canvas.width=this._w,canvas.height=this._h,tmpCtx=canvas.getContext("2d"),v?(tmpCtx.scale(1,-1),tmpCtx.drawImage(imgCanvas.getCanvas(),0,-canvas.height)):(tmpCtx.scale(-1,1),tmpCtx.drawImage(imgCanvas.getCanvas(),-canvas.width,0));new nc.playinG.command.FlipCommand(this,canvas,this.createImageData())},_setFlip:function(canvas){var imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d");ctx.clearRect(0,0,this._w,this._h),ctx.drawImage(canvas,0,0,this._w,this._h)},hideConfirm:function(){nc.playinG.ConfirmController.getInstance().setMsg("편집 화면을 닫습니다."),nc.playinG.ConfirmController.getInstance().setMsgContent("<p>수정된 내용이 적용되지 않습니다.</p><p>편집을 종료 하시겠습니까?</p>"),nc.playinG.ConfirmController.getInstance().setTitle("닫기"),nc.playinG.ConfirmController.getInstance().show(this.hide.binder(this))},editCompleteConfirm:function(){nc.playinG.ConfirmController.getInstance().setMsg("편집을 완료 합니다."),nc.playinG.ConfirmController.getInstance().setMsgContent("<p>작업하신 내용을 저장 후</p><p>업로드 화면으로 돌아갑니다.</p>"),nc.playinG.ConfirmController.getInstance().setTitle("편집"),nc.playinG.ConfirmController.getInstance().show(this.save.binder(this))},hide:function(){nc.playinG.LoadingController.getInstance().hide(),this._prevScrollHeight&&nc.setScrollHeight(this._prevScrollHeight),this._escEvent&&this._escEvent.remove(),this.options.onHideFunc&&this.options.onHideFunc(),nc.setStyle(document.documentElement,"overflowY","scroll"),nc.setStyle(document.documentElement,"overflowX","auto"),nc.setStyle(this.modal.get(),"display","none"),nc.setStyle(this.html.getContainer(),"display","none"),this.resetBaseEdit(),this.resetDrawEdit(),this.resetFilterEdit(),this.initMenu(),this._onSkewCancel(),this._onMosaicCancel(),this._onSymbolCancel(),this._onCropCancel(),this._onResizeCancel(),this.onHide.dispatch();var imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d");ctx.clearRect(0,0,this._w,this._h)},show:function(){this.options.onShowFunc&&this.options.onShowFunc(),nc.setStyle(document.documentElement,"overflowY","hidden"),nc.setStyle(document.documentElement,"overflow","hidden"),nc.setStyle(this.modal.get(),"display","block"),nc.setStyle(this.html.getContainer(),"display","block"),this._escEvent&&this._escEvent.remove(),this._escEvent=nc.playinG.Event.addListener(document,"keydown",function(event){var evt=evt?evt:event,code=evt.keyCode;27===code?(nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this._isShowSubMenu=!1,nc.playinG.command.CommandManager.commands.length>0?this.hideConfirm():this.hide()):37===code?(nc.playinG.Event.preventDefault(event),nc.playinG.Event.stopPropagation(event)):39===code&&(nc.playinG.Event.preventDefault(event),nc.playinG.Event.stopPropagation(event))}.binder(this)),nc.trk("/이미지편집/실행/")},getCurrImageString:function(){var imageCanvas=this.createImageCanvas(),canvasData=imageCanvas.getCanvas().toDataURL("image/jpg");return canvasData},save:function(){nc.playinG.LoadingController.getInstance().setZIndex(this.options.zIndex+10),nc.playinG.LoadingController.getInstance().show(),this.modifyImg(),this.onComplete.dispatch();var imgCanvas=this.createImageCanvas(),ctx=imgCanvas.getContext("2d");ctx.clearRect(0,0,this._w,this._h)}},nc.playinG.ViewerDom=ViewerDom=function(){this._div=document.createElement("div"),this._span=document.createElement("span"),this._button=document.createElement("button"),this._a=document.createElement("a"),nc.playinG.Event.addListener(this._a,"click",function(evt){nc.playinG.Event.preventDefault(evt)}),this._ul=document.createElement("ul"),this._li=document.createElement("li"),this._h3=document.createElement("h3"),this._dl=document.createElement("dl"),this._dt=document.createElement("dt"),this._dd=document.createElement("dd"),this._hr=document.createElement("hr"),this._containerG=this._div.cloneNode(!1),this._containerG.className="containerG cf",nc.setStyle(this._containerG,"overflow","hidden"),nc.setStyle(this._containerG,"overflow-y","scroll"),this._wrapImgViewG=this._div.cloneNode(!1),this._wrapImgViewG.className="wrapImgviewG",this._wrapCommentG=this._div.cloneNode(!1),this._wrapCommentG.className="wrapCommentG",this._notifyGuideG=this._div.cloneNode(!1),this._notifyGuideG.className="notifyGuideG",this._notifyGuideG.innerHTML="Esc키를 누르시면 창이 닫힙니다.",nc.setOpacity(this._notifyGuideG,0),nc.setStyle(this._notifyGuideG,"display","none"),this._loadingGuideG=this._div.cloneNode(!1),this._loadingGuideG.className="notifyGuideG",this._loadingGuideG.innerHTML="로딩중입니다...",nc.setOpacity(this._loadingGuideG,0),nc.setStyle(this._loadingGuideG,"display","none"),this._wrapCommentGScrollParent=this._div.cloneNode(!1),this._wrapCommentGScrollParent.className="wrapCommentGScrollParent",nc.setStyle(this._wrapCommentGScrollParent,"height","100%"),this._wrapCommentGScrollChild=this._div.cloneNode(!1),this._wrapCommentGScrollChild.className="wrapCommentGScrollChild",this._closeG=this._div.cloneNode(!1),this._closeG.className="closeG",this._imgStageG=this._div.cloneNode(!1),this._imgStageG.className="imgStageG",this._imgStageG.setAttribute("unselectable","on");
var stg=this._imgStageG.style;stg.webkitUserSelect="none",stg.webkitUserDrag="none",stg.MozUserSelect="none",this._imgPrevG=this._div.cloneNode(!1),this._imgPrevG.className="imgPrevG";var span=this._span.cloneNode(!1);this._imgPrevG.appendChild(span),this._imgNextG=this._div.cloneNode(!1),this._imgNextG.className="imgNextG";var span=this._span.cloneNode(!1);this._imgNextG.appendChild(span),this._openGameInfoG=this._a.cloneNode(!1),this._openGameInfoG.innerHTML="<span></span>스크린샷 정보",this._openGameInfoG.className="openGameInfoG",nc.setStyle(this._openGameInfoG,"display","none"),this._gameInfoG=this._div.cloneNode(!1),this._gameInfoG.className="gameInfoG",nc.setStyle(this._gameInfoG,"display","none");var charInfo=this._h3.cloneNode(!1);charInfo.innerHTML="캐릭터 정보",this._infoCharacterG=this._ul.cloneNode(!1),this._infoCharacterG.className="infoCharacterG",this._closeGameInfoG=this._a.cloneNode(!1),this._closeGameInfoG.className="closeGameInfoG",this._closeGameInfoG.innerHTML="<span></span>정보숨기기",this.addChild(this._gameInfoG,[charInfo,this._infoCharacterG,this._closeGameInfoG]),this._imgOptionG=this._div.cloneNode(!1),this._imgOptionG.className="imgOptionG",this._bgOptionG=this._div.cloneNode(!1),this._bgOptionG.className="bgOptionG",this._imgAlbumTit=this._a.cloneNode(!1),this._imgAlbumTit.innerHTML="<strong></strong>",this._imgAlbumTit.className="albumTitleG",this._optionMenu=this._div.cloneNode(!1),this._optionMenu.className="optionMenu",this._optionMenuList=this._ul.cloneNode(!1),this._optionMenuList.className="optionMenuList",this._shareButton=this._li.cloneNode(!1),this._shareButton.className="btnShareG",this._shareButton.innerHTML='<a href="#">공유하기</a>',this._shareList=this._ul.cloneNode(!1),this._shareList.className="shareList",this._btnTwitterG=this._li.cloneNode(!1),this._btnTwitterG.className="btnTwitterG";var _btn=this._a.cloneNode(!1);this.addChild(this._btnTwitterG,_btn),this._btnFacebookG=this._li.cloneNode(!1),this._btnFacebookG.className="btnFacebookG";var _btn=this._a.cloneNode(!1);this.addChild(this._btnFacebookG,_btn),this.addChild(this._shareList,[this._btnTwitterG,this._btnFacebookG]),this.addChild(this._shareButton,this._shareList),this._downButton=this._li.cloneNode(!1),this._downButton.className="btnDownloadG",this._downButton.innerHTML='<a href="#"><span>다운로드</span></a>',this._fullButton=this._li.cloneNode(!1),this._fullButton.className="btnFullScreenG",this._fullButton.innerHTML='<a href="#"><span>전체화면</span></a>',this._aniArrowG=this._span.cloneNode(!1),this._aniArrowG.className="aniArrowG",this._fullscreenCloseG=this._div.cloneNode(!1),this._fullscreenCloseG.className="fullScreenCloseG",this._fullscreenCloseG.className="fullScreeCloseG",nc.setStyle(this._fullscreenCloseG,"display","none"),this.setTree()},nc.playinG.ViewerDom.prototype.setTree=function(){this.addChild(this._wrapImgViewG,[this._imgStageG,this._imgPrevG,this._imgNextG,this._openGameInfoG]),this.addChild(this._gameInfoG,this._closeGameInfoG),this.addChild(this._imgOptionG,[this._bgOptionG,this._imgAlbumTit,this._optionMenu]),this.addChild(this._wrapImgViewG,[this._gameInfoG,this._imgOptionG,this._fullscreenCloseG]),this.addChild(this._optionMenuList,[this._shareButton,this._downButton,this._fullButton]),this.addChild(this._optionMenu,[this._optionMenuList,this._aniArrowG]),this.addChild(this._wrapCommentGScrollParent,this._wrapCommentGScrollChild),this.addChild(this._wrapCommentG,this._wrapCommentGScrollParent),this.addChild(this._containerG,[this._wrapImgViewG,this._wrapCommentG,this._notifyGuideG,this._loadingGuideG,this._closeG]),this.addChild(this._optionMenuList,[this._gameInfoButton,this._shareButton,this._downButton,this._fullButton])},nc.playinG.ViewerDom.prototype.get=function(dom){return this["_"+dom]},nc.playinG.ViewerDom.prototype.getContainer=function(){return this._containerG},nc.playinG.ViewerDom.prototype.addChild=function(parent,childs){if(!(childs instanceof Array))return void parent.appendChild(childs);for(var i=0;childs[i];i++)parent.appendChild(childs[i])},nc.playinG.MetaInfo=function(options){this._options=options,this.onInfo=new nc.playinG.Observer,this.metaUrl=this._options.metaInfo+"/"+this._options.channel+"/tag/",this._lastID=null},nc.playinG.MetaInfo.prototype={getMetaInfo:function(fileId,channel){channel&&(this.metaUrl=this._options.metaInfo+"/"+channel+"/tag/"),this._lastID=fileId;var metaUrl=this.metaUrl+fileId,metaInfo=(/\?/.test(metaUrl)?"&dummy="+ +new Date:"?dummy="+ +new Date,new nc.Jsonp(metaUrl,this.getData.binder(this)));metaInfo.load()},getData:function(data){this.onInfo.dispatch(data)},setLastID:function(lid){this._lastID=lid}},nc.playinG.ImageData=function(parent,isFastLoading){this._parent=parent,this._images=[],this._currNum=0,this._loadedNum=0,this.onLoaded=new nc.playinG.Observer,this.onMove=new nc.playinG.Observer,this.isFastLoading=isFastLoading||!1},nc.playinG.ImageData.isLoading=!1,nc.playinG.ImageData.prototype.pushObject=function(data){data.imgIdx=this._images.length,this._images.push(data)},nc.playinG.ImageData.prototype.length=function(){return this._images.length},nc.playinG.ImageData.prototype.remove=function(){for(var i=this._images.length-1;i>=0;i--)this._images[i].node&&this._images[i].node.parentNode&&this._parent.removeChild(this._images[i].node);this._images=[],this._currNum=0},nc.playinG.ImageData.prototype.selectByIdx=function(idx){return idx>this.length()-1||0>idx?void 0:(this._currNum=idx,this.isFastLoading?void this.get():this.get())},nc.playinG.ImageData.prototype.prev=function(){return nc.playinG.ImageData.isLoading?void 0:(this._currNum>0&&this._currNum--,this.isFastLoading?void this.get():this.get())},nc.playinG.ImageData.prototype.next=function(){return nc.playinG.ImageData.isLoading?void 0:(this._currNum<this._images.length-1&&this._currNum++,this.isFastLoading?void this.get():this.get())},nc.playinG.ImageData.prototype.checkLoading=function(total){for(var isLoaded=!0,i=0,len=total.length;len>i;i++)if(total[i]&&!total[i].isLoaded){isLoaded=!1;break}return isLoaded},nc.playinG.ImageData.prototype.onMoveDispatch=function(total){nc.playinG.ImageData.isLoading=!1,this.onMove.dispatch(total)},nc.playinG.ImageData.prototype.checkAndDispatch=function(total){this.checkLoading(total)&&this.onMoveDispatch(total)},nc.playinG.ImageData.prototype.setImageFastLoading=function(data,total){if(data){if(!data.imgUrl){var d=this._images.indexOf(data);return void this._images.splice(d,1)}var _obj=data,image=new Image;nc.setStyle(image,"position","absolute"),nc.setStyle(image,"top",nc.addPx(0)),nc.setStyle(image,"left",nc.addPx(0)),nc.setOpacity(image,0),_obj.isLoaded?this.checkAndDispatch(total):(nc.playinG.Event.addListener(image,"load",function(){_obj.w=image.width,_obj.h=image.height,_obj.node=image,_obj.error="N",_obj.isLoaded=!0,this.checkAndDispatch(total)}.binder(this)),nc.playinG.Event.addListener(image,"error",function(){var errorImage=new Image;errorImage.src="http://"+nc.staticUrl+"static.plaync.co.kr/editor/imagePlugin/static/missing.png",nc.setStyle(errorImage,"position","absolute"),nc.setStyle(errorImage,"top",nc.addPx(0)),nc.setStyle(errorImage,"left",nc.addPx(0)),nc.setOpacity(errorImage,0),_obj.w=297,_obj.h=53,_obj.node=errorImage,_obj.error="Y",_obj.isLoaded=!0,this.checkAndDispatch(total)}.binder(this)),_obj.isLoaded=!1,image.src=_obj.imgUrl)}},nc.playinG.ImageData.prototype.createNode=function(data){if(this.checkLoading(data))this.onMoveDispatch(data);else for(var i=0,len=data.length;len>i;i++)data[i]&&this.setImageFastLoading(data[i],data)},nc.playinG.ImageData.prototype.get=function(){var prev,curr,next;return prev=this._currNum-1>=0?this._images[this._currNum-1]:null,next=this._currNum+1<=this._images.length?this._images[this._currNum+1]:null,curr=this._images[this._currNum],this.isFastLoading?void this.createNode([prev,next,curr]):{prev:prev,next:next,curr:curr}},nc.playinG.ImageData.prototype.gets=function(){return this._images},nc.playinG.ImageData.prototype.setImage=function(data){if(data){if(!data.imgUrl){var d=this._images.indexOf(data);return void this._images.splice(d,1)}var _obj=data,image=new Image,isLoaded=!0;nc.setStyle(image,"position","absolute"),nc.setStyle(image,"top",nc.addPx(0)),nc.setStyle(image,"left",nc.addPx(0)),nc.setOpacity(image,0),nc.playinG.Event.addListener(image,"load",function(){_obj.w=image.width,_obj.h=image.height,_obj.node=image,_obj.error="N",_obj.isLoaded=!0;for(var i=0;this._images[i];i++)if(!this._images[i].isLoaded){isLoaded=!1;break}isLoaded&&this.onLoaded.dispatch()}.binder(this)),nc.playinG.Event.addListener(image,"error",function(){var errorImage=new Image;errorImage.src="http://"+nc.staticUrl+"static.plaync.co.kr/editor/imagePlugin/static/missing.png",nc.setStyle(errorImage,"position","absolute"),nc.setStyle(errorImage,"top",nc.addPx(0)),nc.setStyle(errorImage,"left",nc.addPx(0)),nc.setOpacity(errorImage,0),_obj.w=297,_obj.h=53,_obj.node=errorImage,_obj.error="Y",_obj.isLoaded=!0;for(var i=0;this._images[i];i++)if(!this._images[i].isLoaded){isLoaded=!1;break}isLoaded&&this.onLoaded.dispatch()}.binder(this)),_obj.isLoaded=!1,image.src=_obj.imgUrl}},nc.playinG.ImageViewer=function(parent,options){this.parent=parent||document.body,this.options={isComment:!0,comment:1,commentSize:360,onChange:null,onLoad:null,onClose:null,preload:10,margin:50,minWidth:320,minHeight:500,modalZindex:999998,zIndex:999999,channel:null,isMetaInfo:!1,isShare:!1,isFullScreen:!1,isDownload:!0,isMenu:!0,isShowImageAfterOnload:!0,isFastLoading:!1,metaInfo:"http://"+nc.staticUrl+"upload.plaync.co.kr/file"},nc.extend(this.options,options),this.modal=new nc.playinG.ModalLayer,this.parent.appendChild(this.modal.get()),this.html=new ViewerDom,this.parent.appendChild(this.html.getContainer()),this.metaInfoWrap=this.html._infoCharacterG,this.options.isShare||nc.setStyle(this.html._shareButton,"display","none"),this.options.isFullScreen||nc.setStyle(this.html._fullButton,"display","none"),this.options.isDownload||nc.setStyle(this.html._downButton,"display","none"),this.options.isMenu||nc.setStyle(this.html._imgOptionG,"display","none"),nc.setStyle(this.modal.get(),"zIndex",this.options.modalZindex),nc.setStyle(this.html.getContainer(),"zIndex",this.options.zIndex),this.options.isComment||(this.options.commentSize=0,this.options.onChange=null,nc.setStyle(this.html._wrapCommentG,"width",nc.addPx(0))),this._currImage=null,this.isLoaded=!1,this.onLoaded=new nc.playinG.Observer,this.onChange=new nc.playinG.Observer,this.onClose=new nc.playinG.Observer,this._imagesParent=this.html._imgStageG,this._images=new nc.playinG.ImageData(this._imagesParent,this.options.isFastLoading),this._images.onMove.add(function(nodes){this.showImage({prev:nodes[0],next:nodes[1],curr:nodes[2]}),this.isLoaded||(this.isLoaded=!0,this.onLoaded.dispatch())},this),this._images.onLoaded.add(function(){var nodes=this._images.get();this.options.isShowImageAfterOnload&&this.showImage(nodes),this.onLoaded.dispatch()},this),nc.playinG.Event.addListener(window,"resize",function(){this.setGridSize(),this.setCurrImageSize()}.binder(this)),this.options.isComment&&(this._commentScroll=new nc.Scrollbar(this.html._wrapCommentGScrollParent,this.html._wrapCommentGScrollChild)),this.title=this.html._imgAlbumTit,this.setGridSize(),this.hide(),this._addEvent(),this.metaInfo=new nc.playinG.MetaInfo(this.options),this.metaInfo.onInfo.add(function(data){this.setCharacterUI(data)},this)},nc.playinG.ImageViewer.urlError=function(){nc.playinG.AlertController.getInstance().setMsg("죄송합니다. 오류가 발생했습니다."),nc.playinG.AlertController.getInstance().setMsgContent("<p>해당 이미지가 삭제되었거나,</p><p>일시적인 장애로 다운로드 할 수 없습니다.</p>"),nc.playinG.AlertController.getInstance().show()},nc.playinG.ImageViewer.prototype={addChild:function(parent,childs){if(!(childs instanceof Array))return void parent.appendChild(childs);for(var i=0;childs[i];i++)parent.appendChild(childs[i])},setCharacterUI:function(data){nc.setStyle(this.html._openGameInfoG,"display","none"),nc.setStyle(this.html._gameInfoG,"display","none"),this.metaInfoWrap.innerHTML="";var items=[];if(data&&data.head["major-version"]&&"1"!==data.head["major-version"]){if("로비"===data.body.location.name)return;if(data.body.player&&items.push(data.body.player),data.body["party-member"]){var d=data.body["party-member"];if(d instanceof Array)for(var i=0;d[i];i++)items.push(d[i]);else items.push(d)}for(var j=0;items[j];j++){var item=items[j],nameG="",levelG="",classG="",raceG="",guildG="",mLevelG="",_d=document.createElement("div"),_li=document.createElement("li"),list=_li.cloneNode(!1),iThumbG=_d.cloneNode(!1),iDetailG=_d.cloneNode(!1);iThumbG.className="iThumbG",iDetailG.className="iDetailG",iThumbG.innerHTML='<a><img src="'+nc.imgUrl+'static/none.gif" /></a>';var nameG='<a class="iNameG"><strong>'+item.name+"</strong></a>",levelG='<span class="iLevelG">Lv.'+item.level+"</span>",classG='<span class="iClassG">'+item.job+"</span>",raceG='<span class="iRaceG">'+item.race+"</span>";item.guild.name.length>0&&(guildG='<span class="iGuildG">'+item.guild.name+"</span>");var masteryKind="",masteryLevel="";"9"==item.faction2&&"0"!=item["mastery-level"]&&(masteryKind="홍문"),("10"==item.faction2||"0"==item.faction2&&"0"!=item["mastery-level"])&&(masteryKind="홍문"),"0"!=item["mastery-level"]&&(masteryLevel=item["mastery-level"]+"성"),masteryKind&&masteryLevel&&(mLevelG='<span class="icBullG">&bull;</span> <span class="masteryLvG">'+masteryKind+" "+masteryLevel+"</span>"),iDetailG.innerHTML=nameG+levelG+mLevelG+classG+raceG+guildG,this.addChild(list,[iThumbG,iDetailG]),this.addChild(this.metaInfoWrap,list)}nc.setStyle(this.html._openGameInfoG,"display","block"),nc.setStyle(this.html._gameInfoG,"display","none")}},_addEvent:function(){nc.playinG.Event.addListener(this.html.getContainer(),"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.hide(),nc.trk("/이미지뷰어/닫기/모달/")}.binder(this)),nc.playinG.Event.addListener(this.html._imgPrevG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this._prev(),nc.trk("/이미지뷰어/이전/")}.binder(this)),nc.playinG.Event.addListener(this.html._imgNextG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this._next(),nc.trk("/이미지뷰어/다음/")}.binder(this)),nc.playinG.Event.addListener(this.html._wrapImgViewG,"mousemove",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt);var pos=nc.getMousePosition(evt),w=nc.integer(nc.getStyle(this.html._wrapImgViewG,"width"));if(nc.integer(w/10*2)<=pos.x){if(nc.removeClassName(this.html._imgPrevG,"highlightNavG"),nc.removeClassName(this.html._imgNextG,"highlightNavG"),this._images._currNum>=this._images.length()-1)return;nc.addClassName(this.html._imgNextG,"highlightNavG")}else{if(nc.removeClassName(this.html._imgNextG,"highlightNavG"),nc.removeClassName(this.html._imgPrevG,"highlightNavG"),this._images._currNum<=0)return;nc.addClassName(this.html._imgPrevG,"highlightNavG")}}.binder(this)),nc.playinG.Event.addListener(this.html._wrapImgViewG,"mouseout",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),nc.removeClassName(this.html._imgPrevG,"highlightNavG"),nc.removeClassName(this.html._imgNextG,"highlightNavG")}.binder(this)),nc.playinG.Event.addListener(this.html._wrapImgViewG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt);var pos;pos=nc.getMousePosition(evt);var w=nc.integer(nc.getStyle(this.html._wrapImgViewG,"width"));nc.integer(w/10*2)<=pos.x?this._next():this._prev()}.binder(this)),nc.playinG.Event.addListener(this.html._fullButton,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.fullScreen(),nc.trk("/이미지뷰어/전체화면/")}.binder(this)),nc.playinG.Event.addListener(this.html._fullscreenCloseG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.normalScreen(),nc.trk("/이미지뷰어/전체화면닫기/")}.binder(this)),nc.playinG.Event.addListener(this.html._closeG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.hide(),this.options.onClose&&this.options.onClose({curr:this._currImage}),nc.trk("/이미지뷰어/닫기/버튼/")}.binder(this)),nc.playinG.Event.addListener(this.html._gameInfoG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),nc.setStyle(this.html._gameInfoG,"display","none"),nc.setStyle(this.html._openGameInfoG,"display","block"),nc.trk("/이미지뷰어/스크린샷정보영역클릭/")}.binder(this)),nc.playinG.Event.addListener(this.html._openGameInfoG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),nc.setStyle(this.html._gameInfoG,"display","block"),nc.setStyle(this.html._openGameInfoG,"display","none"),nc.trk("/이미지뷰어/스크린샷정보열기/")}.binder(this)),nc.playinG.Event.addListener(this.html._closeGameInfoG,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),nc.setStyle(this.html._gameInfoG,"display","none"),nc.setStyle(this.html._openGameInfoG,"display","block"),nc.trk("/이미지뷰어/스크린샷정보닫기/")}.binder(this)),nc.playinG.Event.addListener(this.html._downButton,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt);var img=this.getCurrImage();if(/^http:\/\/(?:rc.)*gamepic.plaync.com/.test(img.imgUrl)){window.open("http://"+nc.staticUrl+"gamepic.plaync.com/api/download/?imgsrc="+img.imgUrl+"&cb=opener.nc.playinG.ImageViewer.urlError")}else{window.open(img.imgUrl)}nc.trk("/이미지뷰어/다운로드/")}.binder(this))},show:function(){nc.setStyle(document.documentElement,"overflowY","hidden"),nc.setStyle(document.documentElement,"overflow","hidden"),nc.addClassName(this.parent,"activeG"),nc.setStyle(this.modal.get(),"display","block"),nc.setStyle(this.html.getContainer(),"display","block"),this._escEvent&&this._escEvent.remove(),this._escEvent=nc.playinG.Event.addListener(document,"keydown",function(evt){var evt=evt?evt:event,code=evt.keyCode;27===code?(nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this.hide(),this.options.onClose&&this.options.onClose({curr:this._currImage}),nc.trk("/이미지뷰어/Esc/")):37===code?(nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this._prev(),nc.trk("/이미지뷰어/키보드이전/")):39===code&&(nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),this._next(),nc.trk("/이미지뷰어/키보드다음/"))}.binder(this)),this.html.getContainer().focus(),nc.setStyle(this.html._notifyGuideG,"display","block"),nc.setOpacity(this.html._notifyGuideG,1);new nc.playinG.Animate(this.html._notifyGuideG,{opacity:0},{duration:2300,callback:function(){nc.setStyle(this.html._notifyGuideG,"display","none")}.binder(this)});nc.trk("/이미지뷰어/실행/")},hide:function(){nc.setStyle(document.documentElement,"overflowY","scroll"),nc.setStyle(document.documentElement,"overflowX","auto"),nc.removeClassName(this.parent,"activeG"),nc.setStyle(this.modal.get(),"display","none"),nc.setStyle(this.html.getContainer(),"display","none"),this._escEvent&&this._escEvent.remove()},isShow:function(){return"block"===nc.getStyle(this.modal.get(),"display")&&"block"===nc.getStyle(this.html.getContainer(),"display")?!0:!1},setSelectImageByIndex:function(idx){if(this.options.isFastLoading)return this.hideImageAll(),void this._images.selectByIdx(idx);this.hideImageAll();for(var nodes=this._images.selectByIdx(idx),i=0;idx>i;i++)this._imagesParent.appendChild(this._images._images[i].node);this.showImage(nodes)},_prev:function(){var node=this._images.prev();this.showImage(node)},_next:function(){var node=this._images.next();this.showImage(node)},setImages:function(data){this._images.remove();for(var i=0;data[i];i++){var arr=data[i].list,albumNm=data[i].albumNm,albumUrl=data[i].albumUrl,uId=data[i].id,length=data[i].length;albumNm=albumNm.replace(/\'/g,""),albumNm=albumNm.replace(/\"/g,"");for(var j=0;arr[j];j++)this._images.pushObject({imgUrl:arr[j],albumNm:albumNm,albumUrl:albumUrl,id:uId,length:length,isLoaded:!1})}if(this.options.isFastLoading)return this.isLoaded=!1,void this._images.get();for(var i=0;this._images._images[i];i++)this._images.setImage(this._images._images[i])},destroy:function(){var modal=this.modal.get(),container=this.html.getContainer();modal.parentNode.removeChild(modal),container.parentNode.removeChild(container),this.modal=null,this.parent=null,this._images=null},getCurrImage:function(){return this._currImage},getMeta:function(curr){if(curr){var imgMetaInfo=/(.)-v4$/.exec(curr.imgUrl);if(!(imgMetaInfo instanceof Array&&"1"!==imgMetaInfo[1])){var fileInfo=/^http:\/\/(?:rc.)*imgfiles.plaync.co.kr\/file\/.{1,}\/download\/(.{1,})/.exec(curr.imgUrl),channel=/^http:\/\/(?:rc.)*imgfiles.plaync.co.kr\/file\/(.*)\/download.*/.exec(curr.imgUrl);fileInfo||(fileInfo=/^http:\/\/(?:rc.)*upload.plaync.co.kr\/file\/.{1,}\/download\/(.{1,})/.exec(curr.imgUrl)),fileInfo&&this.metaInfo.getMetaInfo(fileInfo[1],channel&&channel[1]?channel[1]:"")}}},setChannel:function(channel){this.options.channel=channel},hideImageAll:function(){for(var n=this._imagesParent,i=0;i<n.childNodes.length;i++){var cn=n.childNodes[i];1==cn.nodeType&&"img"===cn.nodeName.toLowerCase()&&nc.setOpacity(cn,0)}},showImage:function(images){if(images){nc.setStyle(this.html._openGameInfoG,"display","none"),nc.setStyle(this.html._gameInfoG,"display","none"),this.hideImageAll();var curr=images.curr,prev=images.prev,next=images.next;if(this._currImage=curr,curr=this._setCurrImageSizeAndPos(curr),prev&&prev.node&&(nc.setOpacity(prev.node,0),this.options.isFastLoading&&this._imagesParent.appendChild(prev.node)),next&&next.node&&(nc.setOpacity(next.node,0),this.options.isFastLoading&&this._imagesParent.appendChild(next.node)),curr&&curr.node){if(this._imagesParent.appendChild(curr.node),nc.setOpacity(curr.node,1),"Y"===curr.error)return void(this.options.onChange&&this.options.onChange({curr:curr,prev:prev,next:next}));this.getMeta(curr),curr.albumNm&&""!==curr.albumNm?(this._moveAlbumUrl&&this._moveAlbumUrl.remove(),this._moveAlbumUrl=nc.playinG.Event.addListener(this.title,"click",function(evt){nc.playinG.Event.preventDefault(evt),nc.playinG.Event.stopPropagation(evt),location.href=curr.albumUrl}.binder(this)),this.title.innerHTML="<strong>"+curr.albumNm+"</strong>("+curr.length+")"):(this.title.setAttribute("href",""),this.title.innerHTML="")}this.options.onChange&&this.options.onChange({curr:curr,prev:prev,next:next})}},setCurrImageSize:function(){if(this._currImage){this._setCurrImageSizeAndPos(this._currImage)}},_setCurrImageSizeAndPos:function(info){if(info){var gSize=this.getGridSize(),iSize=this.setImageSize(info.w,info.h),cx=(nc.integer(gSize.w)-iSize.w)/2,cy=(nc.integer(gSize.h)-iSize.h)/2,w=nc.addPx(nc.integer(iSize.w)),h=nc.addPx(nc.integer(iSize.h)),y=nc.addPx(nc.integer(cy)),x=nc.addPx(nc.integer(cx));return nc.setStyle(info.node,"top",y),nc.setStyle(info.node,"left",x),nc.setStyle(info.node,"width",w),nc.setStyle(info.node,"height",h),info}},setImageSize:function(w,h){var size={w:w,h:h},gSize=this.getGridSize(),rate=0,sizeW=nc.integer(size.w),sizeH=nc.integer(size.h),gSizeW=nc.integer(gSize.w),gSizeH=nc.integer(gSize.h);return gSizeW<this.options.minWidth&&(gSizeW=this.options.minWidth),sizeW>gSizeW&&(rate=sizeW/gSizeW,sizeW=gSizeW,sizeH/=rate),sizeH>gSizeH&&(rate=sizeH/gSizeH,sizeW/=rate,sizeH=gSizeH),size.w=sizeW,size.h=sizeH,size},setGridSize:function(w,h,t,l){var w=nc.getBrowserSize().w-this.options.commentSize-2*this.options.margin;w<this.options.minWidth&&(w=this.options.minWidth);var h=nc.getBrowserSize().h-2*this.options.margin,t=this.options.margin,l=this.options.margin,wrap=this.html._wrapImgViewG,wrapW=nc.getStyle(wrap,"width");wrapW&&parseInt(wrapW)<=320&&(l=0),h<this.options.minHeight&&(h=this.options.minHeight),0>h&&(h=1),nc.setStyle(wrap,"width",nc.addPx(w)),nc.setStyle(wrap,"height",nc.addPx(h)),nc.setStyle(wrap,"top",nc.addPx(t)),nc.setStyle(wrap,"left",nc.addPx(l))},getGridSize:function(){var wrap=this.html._wrapImgViewG,w=nc.getStyle(wrap,"width"),h=nc.getStyle(wrap,"height");return{w:w,h:h}},addCommentFrame:function(url){{var child=this.html._wrapCommentGScrollChild;this.html._wrapCommentGScrollParent}this._commentFrame&&child.removeChild(this._commentFrame),this._commentFrame=frame=document.createElement("iframe"),frame.width=350,frame.frameBorder="0",frame.scrolling="no",frame.allowTransparency="true",nc.setStyle(frame,"border","0"),nc.setStyle(frame,"borderStyle","none"),frame.src=url,this.isShow()&&this._addCommentFrame()},_addCommentFrame:function(){if(this._commentFrame){var child=this.html._wrapCommentGScrollChild;child.appendChild(frame)}},setCommentSizeH:function(h){var child=this.html._wrapCommentGScrollChild,parent=this.html._wrapCommentGScrollParent,h=h+50;nc.setStyle(child,"height",nc.addPx(h)),this._commentFrame.height=h,this.options.isComment&&(this._commentScroll.changeHeight(nc.integer(h),parent.offsetHeight),this._commentScroll.moveTop())},addComment:function(node){{var child=this.html._wrapCommentGScrollChild;this.html._wrapCommentGScrollParent}this._comment&&(child.removeChild(this._comment),this._comment=null),this._comment=cmt=document.createElement("div"),"string"==typeof node?cmt.innerHTML=node:cmt.appendChild(node),this.isShow()&&child._addComment()},_addComment:function(){if(this._comment){var child=this.html._wrapCommentGScrollChild,parent=this.html._wrapCommentGScrollParent;child.appendChild(this._comment),this.options.isComment&&(this._commentScroll.changeHeight(nc.integer(nc.getStyle(this._comment,"height"))+50,parent.offsetHeight),this._commentScroll.moveTop())}},fullScreen:function(){var wrap=this.html._wrapImgViewG;if(this._mode="fullscreen",nc.setStyle(this.html._gameInfoG,"display","none"),nc.setStyle(this.html._fullscreenCloseG,"display","block"),nc.setStyle(this.html._imgOptionG,"display","none"),nc.setStyle(wrap,"top",nc.addPx(0)),nc.setStyle(wrap,"left",nc.addPx(0)),nc.setStyle(wrap,"width",nc.addPx(nc.getScreenSize().w)),nc.setStyle(wrap,"height",nc.addPx(nc.getBrowserSize().h)),nc.setStyle(this.html._wrapCommentG,"right",nc.addPx(-this.options.commentSize)),this._currImage){nc.setStyle(this._currImage.node,"opacity",0),curr=this._setCurrImageSizeAndPos(this._currImage);{nc.getStyle(curr.node,"left")}nc.setStyle(curr.node,"opacity",1)}},normalScreen:function(){var curr,wrap=this.html._wrapImgViewG;if(this._mode="normalscreen",nc.setStyle(this.html._wrapCommentG,"right",nc.addPx(0)),nc.setStyle(this.html._fullscreenCloseG,"display","none"),nc.setStyle(this.html._imgOptionG,"display","block"),nc.setStyle(wrap,"top",nc.addPx(this.options.margin)),nc.setStyle(wrap,"left",nc.addPx(this.options.margin)),nc.setStyle(wrap,"width",nc.addPx(nc.getScreenSize().w-this.options.commentSize-2*this.options.margin)),nc.setStyle(wrap,"height",nc.addPx(nc.getBrowserSize().h-2*this.options.margin)),this._currImage){nc.setStyle(this._currImage.node,"opacity",0),curr=this._setCurrImageSizeAndPos(this._currImage);{nc.getStyle(curr.node,"left")}nc.setStyle(curr.node,"opacity",1)}}},nc.playinG.MovieDom=function(){this._div=document.createElement("div"),this._span=document.createElement("span"),this._textArea=document.createElement("textarea"),this._a=document.createElement("a"),this._containerG=this._div.cloneNode(!1),this._containerG.className="movieDialogG",this._bgTop=this._div.cloneNode(!1),this._bgTop.className="bgTopMovieG",this._bgBottom=this._div.cloneNode(!1),this._bgBottom.className="bgBottomMovieG",this._closeG=this._span.cloneNode(!1),this._closeG.className="movieCloseG",this._closeG.innerHTML="닫기",this._codeAreaG=this._div.cloneNode(!1),this._codeAreaG.className="codeAreaG",this._textareaG=this._textArea.cloneNode(!1),this._textareaG.className="placeholder",this._errorG=this._div.cloneNode(!1),this._errorG.className="movieErrorG",this._errorModalG=this._div.cloneNode(!1),this._errorModalG.className="errModalG",this._errMessageG=this._div.cloneNode(!1),this._errMessageG.className="errMessageG",this._errUrlG=this._span.cloneNode(!1),this._errUrlG.innerHTML="사이트 URL 첨부 방식은<br>유튜브 서비스만 제공됩니다",this._errTagG=this._span.cloneNode(!1),this._errTagG.innerHTML="해당 영상을 찾을 수 없습니다.",this._againG=this._a.cloneNode(!1),this._againG.innerHTML="다시 입력하기",this.addChild(this._codeAreaG,[this._textareaG,this._errorG]),this.addChild(this._errorG,[this._errorModalG,this._errMessageG]),this.addChild(this._errMessageG,[this._errUrlG,this._errTagG,this._againG]),this._viewG=this._div.cloneNode(!1),this._viewG.className="movEmbedG",this._titG=this._div.cloneNode(!1),this._titG.className="movieTitG",this._buttonG=this._div.cloneNode(!1),this._buttonG.className="movieButtonG",this._previewG=this._a.cloneNode(!1),this._previewG.className="btMovPreiveG",this._previewG.innerHTML="미리보기",this._insertG=this._a.cloneNode(!1),this._insertG.className="btMovAttachG",this._insertG.innerHTML="삽입",this._cancelG=this._a.cloneNode(!1),this._cancelG.className="btMovCancelG",this._cancelG.innerHTML="취소",this.addChild(this._buttonG,[this._previewG,this._cancelG,this._insertG]),this.addChild(this._containerG,[this._bgTop,this._bgBottom,this._closeG,this._codeAreaG,this._viewG,this._titG,this._buttonG])},nc.playinG.MovieDom.prototype.addChild=function(parent,childs){if(!(childs instanceof Array))return void parent.appendChild(childs);for(var i=0;childs[i];i++)parent.appendChild(childs[i])},nc.playinG.MovieDom.prototype.getContainer=function(){return this._containerG},nc.playinG.MovieUpload=function(parent,options){this.parent=parent||document.body,this.youtubeKey="AIzaSyC7I_5VdkwjZKGF4YtAyttreOMQKy9rRG4",this.options={onComplete:null},nc.extend(this.options,options),this.html=new nc.playinG.MovieDom,this.panel=this.html.getContainer(),this.parent.appendChild(this.panel),this.setEvent()},nc.playinG.MovieUpload.prototype={_movie:"",_movieId:"",_siteUrl:"",_tit:"",_w:"",_h:"",_swf:"",_youtube:!1,show:function(){nc.setStyle(this.panel,"display","block"),nc.addClassName(nc.$("UploadMovie"),"active"),this.html._textareaG.focus(),nc.trk("/위지윅/동영상/")},hide:function(){nc.setStyle(this.panel,"display","none"),nc.removeClassName(nc.$("UploadMovie"),"active"),this.reset(),nc.trk("/위지윅/동영상/닫기/")},toggle:function(){"block"===nc.getStyle(this.panel,"display")?this.hide():this.show()},reset:function(){nc.setStyle(this.html._insertG,"display","none"),nc.setStyle(this.html._cancelG,"display","none"),nc.setStyle(this.html._viewG,"display","none"),nc.setStyle(this.html._titG,"display","none"),nc.setStyle(this.html._errorG,"display","none"),nc.setStyle(this.html._previewG,"display","inline-block"),nc.setStyle(this.html._codeAreaG,"display","block"),nc.addClassName(this.html._textareaG,"placeholder"),nc.removeClassName(this.html._previewG,"on"),this.html._textareaG.value="",this.html._viewG.innerHTML="",this._movie=this._movieId=this._siteUrl=this._tit="",this._youtube=!1},buttonMovie:function(){"none"===nc.getStyle(this.html._previewG,"display")?nc.setStyle(this.html._previewG,"display","inline-block"):nc.setStyle(this.html._previewG,"display","none"),"none"===nc.getStyle(this.html._cancelG,"display")?nc.setStyle(this.html._cancelG,"display","inline-block"):nc.setStyle(this.html._cancelG,"display","none"),"none"===nc.getStyle(this.html._insertG,"display")?nc.setStyle(this.html._insertG,"display","inline-block"):nc.setStyle(this.html._insertG,"display","none")},_error:function(){nc.setStyle(this.html._errorG,"display","block"),nc.setOpacity(this.html._errorG,1)},errUrl:function(){nc.setStyle(this.html._errTagG,"display","none"),nc.setStyle(this.html._errUrlG,"display","block"),this._error()},errTag:function(){nc.setStyle(this.html._errUrlG,"display","none"),nc.setStyle(this.html._errTagG,"display","block"),this._error()},cancel:function(){nc.setStyle(this.html._textareaG,"display","block"),nc.setStyle(this.html._codeAreaG,"display","block"),nc.setStyle(this.html._viewG,"display","none"),nc.setStyle(this.html._titG,"display","none"),this._movie=this._movieId=this._siteUrl=this._tit="",this._youtube=!1,this.buttonMovie(),this.html._textareaG.focus()
},setEvent:function(){nc.playinG.Event.addListener(this.html._closeG,"click",function(){this.hide()}.binder(this)),nc.playinG.Event.addListener(this.html._previewG,"click",function(){this.html._textareaG.value.length<=0||(this.validCheck(),nc.trk("/위지윅/동영상/미리보기/"))}.binder(this)),nc.playinG.Event.addListener(this.html._insertG,"click",function(){this.html._textareaG.value.length<=0||(this.insertMovieHtml(),nc.trk("/위지윅/동영상/삽입/"))}.binder(this)),nc.playinG.Event.addListener(this.html._cancelG,"click",function(){this.cancel(),nc.trk("/위지윅/동영상/취소/")}.binder(this)),nc.playinG.Event.addListener(this.html._textareaG,"keyup",function(){this.html._textareaG.value.length<=0?(nc.addClassName(this.html._textareaG,"placeholder"),nc.removeClassName(this.html._previewG,"on")):(nc.removeClassName(this.html._textareaG,"placeholder"),nc.addClassName(this.html._previewG,"on"))}.binder(this)),nc.playinG.Event.addListener(this.html._againG,"click",function(){new nc.playinG.Animate(this.html._errorG,{display:"none",opacity:0},{duration:1e3});this.html._textareaG.focus(),nc.trk("/위지윅/동영상/다시입력하기/")}.binder(this)),this.reset()},validCheck:function(){var str=this.html._textareaG.value.substring(0,7);str.indexOf("http")>=0?(this._movie=this.html._textareaG.value,this.urlCheck()):this.tagCheck()},getSrc:function(src){var urlRegex=/([s][r][c]\s*|[v][a][l][u][e]\s*)=\s*(?:\'|\")(http[^(\"|\')]*)(?:\'|\")/gim,source=urlRegex.exec(src);return null==source?this.errTag():source[2]},youtubeCheck:function(src){var url=new RegExp("(^https?://youtu.be/|^https?://www.youtube.com/watch.*v=|^https?://www.youtube.com/embed/|^https?://www.youtube.com/v/)","i");return url.test(src)},youtubeCall:function(){var checkUrl=/^https?:\/\/youtu.be/.test(this._movie)?/^https?:\/\/youtu.be\/([\w|\-]*)/:this._movie.indexOf("/embed/")>-1?/^https?:\/\/www.youtube.com\/embed\/([\w|\-]*)/:this._movie.indexOf("/v/")>-1?/^https?:\/\/www.youtube.com\/v\/([\w|\-]*)/:/^https?:\/\/www.youtube.com\/watch\?.*?v=([\w|\-]*)/,id=checkUrl.exec(this._movie);if(id){this._movieId=id[1],this._movie=/^https:\/\//.exec(this._movie)?"https://www.youtube.com/embed/"+id[1]:"http://www.youtube.com/embed/"+id[1],this._youtube=!0;var script=document.createElement("script");script.setAttribute("type","text/javascript"),script.setAttribute("src","https://www.googleapis.com/youtube/v3/videos?key="+this.youtubeKey+"&part=id,snippet,contentDetails&id="+this._movieId+"&callback=youtubeFeedCallback"),document.getElementsByTagName("head")[0].appendChild(script)}else this.errUrl()},urlCheck:function(){return this._movie.indexOf(".swf")>-1?(this._swf=!0,this.previewMovie()):0==this.youtubeCheck(this._movie)?this.errUrl():void this.youtubeCall()},tagCheck:function(){var tag=new RegExp("(^\\s*<iframe|^\\s*<object|^\\s*<embed)","i");if(0==tag.test(this.html._textareaG.value))return this.errUrl();if(this._movie=this.getSrc(this.html._textareaG.value),void 0!=this._movie){var size=/^\s*<[iframe|object|embed].*width=["|'](.+?)["|']+?.+?height=["|'](.+?)["|']+?/gi.exec(this.html._textareaG.value);this._w=null!=size?/\d*/.exec(size[1]):"640",this._h=null!=size?/\d*/.exec(size[2]):"360",0==this.youtubeCheck(this._movie)?""!=this._movie&&this.previewMovie():this.youtubeCall()}},previewMovie:function(){var pMovieTit,pMovieHTML;this._youtube&&(this._tit=(youtuDIV[this._movie]&&youtuDIV[this._movie].item)?youtuDIV[this._movie].items[0].snippet.title: '',pMovieTit='<div class="previewTit">'+this._tit+"</div>"),pMovieHTML='<iframe class="embedG" src="'+this._movie+'" width="330px" height="211px" frameborder=0 allowfullscreen/>',this.html._viewG.innerHTML=pMovieHTML,nc.setStyle(this.html._codeAreaG,"display","none"),nc.setStyle(this.html._viewG,"display","block"),""!=this._tit&&(this.html._titG.innerHTML=pMovieTit,nc.setStyle(this.html._titG,"display","block")),this.buttonMovie()},insertMovieHtml:function(){this._w=this._swf?400:""==this._w?640:this._w>=700?700:this._w,this._h=this._swf?300:""==this._h?360:this._h>=525?525:Number(this._h);var movieHTML='<button class="movWrapG" contenteditable="false" unselectable="on"><div class="movPlayerG" style="width:'+this._w+"px; height:"+this._h+'px;" id="'+this._movieId+'"><iframe class="embedG" src="'+this._movie+'" width="100%" height="100%" frameborder=0 allowfullscreen /></div><p class="webOnlyMediaObject" style="display:none;">해당 콘텐츠는 모바일 기기에서 볼 수 없습니다.</P><span class="emptyG"></span></button>';-1!=this._movie.indexOf("youtube")&&(movieHTML='<button class="movWrapG" contenteditable="false" unselectable="on"><div class="movPlayerG" style="width:'+this._w+"px; height:"+this._h+'px;" id="'+this._movieId+'"><embed class="embedG" src="'+this._movie+'" width="100%" height="100%" frameborder=0 allowfullscreen /></div><p class="webOnlyMediaObject" style="display:none;">해당 콘텐츠는 모바일 기기에서 볼 수 없습니다.</P><span class="emptyG"></span></button>'),this.hide(),this.options.onComplete&&this.options.onComplete(movieHTML)}};var youtuDIV=[];